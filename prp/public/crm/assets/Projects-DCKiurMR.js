var Ze=Object.defineProperty,Xe=Object.defineProperties;var qe=Object.getOwnPropertyDescriptors;var be=Object.getOwnPropertySymbols;var Je=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable;var we=(s,u,c)=>u in s?Ze(s,u,{enumerable:!0,configurable:!0,writable:!0,value:c}):s[u]=c,ke=(s,u)=>{for(var c in u||(u={}))Je.call(u,c)&&we(s,c,u[c]);if(be)for(var c of be(u))Qe.call(u,c)&&we(s,c,u[c]);return s},Ee=(s,u)=>Xe(s,qe(u));var A=(s,u,c)=>new Promise((D,e)=>{var t=a=>{try{o(c.next(a))}catch(r){e(r)}},i=a=>{try{o(c.throw(a))}catch(r){e(r)}},o=a=>a.done?D(a.value):Promise.resolve(a.value).then(t,i);o((c=c.apply(s,u)).next())});import{N as Ke,j as m,k as g,t as ue,x as P,A as et,O as tt,_ as se,m as De,a as S,l as n,g as V,z as I,r as k,o as _e,e as W,b as Te,a_ as $,D as b,a$ as xe,b0 as Pe,b1 as it,B as te,q as ie,V as ot,C as z,y as J,F as ae,H as ne,aV as at,L as Ce,b2 as nt,Q as st,b3 as rt,aq as lt,b4 as dt,i as ct}from"./index-BXHSmgx-.js";import{a as fe,b as oe,_ as ht}from"./CreateDialog-DeYsMeuo.js";var pt=({dt:s})=>`
.p-steplist {
    position: relative;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 0;
    padding: 0;
    list-style-type: none;
    overflow-x: auto;
}

.p-step {
    position: relative;
    display: flex;
    flex: 1 1 auto;
    align-items: center;
    gap: ${s("stepper.step.gap")};
    padding: ${s("stepper.step.padding")};
}

.p-step:last-of-type {
    flex: initial;
}

.p-step-header {
    border: 0 none;
    display: inline-flex;
    align-items: center;
    text-decoration: none;
    cursor: pointer;
    transition: background ${s("stepper.transition.duration")}, color ${s("stepper.transition.duration")}, border-color ${s("stepper.transition.duration")}, outline-color ${s("stepper.transition.duration")}, box-shadow ${s("stepper.transition.duration")};
    border-radius: ${s("stepper.step.header.border.radius")};
    outline-color: transparent;
    background: transparent;
    padding: ${s("stepper.step.header.padding")};
    gap: ${s("stepper.step.header.gap")};
}

.p-step-header:focus-visible {
    box-shadow: ${s("stepper.step.header.focus.ring.shadow")};
    outline: ${s("stepper.step.header.focus.ring.width")} ${s("stepper.step.header.focus.ring.style")} ${s("stepper.step.header.focus.ring.color")};
    outline-offset: ${s("stepper.step.header.focus.ring.offset")};
}

.p-stepper.p-stepper-readonly .p-step {
    cursor: auto;
}

.p-step-title {
    display: block;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
    color: ${s("stepper.step.title.color")};
    font-weight: ${s("stepper.step.title.font.weight")};
    transition: background ${s("stepper.transition.duration")}, color ${s("stepper.transition.duration")}, border-color ${s("stepper.transition.duration")}, box-shadow ${s("stepper.transition.duration")}, outline-color ${s("stepper.transition.duration")};
}

.p-step-number {
    display: flex;
    align-items: center;
    justify-content: center;
    color: ${s("stepper.step.number.color")};
    border: 2px solid ${s("stepper.step.number.border.color")};
    background: ${s("stepper.step.number.background")};
    min-width: ${s("stepper.step.number.size")};
    height: ${s("stepper.step.number.size")};
    line-height: ${s("stepper.step.number.size")};
    font-size: ${s("stepper.step.number.font.size")};
    z-index: 1;
    border-radius: ${s("stepper.step.number.border.radius")};
    position: relative;
    font-weight: ${s("stepper.step.number.font.weight")};
}

.p-step-number::after {
    content: " ";
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: ${s("stepper.step.number.border.radius")};
    box-shadow: ${s("stepper.step.number.shadow")};
}

.p-step-active .p-step-header {
    cursor: default;
}

.p-step-active .p-step-number {
    background: ${s("stepper.step.number.active.background")};
    border-color: ${s("stepper.step.number.active.border.color")};
    color: ${s("stepper.step.number.active.color")};
}

.p-step-active .p-step-title {
    color: ${s("stepper.step.title.active.color")};
}

.p-step:not(.p-disabled):focus-visible {
    outline: ${s("focus.ring.width")} ${s("focus.ring.style")} ${s("focus.ring.color")};
    outline-offset: ${s("focus.ring.offset")};
}

.p-step:has(~ .p-step-active) .p-stepper-separator {
    background: ${s("stepper.separator.active.background")};
}

.p-stepper-separator {
    flex: 1 1 0;
    background: ${s("stepper.separator.background")};
    width: 100%;
    height: ${s("stepper.separator.size")};
    transition: background ${s("stepper.transition.duration")}, color ${s("stepper.transition.duration")}, border-color ${s("stepper.transition.duration")}, box-shadow ${s("stepper.transition.duration")}, outline-color ${s("stepper.transition.duration")};
}

.p-steppanels {
    padding: ${s("stepper.steppanels.padding")};
}

.p-steppanel {
    background: ${s("stepper.steppanel.background")};
    color: ${s("stepper.steppanel.color")};
}

.p-stepper:has(.p-stepitem) {
    display: flex;
    flex-direction: column;
}

.p-stepitem {
    display: flex;
    flex-direction: column;
    flex: initial;
}

.p-stepitem.p-stepitem-active {
    flex: 1 1 auto;
}

.p-stepitem .p-step {
    flex: initial;
}

.p-stepitem .p-steppanel-content {
    width: 100%;
    padding: ${s("stepper.steppanel.padding")};
    margin-inline-start: 1rem;
}

.p-stepitem .p-steppanel {
    display: flex;
    flex: 1 1 auto;
}

.p-stepitem .p-stepper-separator {
    flex: 0 0 auto;
    width: ${s("stepper.separator.size")};
    height: auto;
    margin: ${s("stepper.separator.margin")};
    position: relative;
    left: calc(-1 * ${s("stepper.separator.size")});
}

.p-stepitem .p-stepper-separator:dir(rtl) {
    left: calc(-9 * ${s("stepper.separator.size")});
}

.p-stepitem:has(~ .p-stepitem-active) .p-stepper-separator {
    background: ${s("stepper.separator.active.background")};
}

.p-stepitem:last-of-type .p-steppanel {
    padding-inline-start: ${s("stepper.step.number.size")};
}
`,ut={root:function(u){var c=u.props;return["p-stepper p-component",{"p-readonly":c.linear}]},separator:"p-stepper-separator"},_t=Ke.extend({name:"stepper",style:pt,classes:ut}),ft={name:"BaseStepper",extends:tt,props:{value:{type:[String,Number],default:void 0},linear:{type:Boolean,default:!1}},style:_t,provide:function(){return{$pcStepper:this,$parentInstance:this}}},Se={name:"Stepper",extends:ft,inheritAttrs:!1,emits:["update:value"],data:function(){return{d_value:this.value}},watch:{value:function(u){this.d_value=u}},methods:{updateValue:function(u){this.d_value!==u&&(this.d_value=u,this.$emit("update:value",u))},isStepActive:function(u){return this.d_value===u},isStepDisabled:function(){return this.linear}}};function mt(s,u,c,D,e,t){return m(),g("div",et({class:s.cx("root"),role:"tablist"},s.ptmi("root")),[s.$slots.start?ue(s.$slots,"start",{key:0}):P("",!0),ue(s.$slots,"default"),s.$slots.end?ue(s.$slots,"end",{key:1}):P("",!0)],16)}Se.render=mt;const vt={class:"pd-card-image-container"},gt=["src","alt"],Lt={key:1,class:"pd-card-image-placeholder"},yt={class:"pd-card-content"},bt={key:0,class:"pd-parent-project"},wt={class:"pd-card-title"},kt={class:"pd-card-developer"},Et={class:"pd-card-details"},Mt={class:"pd-detail-item"},Dt={class:"pd-detail-item"},Tt={class:"pd-detail-item"},xt={__name:"ProjectCard",props:{project:{type:Object,required:!0}},setup(s){const u=De(),c=s,D=S(()=>{if(!c.project.status)return"pd-status-info";switch(c.project.status){case"Off-plan":return"pd-status-info";case"Due for Handover":return"pd-status-warning";case"Handover Completed":return"pd-status-success";default:return"pd-status-info"}}),e=(i,o)=>!i||!o?"Handover date not specified":`Q${i} ${o}`,t=()=>{u.push(`/projects/${c.project.name}`)};return(i,o)=>(m(),g("div",{class:"pd-project-card",onClick:t},[n("div",vt,[s.project.cover_image?(m(),g("img",{key:0,src:s.project.cover_image,alt:s.project.project_name,class:"pd-card-image"},null,8,gt)):(m(),g("div",Lt,o[0]||(o[0]=[n("i",{class:"pi pi-building"},null,-1)]))),n("div",{class:V(["pd-status-badge",D.value])},I(s.project.status||"Off-plan"),3)]),n("div",yt,[s.project.is_phase&&s.project.parent_project?(m(),g("div",bt,[o[1]||(o[1]=n("div",{class:"pd-avatar"},[n("i",{class:"pi pi-building"})],-1)),n("span",null,I(s.project.parent_project),1)])):P("",!0),n("h3",wt,I(s.project.project_name),1),n("p",kt,I(s.project.developer),1),n("div",Et,[n("div",Mt,[o[2]||(o[2]=n("i",{class:"pi pi-map-marker"},null,-1)),n("span",null,I(s.project.territory),1)]),n("div",Dt,[o[3]||(o[3]=n("i",{class:"pi pi-calendar"},null,-1)),n("span",null,I(e(s.project.handover_quarter,s.project.handover_year)),1)]),n("div",Tt,[o[4]||(o[4]=n("i",{class:"pi pi-tag"},null,-1)),n("span",null,I(s.project.availability||"Unknown"),1)])])]),o[5]||(o[5]=n("div",{class:"pd-card-hover-content"},[n("button",{class:"pd-view-button"},"View Details")],-1))]))}},Pt=se(xt,[["__scopeId","data-v-a0c12789"]]),Ct={class:"map-container"},St=["id"],It={key:0,class:"map-loading"},jt={__name:"PointSelectionMap",props:{selectedPoint:{type:Object,default:null},initialZoom:{type:Number,default:12},initialCenter:{type:Object,default:()=>({lat:25.276987,lng:55.296249})},mapId:{type:String,default:()=>`point-map-${Math.random().toString(36).substr(2,9)}`}},emits:["update:selectedPoint"],setup(s,{emit:u}){const c=s,D=u,e=k(!0),t=k(!1);let i=null,o=null;_e(()=>{setTimeout(()=>{a()},100)}),W(()=>c.selectedPoint,f=>{f&&i&&t.value?p(f):!f&&o&&(i.removeLayer(o),o=null)}),Te(()=>{r()});function a(){if(!t.value){e.value=!0;try{if(!document.getElementById(c.mapId)){console.error(`Map container with id ${c.mapId} not found`);return}i=$.map(c.mapId).setView([c.initialCenter.lat,c.initialCenter.lng],c.initialZoom),$.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:19}).addTo(i),c.selectedPoint&&p(c.selectedPoint),i.on("click",d),t.value=!0}catch(f){console.error("Error initializing map:",f)}finally{e.value=!1}}}function r(){i&&(i.off("click",d),i.remove(),i=null,t.value=!1)}function d(f){const G={lat:f.latlng.lat,lng:f.latlng.lng};p(G),D("update:selectedPoint",G)}function p(f){o&&i.removeLayer(o),o=$.marker([f.lat,f.lng]).addTo(i),i.setView([f.lat,f.lng],i.getZoom())}return(f,G)=>{const U=fe;return m(),g("div",Ct,[n("div",{id:s.mapId,class:"map"},null,8,St),e.value?(m(),g("div",It,[b(U)])):P("",!0)])}}},Ot=se(jt,[["__scopeId","data-v-2470c19c"]]);(function(s,u,c){function D(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(e,t){this._map=e,this._container=e._container,this._overlayPane=e._panes.overlayPane,this._popupPane=e._panes.popupPane,t&&t.shapeOptions&&(t.shapeOptions=L.Util.extend({},this.options.shapeOptions,t.shapeOptions)),L.setOptions(this,t);var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(L.DomUtil.disableTextSelection(),e.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(e){L.setOptions(this,e)},_fireCreatedEvent:function(e){this._map.fire(L.Draw.Event.CREATED,{layer:e,layerType:this.type})},_cancelDrawing:function(e){e.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(e,t){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,t&&t.drawError&&(t.drawError=L.Util.extend({},this.options.drawError,t.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,e,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var e=this._markers.pop(),t=this._poly,i=t.getLatLngs(),o=i.splice(-1,1)[0];this._poly.setLatLngs(i),this._markerGroup.removeLayer(e),t.getLatLngs().length<2&&this._map.removeLayer(t),this._vertexChanged(o,!1)}},addVertex:function(e){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(e))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(e)),this._poly.addLatLng(e),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(e,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var e=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),t=this._poly.newLatLngIntersects(e[e.length-1]);if(!this.options.allowIntersection&&t||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(e){var t=this._map.mouseEventToLayerPoint(e.originalEvent),i=this._map.layerPointToLatLng(t);this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(t),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(e.originalEvent)},_vertexChanged:function(e,t){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(e,t),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(e){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(e),this._clickHandled=!0,this._disableNewMarkers();var t=e.originalEvent,i=t.clientX,o=t.clientY;this._startPoint.call(this,i,o)}},_startPoint:function(e,t){this._mouseDownOrigin=L.point(e,t)},_onMouseUp:function(e){var t=e.originalEvent,i=t.clientX,o=t.clientY;this._endPoint.call(this,i,o,e),this._clickHandled=null},_endPoint:function(e,t,i){if(this._mouseDownOrigin){var o=L.point(e,t).distanceTo(this._mouseDownOrigin),a=this._calculateFinishDistance(i.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(i.latlng),this._finishShape()):a<10&&L.Browser.touch?this._finishShape():Math.abs(o)<9*(s.devicePixelRatio||1)&&this.addVertex(i.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(e){var t,i,o=e.originalEvent;!o.touches||!o.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(t=o.touches[0].clientX,i=o.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,t,i),this._endPoint.call(this,t,i,e),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(e){var t;if(this._markers.length>0){var i;if(this.type===L.Draw.Polyline.TYPE)i=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;i=this._markers[0]}var o=this._map.latLngToContainerPoint(i.getLatLng()),a=new L.Marker(e,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),r=this._map.latLngToContainerPoint(a.getLatLng());t=o.distanceTo(r)}else t=1/0;return t},_updateFinishHandler:function(){var e=this._markers.length;e>1&&this._markers[e-1].on("click",this._finishShape,this),e>2&&this._markers[e-2].off("click",this._finishShape,this)},_createMarker:function(e){var t=new L.Marker(e,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(t),t},_updateGuide:function(e){var t=this._markers?this._markers.length:0;t>0&&(e=e||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[t-1].getLatLng()),e))},_updateTooltip:function(e){var t=this._getTooltipText();e&&this._tooltip.updatePosition(e),this._errorShown||this._tooltip.updateContent(t)},_drawGuide:function(e,t){var i,o,a,r=Math.floor(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))),d=this.options.guidelineDistance,p=this.options.maxGuideLineLength,f=r>p?r-p:d;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));f<r;f+=this.options.guidelineDistance)i=f/r,o={x:Math.floor(e.x*(1-i)+i*t.x),y:Math.floor(e.y*(1-i)+i*t.y)},a=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),a.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(a,o)},_updateGuideColor:function(e){if(this._guidesContainer)for(var t=0,i=this._guidesContainer.childNodes.length;t<i;t++)this._guidesContainer.childNodes[t].style.backgroundColor=e},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var e,t,i=this.options.showLength;return this._markers.length===0?e={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(t=i?this._getMeasurementString():"",e=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:t}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:t}),e},_updateRunningMeasure:function(e,t){var i,o,a=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(i=a-(t?2:1),o=L.GeometryUtil.isVersion07x()?e.distanceTo(this._markers[i].getLatLng())*(this.options.factor||1):this._map.distance(e,this._markers[i].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=o*(t?1:-1))},_getMeasurementString:function(){var e,t=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return e=L.GeometryUtil.isVersion07x()?i&&t&&t.distanceTo?this._measurementRunningTotal+t.distanceTo(i)*(this.options.factor||1):this._measurementRunningTotal||0:i&&t?this._measurementRunningTotal+this._map.distance(t,i)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(e,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var e=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(e,t){L.Draw.Polyline.prototype.initialize.call(this,e,t),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var e=this._markers.length;e===1&&this._markers[0].on("click",this._finishShape,this),e>2&&(this._markers[e-1].on("dblclick",this._finishShape,this),e>3&&this._markers[e-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var e,t;return this._markers.length===0?e=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(e=L.drawLocal.draw.handlers.polygon.tooltip.cont,t=this._getMeasurementString()):(e=L.drawLocal.draw.handlers.polygon.tooltip.end,t=this._getMeasurementString()),{text:e,subtext:t}},_getMeasurementString:function(){var e=this._area,t="";return e||this.options.showLength?(this.options.showLength&&(t=L.Draw.Polyline.prototype._getMeasurementString.call(this)),e&&(t+="<br>"+L.GeometryUtil.readableArea(e,this.options.metric,this.options.precision)),t):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(e,t){var i;!this.options.allowIntersection&&this.options.showArea&&(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,e,t)},_cleanUpShape:function(){var e=this._markers.length;e>0&&(this._markers[0].off("click",this._finishShape,this),e>2&&this._markers[e-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(e,t){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,e,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),u.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(u,"mouseup",this._onMouseUp,this),L.DomEvent.off(u,"touchend",this._onMouseUp,this),u.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(e){this._isDrawing=!0,this._startLatLng=e.latlng,L.DomEvent.on(u,"mouseup",this._onMouseUp,this).on(u,"touchend",this._onMouseUp,this).preventDefault(e.originalEvent)},_onMouseMove:function(e){var t=e.latlng;this._tooltip.updatePosition(t),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(t))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(e,t){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,e,t)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(e){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!D(e.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(e){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,e)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,e),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var e=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,e)},_getTooltipText:function(){var e,t,i,o=L.Draw.SimpleShape.prototype._getTooltipText.call(this),a=this._shape,r=this.options.showArea;return a&&(e=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),t=L.GeometryUtil.geodesicArea(e),i=r?L.GeometryUtil.readableArea(t,this.options.metric):""),{text:o.text,subtext:i}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(e,t){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,e,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(e){var t=e.latlng;this._tooltip.updatePosition(t),this._mouseMarker.setLatLng(t),this._marker?(t=this._mouseMarker.getLatLng(),this._marker.setLatLng(t)):(this._marker=this._createMarker(t),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(e){return new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(e){this._onMouseMove(e),this._onClick()},_fireCreatedEvent:function(){var e=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(e,t){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,e,t)},_fireCreatedEvent:function(){var e=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)},_createMarker:function(e){return new L.CircleMarker(e,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(e,t){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,e,t)},_drawShape:function(e){if(L.GeometryUtil.isVersion07x())var t=this._startLatLng.distanceTo(e);else var t=this._map.distance(this._startLatLng,e);this._shape?this._shape.setRadius(t):(this._shape=new L.Circle(this._startLatLng,t,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var e=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,e)},_onMouseMove:function(e){var t,i=e.latlng,o=this.options.showRadius,a=this.options.metric;if(this._tooltip.updatePosition(i),this._isDrawing){this._drawShape(i),t=this._shape.getRadius().toFixed(1);var r="";o&&(r=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(t,a,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:r})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(e,t){this._marker=e,L.setOptions(this,t)},addHooks:function(){var e=this._marker;e.dragging.enable(),e.on("dragend",this._onDragEnd,e),this._toggleMarkerHighlight()},removeHooks:function(){var e=this._marker;e.dragging.disable(),e.off("dragend",this._onDragEnd,e),this._toggleMarkerHighlight()},_onDragEnd:function(e){var t=e.target;t.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:t})},_toggleMarkerHighlight:function(){var e=this._marker._icon;e&&(e.style.display="none",L.DomUtil.hasClass(e,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,-4)):(L.DomUtil.addClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,4)),e.style.display="")},_offsetMarker:function(e,t){var i=parseInt(e.style.marginTop,10)-t,o=parseInt(e.style.marginLeft,10)-t;e.style.marginTop=i+"px",e.style.marginLeft=o+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(e){this.latlngs=[e._latlngs],e._holes&&(this.latlngs=this.latlngs.concat(e._holes)),this._poly=e,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(e){for(var t=0;t<this._verticesHandlers.length;t++)e(this._verticesHandlers[t])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(e){e.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(e){e.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(e){e.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var e=0;e<this.latlngs.length;e++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[e],this._poly.options.poly))},_updateLatLngs:function(e){this.latlngs=[e.layer._latlngs],e.layer._holes&&(this.latlngs=this.latlngs.concat(e.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(e,t,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=e,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this._latlngs=t,L.setOptions(this,i)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var e=this._poly,t=e._path;e instanceof L.Polygon||(e.options.fill=!1,e.options.editing&&(e.options.editing.fill=!1)),t&&e.options.editing&&e.options.editing.className&&(e.options.original.className&&e.options.original.className.split(" ").forEach(function(i){L.DomUtil.removeClass(t,i)}),e.options.editing.className.split(" ").forEach(function(i){L.DomUtil.addClass(t,i)})),e.setStyle(e.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var e=this._poly,t=e._path;t&&e.options.editing&&e.options.editing.className&&(e.options.editing.className.split(" ").forEach(function(i){L.DomUtil.removeClass(t,i)}),e.options.original.className&&e.options.original.className.split(" ").forEach(function(i){L.DomUtil.addClass(t,i)})),e.setStyle(e.options.original),e._map&&(e._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var e,t,i,o,a=this._defaultShape();for(e=0,i=a.length;e<i;e++)o=this._createMarker(a[e],e),o.on("click",this._onMarkerClick,this),o.on("contextmenu",this._onContextMenu,this),this._markers.push(o);var r,d;for(e=0,t=i-1;e<i;t=e++)(e!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(r=this._markers[t],d=this._markers[e],this._createMiddleMarker(r,d),this._updatePrevNext(r,d))},_createMarker:function(e,t){var i=new L.Marker.Touch(e,{draggable:!0,icon:this.options.icon});return i._origLatLng=e,i._index=t,i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(i),i},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var e=this._defaultShape(),t=[].splice.apply(e,arguments);return this._poly._convertLatLngs(e,!0),this._poly.redraw(),t},_removeMarker:function(e){var t=e._index;this._markerGroup.removeLayer(e),this._markers.splice(t,1),this._spliceLatLngs(t,1),this._updateIndexes(t,-1),e.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(e){var t=e.target,i=this._poly,o=L.LatLngUtil.cloneLatLng(t._origLatLng);if(L.extend(t._origLatLng,t._latlng),i.options.poly){var a=i._map._editTooltip;if(!i.options.poly.allowIntersection&&i.intersects()){L.extend(t._origLatLng,o),t.setLatLng(o);var r=i.options.color;i.setStyle({color:this.options.drawError.color}),a&&a.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){i.setStyle({color:r}),a&&a.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}t._middleLeft&&t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev,t)),t._middleRight&&t._middleRight.setLatLng(this._getMiddleLatLng(t,t._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var d=this._poly.getLatLngs();this._poly._convertLatLngs(d,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(e){var t=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=e.target;this._defaultShape().length<t||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(e){var t=e.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:t,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(e){var t=this._map.mouseEventToLayerPoint(e.originalEvent.touches[0]),i=this._map.layerPointToLatLng(t),o=e.target;L.extend(o._origLatLng,i),o._middleLeft&&o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&&o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(e,t){this._markerGroup.eachLayer(function(i){i._index>e&&(i._index+=t)})},_createMiddleMarker:function(e,t){var i,o,a,r=this._getMiddleLatLng(e,t),d=this._createMarker(r);d.setOpacity(.6),e._middleRight=t._middleLeft=d,o=function(){d.off("touchmove",o,this);var p=t._index;d._index=p,d.off("click",i,this).on("click",this._onMarkerClick,this),r.lat=d.getLatLng().lat,r.lng=d.getLatLng().lng,this._spliceLatLngs(p,0,r),this._markers.splice(p,0,d),d.setOpacity(1),this._updateIndexes(p,1),t._index++,this._updatePrevNext(e,d),this._updatePrevNext(d,t),this._poly.fire("editstart")},a=function(){d.off("dragstart",o,this),d.off("dragend",a,this),d.off("touchmove",o,this),this._createMiddleMarker(e,d),this._createMiddleMarker(d,t)},i=function(){o.call(this),a.call(this),this._fireEdit()},d.on("click",i,this).on("dragstart",o,this).on("dragend",a,this).on("touchmove",o,this),this._markerGroup.addLayer(d)},_updatePrevNext:function(e,t){e&&(e._next=t),t&&(t._prev=e)},_getMiddleLatLng:function(e,t){var i=this._poly._map,o=i.project(e.getLatLng()),a=i.project(t.getLatLng());return i.unproject(o._add(a)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(e,t){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=e,L.Util.setOptions(this,t)},addHooks:function(){var e=this._shape;this._shape._map&&(this._map=this._shape._map,e.setStyle(e.options.editing),e._map&&(this._map=e._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var e=this._shape;if(e.setStyle(e.options.original),e._map){this._unbindMarker(this._moveMarker);for(var t=0,i=this._resizeMarkers.length;t<i;t++)this._unbindMarker(this._resizeMarkers[t]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(e,t){var i=new L.Marker.Touch(e,{draggable:!0,icon:t,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(e){e.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(e){e.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(e){e.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(e){var t=e.target,i=t.getLatLng();t===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(e){e.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(e){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,e),typeof this._getCorners=="function"){var t=this._getCorners(),i=e.target,o=i._cornerIndex;i.setOpacity(0),this._oppositeCorner=t[(o+2)%4],this._toggleCornerMarkers(0,o)}this._shape.fire("editstart")},_onTouchMove:function(e){var t=this._map.mouseEventToLayerPoint(e.originalEvent.touches[0]),i=this._map.layerPointToLatLng(t);return e.target===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),!1},_onTouchEnd:function(e){e.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var e=this._shape.getBounds(),t=e.getCenter();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var e=this._getCorners();this._resizeMarkers=[];for(var t=0,i=e.length;t<i;t++)this._resizeMarkers.push(this._createMarker(e[t],this.options.resizeIcon)),this._resizeMarkers[t]._cornerIndex=t},_onMarkerDragStart:function(e){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,e);var t=this._getCorners(),i=e.target,o=i._cornerIndex;this._oppositeCorner=t[(o+2)%4],this._toggleCornerMarkers(0,o)},_onMarkerDragEnd:function(e){var t,i,o=e.target;o===this._moveMarker&&(t=this._shape.getBounds(),i=t.getCenter(),o.setLatLng(i)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,e)},_move:function(e){for(var t,i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),o=this._shape.getBounds(),a=o.getCenter(),r=[],d=0,p=i.length;d<p;d++)t=[i[d].lat-a.lat,i[d].lng-a.lng],r.push([e.lat+t[0],e.lng+t[1]]);this._shape.setLatLngs(r),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(e){var t;this._shape.setBounds(L.latLngBounds(e,this._oppositeCorner)),t=this._shape.getBounds(),this._moveMarker.setLatLng(t.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var e=this._shape.getBounds();return[e.getNorthWest(),e.getNorthEast(),e.getSouthEast(),e.getSouthWest()]},_toggleCornerMarkers:function(e){for(var t=0,i=this._resizeMarkers.length;t<i;t++)this._resizeMarkers[t].setOpacity(e)},_repositionCornerMarkers:function(){for(var e=this._getCorners(),t=0,i=this._resizeMarkers.length;t<i;t++)this._resizeMarkers[t].setLatLng(e[t])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var e=this._shape.getLatLng();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(e){if(this._resizeMarkers.length){var t=this._getResizeMarkerPoint(e);this._resizeMarkers[0].setLatLng(t)}this._shape.setLatLng(e),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var e=this._shape.getLatLng(),t=this._getResizeMarkerPoint(e);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(t,this.options.resizeIcon))},_getResizeMarkerPoint:function(e){var t=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(e);return this._map.unproject([i.x+t,i.y-t])},_resize:function(e){var t=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=t.distanceTo(e):radius=this._map.distance(t,e),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(e,t){var i={};if(e.touches!==void 0){if(!e.touches.length)return;i=e.touches[0]}else if(e.pointerType!=="touch"||(i=e,!this._filterClick(e)))return;var o=this._map.mouseEventToContainerPoint(i),a=this._map.mouseEventToLayerPoint(i),r=this._map.layerPointToLatLng(a);this._map.fire(t,{latlng:r,layerPoint:a,containerPoint:o,pageX:i.pageX,pageY:i.pageY,originalEvent:e})},_filterClick:function(e){var t=e.timeStamp||e.originalEvent.timeStamp,i=L.DomEvent._lastClick&&t-L.DomEvent._lastClick;return i&&i>100&&i<500||e.target._simulatedClick&&!e._simulated?(L.DomEvent.stop(e),!1):(L.DomEvent._lastClick=t,!0)},_onTouchStart:function(e){this._map._loaded&&this._touchEvent(e,"touchstart")},_onTouchEnd:function(e){this._map._loaded&&this._touchEvent(e,"touchend")},_onTouchCancel:function(e){if(this._map._loaded){var t="touchcancel";this._detectIE()&&(t="pointercancel"),this._touchEvent(e,t)}},_onTouchLeave:function(e){this._map._loaded&&this._touchEvent(e,"touchleave")},_onTouchMove:function(e){this._map._loaded&&this._touchEvent(e,"touchmove")},_detectIE:function(){var e=s.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var o=e.indexOf("Edge/");return o>0&&parseInt(e.substring(o+5,e.indexOf(".",o)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var e=this._icon,t=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?t.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):t.concat(["touchcancel"]),L.DomUtil.addClass(e,"leaflet-clickable"),L.DomEvent.on(e,"click",this._onMouseClick,this),L.DomEvent.on(e,"keypress",this._onKeyPress,this);for(var i=0;i<t.length;i++)L.DomEvent.on(e,t[i],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var e=s.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var o=e.indexOf("Edge/");return o>0&&parseInt(e.substring(o+5,e.indexOf(".",o)),10)}}),L.LatLngUtil={cloneLatLngs:function(e){for(var t=[],i=0,o=e.length;i<o;i++)Array.isArray(e[i])?t.push(L.LatLngUtil.cloneLatLngs(e[i])):t.push(this.cloneLatLng(e[i]));return t},cloneLatLng:function(e){return L.latLng(e.lat,e.lng)}},function(){var e={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var i,o,a=t.length,r=0,d=Math.PI/180;if(a>2){for(var p=0;p<a;p++)i=t[p],o=t[(p+1)%a],r+=(o.lng-i.lng)*d*(2+Math.sin(i.lat*d)+Math.sin(o.lat*d));r=6378137*r*6378137/2}return Math.abs(r)},formattedNumber:function(t,i){var o=parseFloat(t).toFixed(i),a=L.drawLocal.format&&L.drawLocal.format.numeric,r=a&&a.delimiters,d=r&&r.thousands,p=r&&r.decimal;if(d||p){var f=o.split(".");o=d?f[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d):f[0],p=p||".",f.length>1&&(o=o+p+f[1])}return o},readableArea:function(t,i,d){var a,r,d=L.Util.extend({},e,d);return i?(r=["ha","m"],type=typeof i,type==="string"?r=[i]:type!=="boolean"&&(r=i),a=t>=1e6&&r.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*t,d.km)+" km²":t>=1e4&&r.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*t,d.ha)+" ha":L.GeometryUtil.formattedNumber(t,d.m)+" m²"):(t/=.836127,a=t>=3097600?L.GeometryUtil.formattedNumber(t/3097600,d.mi)+" mi²":t>=4840?L.GeometryUtil.formattedNumber(t/4840,d.ac)+" acres":L.GeometryUtil.formattedNumber(t,d.yd)+" yd²"),a},readableDistance:function(t,i,o,a,p){var d,p=L.Util.extend({},e,p);switch(i?typeof i=="string"?i:"metric":o?"feet":a?"nauticalMile":"yards"){case"metric":d=t>1e3?L.GeometryUtil.formattedNumber(t/1e3,p.km)+" km":L.GeometryUtil.formattedNumber(t,p.m)+" m";break;case"feet":t*=3.28083,d=L.GeometryUtil.formattedNumber(t,p.ft)+" ft";break;case"nauticalMile":t*=.53996,d=L.GeometryUtil.formattedNumber(t/1e3,p.nm)+" nm";break;case"yards":default:t*=1.09361,d=t>1760?L.GeometryUtil.formattedNumber(t/1760,p.mi)+" miles":L.GeometryUtil.formattedNumber(t,p.yd)+" yd"}return d},isVersion07x:function(){var t=L.version.split(".");return parseInt(t[0],10)===0&&parseInt(t[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(e,t,i,o){return this._checkCounterclockwise(e,i,o)!==this._checkCounterclockwise(t,i,o)&&this._checkCounterclockwise(e,t,i)!==this._checkCounterclockwise(e,t,o)},_checkCounterclockwise:function(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}}),L.Polyline.include({intersects:function(){var e,t,i,o=this._getProjectedPoints(),a=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(e=a-1;e>=3;e--)if(t=o[e-1],i=o[e],this._lineSegmentsIntersectsRange(t,i,e-2))return!0;return!1},newLatLngIntersects:function(e,t){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(e),t)},newPointIntersects:function(e,t){var i=this._getProjectedPoints(),o=i?i.length:0,a=i?i[o-1]:null,r=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(a,e,r,t?1:0)},_tooFewPointsForIntersection:function(e){var t=this._getProjectedPoints(),i=t?t.length:0;return i+=e||0,!t||i<=3},_lineSegmentsIntersectsRange:function(e,t,i,o){var a,r,d=this._getProjectedPoints();o=o||0;for(var p=i;p>o;p--)if(a=d[p-1],r=d[p],L.LineUtil.segmentsIntersect(e,t,a,r))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var e=[],t=this._defaultShape(),i=0;i<t.length;i++)e.push(this._map.latLngToLayerPoint(t[i]));return e}}),L.Polygon.include({intersects:function(){var e,t,i,o,a=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(e=a.length,t=a[0],i=a[e-1],o=e-2,this._lineSegmentsIntersectsRange(i,t,o,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(e){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,e);var t;this._toolbars={},L.DrawToolbar&&this.options.draw&&(t=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=t,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(t=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=t,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(e){var t,i=L.DomUtil.create("div","leaflet-draw"),o=!1;for(var a in this._toolbars)this._toolbars.hasOwnProperty(a)&&(t=this._toolbars[a].addToolbar(e))&&(o||(L.DomUtil.hasClass(t,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(t.childNodes[0],"leaflet-draw-toolbar-top"),o=!0),i.appendChild(t));return i},onRemove:function(){for(var e in this._toolbars)this._toolbars.hasOwnProperty(e)&&this._toolbars[e].removeToolbar()},setDrawingOptions:function(e){for(var t in this._toolbars)this._toolbars[t]instanceof L.DrawToolbar&&this._toolbars[t].setOptions(e)},_toolbarEnabled:function(e){var t=e.target;for(var i in this._toolbars)this._toolbars[i]!==t&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(e){L.setOptions(this,e),this._modes={},this._actionButtons=[],this._activeMode=null;var t=L.version.split(".");parseInt(t[0],10)===1&&parseInt(t[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(e){var t,i=L.DomUtil.create("div","leaflet-draw-section"),o=0,a=this._toolbarClass||"",r=this.getModeHandlers(e);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=e,t=0;t<r.length;t++)r[t].enabled&&this._initModeHandler(r[t].handler,this._toolbarContainer,o++,a,r[t].title);if(o)return this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i},removeToolbar:function(){for(var e in this._modes)this._modes.hasOwnProperty(e)&&(this._disposeButton(this._modes[e].button,this._modes[e].handler.enable,this._modes[e].handler),this._modes[e].handler.disable(),this._modes[e].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var t=0,i=this._actionButtons.length;t<i;t++)this._disposeButton(this._actionButtons[t].button,this._actionButtons[t].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(e,t,i,o,a){var r=e.type;this._modes[r]={},this._modes[r].handler=e,this._modes[r].button=this._createButton({type:r,title:a,className:o+"-"+r,container:t,callback:this._modes[r].handler.enable,context:this._modes[r].handler}),this._modes[r].buttonIndex=i,this._modes[r].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!s.MSStream},_createButton:function(e){var t=L.DomUtil.create("a",e.className||"",e.container),i=L.DomUtil.create("span","sr-only",e.container);t.href="#",t.appendChild(i),e.title&&(t.title=e.title,i.innerHTML=e.title),e.text&&(t.innerHTML=e.text,i.innerHTML=e.text);var o=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(t,"click",L.DomEvent.stopPropagation).on(t,"mousedown",L.DomEvent.stopPropagation).on(t,"dblclick",L.DomEvent.stopPropagation).on(t,"touchstart",L.DomEvent.stopPropagation).on(t,"click",L.DomEvent.preventDefault).on(t,o,e.callback,e.context),t},_disposeButton:function(e,t){var i=this._detectIOS()?"touchstart":"click";L.DomEvent.off(e,"click",L.DomEvent.stopPropagation).off(e,"mousedown",L.DomEvent.stopPropagation).off(e,"dblclick",L.DomEvent.stopPropagation).off(e,"touchstart",L.DomEvent.stopPropagation).off(e,"click",L.DomEvent.preventDefault).off(e,i,t)},_handlerActivated:function(e){this.disable(),this._activeMode=this._modes[e.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(e){var t,i,o,a,r=this._actionsContainer,d=this.getActions(e),p=d.length;for(i=0,o=this._actionButtons.length;i<o;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];r.firstChild;)r.removeChild(r.firstChild);for(var f=0;f<p;f++)"enabled"in d[f]&&!d[f].enabled||(t=L.DomUtil.create("li","",r),a=this._createButton({title:d[f].title,text:d[f].text,container:t,callback:d[f].callback,context:d[f].context}),this._actionButtons.push({button:a,callback:d[f].callback}))},_showActionsToolbar:function(){var e=this._activeMode.buttonIndex,t=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+"px",e===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),e===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(e){this._map=e,this._popupPane=e._panes.popupPane,this._visible=!1,this._container=e.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(e){return this._container?(e.subtext=e.subtext||"",e.subtext.length!==0||this._singleLineLabel?e.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(e.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+e.subtext+"</span><br />":"")+"<span>"+e.text+"</span>",e.text||e.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(e){var t=this._map.latLngToLayerPoint(e),i=this._container;return this._container&&(this._visible&&(i.style.visibility="inherit"),L.DomUtil.setPosition(i,t)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(e){for(var t in this.options)this.options.hasOwnProperty(t)&&e[t]&&(e[t]=L.extend({},this.options[t],e[t]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,e)},getModeHandlers:function(e){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(e,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(e,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(e,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(e,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(e,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(e,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(e){return[{enabled:e.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:e.completeShape,context:e},{enabled:e.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:e.deleteLastVertex,context:e},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(e){L.setOptions(this,e);for(var t in this._modes)this._modes.hasOwnProperty(t)&&e.hasOwnProperty(t)&&this._modes[t].handler.setOptions(e[t])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(e){e.edit&&(e.edit.selectedPathOptions===void 0&&(e.edit.selectedPathOptions=this.options.edit.selectedPathOptions),e.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,e.edit.selectedPathOptions)),e.remove&&(e.remove=L.extend({},this.options.remove,e.remove)),e.poly&&(e.poly=L.extend({},this.options.poly,e.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,e),this._selectedFeatureCount=0},getModeHandlers:function(e){var t=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(e,{featureGroup:t,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(e,{featureGroup:t}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(e){var t=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return e.removeAllLayers&&t.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),t},addToolbar:function(e){var t=L.Toolbar.prototype.addToolbar.call(this,e);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),t},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var e,t=this.options.featureGroup,i=t.getLayers().length!==0;this.options.edit&&(e=this._modes[L.EditToolbar.Edit.TYPE].button,i?L.DomUtil.removeClass(e,"leaflet-disabled"):L.DomUtil.addClass(e,"leaflet-disabled"),e.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(e=this._modes[L.EditToolbar.Delete.TYPE].button,i?L.DomUtil.removeClass(e,"leaflet-disabled"):L.DomUtil.addClass(e,"leaflet-disabled"),e.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(e,t){if(L.Handler.prototype.initialize.call(this,e),L.setOptions(this,t),this._featureGroup=t.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(e.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),e._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(e){this._revertLayer(e)},this)},save:function(){var e=new L.LayerGroup;this._featureGroup.eachLayer(function(t){t.edited&&(e.addLayer(t),t.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:e})},_backupLayer:function(e){var t=L.Util.stamp(e);this._uneditedLayerProps[t]||(e instanceof L.Polyline||e instanceof L.Polygon||e instanceof L.Rectangle?this._uneditedLayerProps[t]={latlngs:L.LatLngUtil.cloneLatLngs(e.getLatLngs())}:e instanceof L.Circle?this._uneditedLayerProps[t]={latlng:L.LatLngUtil.cloneLatLng(e.getLatLng()),radius:e.getRadius()}:(e instanceof L.Marker||e instanceof L.CircleMarker)&&(this._uneditedLayerProps[t]={latlng:L.LatLngUtil.cloneLatLng(e.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(e){var t=L.Util.stamp(e);e.edited=!1,this._uneditedLayerProps.hasOwnProperty(t)&&(e instanceof L.Polyline||e instanceof L.Polygon||e instanceof L.Rectangle?e.setLatLngs(this._uneditedLayerProps[t].latlngs):e instanceof L.Circle?(e.setLatLng(this._uneditedLayerProps[t].latlng),e.setRadius(this._uneditedLayerProps[t].radius)):(e instanceof L.Marker||e instanceof L.CircleMarker)&&e.setLatLng(this._uneditedLayerProps[t].latlng),e.fire("revert-edited",{layer:e}))},_enableLayerEdit:function(e){var t,i,o=e.layer||e.target||e;this._backupLayer(o),this.options.poly&&(i=L.Util.extend({},this.options.poly),o.options.poly=i),this.options.selectedPathOptions&&(t=L.Util.extend({},this.options.selectedPathOptions),t.maintainColor&&(t.color=o.options.color,t.fillColor=o.options.fillColor),o.options.original=L.extend({},o.options),o.options.editing=t),o instanceof L.Marker?(o.editing&&o.editing.enable(),o.dragging.enable(),o.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):o.editing.enable()},_disableLayerEdit:function(e){var t=e.layer||e.target||e;t.edited=!1,t.editing&&t.editing.disable(),delete t.options.editing,delete t.options.original,this._selectedPathOptions&&(t instanceof L.Marker?this._toggleMarkerHighlight(t):(t.setStyle(t.options.previousOptions),delete t.options.previousOptions)),t instanceof L.Marker?(t.dragging.disable(),t.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):t.editing.disable()},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng)},_onMarkerDragEnd:function(e){var t=e.target;t.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:t})},_onTouchMove:function(e){var t=e.originalEvent.changedTouches[0],i=this._map.mouseEventToLayerPoint(t),o=this._map.layerPointToLatLng(i);e.target.setLatLng(o)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(e,t){if(L.Handler.prototype.initialize.call(this,e),L.Util.setOptions(this,t),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(e.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(e){this._deletableLayers.addLayer(e),e.fire("revert-deleted",{layer:e})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(e){this._removeLayer({layer:e})},this),this.save()},_enableLayerDelete:function(e){(e.layer||e.target||e).on("click",this._removeLayer,this)},_disableLayerDelete:function(e){var t=e.layer||e.target||e;t.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(t)},_removeLayer:function(e){var t=e.layer||e.target||e;this._deletableLayers.removeLayer(t),this._deletedLayers.addLayer(t),t.fire("deleted")},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const $t={class:"map-container"},Gt=["id"],Ut={key:0,class:"map-loading"},zt={key:1,class:"drawing-error"},Ht={__name:"PolygonDrawingMap",props:{drawnGeometry:{type:Object,default:null},boundaryGeometry:{type:Object,default:null},restrictToParent:{type:Boolean,default:!1},initialZoom:{type:Number,default:12},initialCenter:{type:Object,default:()=>({lat:25.276987,lng:55.296249})},mapId:{type:String,default:()=>`polygon-map-${Math.random().toString(36).substr(2,9)}`}},emits:["update:drawnGeometry"],setup(s,{emit:u}){const c=s,D=u,e=k(!0),t=k(""),i=k(!1);let o=null,a=null,r=null,d=null;_e(()=>{setTimeout(()=>{p()},100)}),W(()=>c.boundaryGeometry,v=>{v&&o&&i.value&&G()}),W(()=>c.drawnGeometry,v=>{v&&o&&i.value&&!F(v,B())&&H(v)}),Te(()=>{f()});function p(){if(!i.value){e.value=!0;try{if(!document.getElementById(c.mapId)){console.error(`Map container with id ${c.mapId} not found`);return}o=$.map(c.mapId).setView([c.initialCenter.lat,c.initialCenter.lng],c.initialZoom),$.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:19}).addTo(o),a=new $.FeatureGroup,o.addLayer(a),c.boundaryGeometry&&G(),d=new $.Control.Draw({draw:{polyline:!1,circle:!1,circlemarker:!1,marker:!1,rectangle:!1,polygon:{allowIntersection:!1,showArea:!1,showLength:!1,shapeOptions:{color:"#3388ff",weight:3}}},edit:{featureGroup:a,remove:!0}}),o.addControl(d),o.on($.Draw.Event.CREATED,U),o.on($.Draw.Event.EDITED,j),o.on($.Draw.Event.DELETED,O),c.drawnGeometry&&H(c.drawnGeometry),i.value=!0}catch(v){console.error("Error initializing map:",v),t.value="Could not initialize map. Please refresh the page."}finally{e.value=!1}}}function f(){o&&(o.off($.Draw.Event.CREATED,U),o.off($.Draw.Event.EDITED,j),o.off($.Draw.Event.DELETED,O),o.remove(),o=null,i.value=!1)}function G(){o&&(r&&o.removeLayer(r),r=$.geoJSON(c.boundaryGeometry,{style:{color:"#3388ff",weight:3,opacity:.5,fillOpacity:.1}}).addTo(o),r.getBounds().isValid()&&o.fitBounds(r.getBounds()))}function U(v){t.value="";const w=v.layer;if(c.restrictToParent&&r&&!x(w)){t.value="Drawing must be entirely within the parent project boundaries";return}a.clearLayers(),a.addLayer(w);const y=N(w);D("update:drawnGeometry",y)}function j(v){t.value="";const w=v.layers;if(c.restrictToParent&&r){let y=!0;if(w.eachLayer(M=>{x(M)||(y=!1)}),!y){t.value="Drawing must be entirely within the parent project boundaries";return}}if(a.getLayers().length===1){const y=N(a.getLayers()[0]);D("update:drawnGeometry",y)}}function O(){t.value="",D("update:drawnGeometry",null)}function x(v){if(!r)return!0;try{const w=v.toGeoJSON(),y=r.toGeoJSON();if(w.geometry.type==="Point"){const M=w.geometry.coordinates;return C(M,y)}return w.geometry.type==="Polygon"?w.geometry.coordinates[0].every(_=>C(_,y)):!1}catch(w){return console.error("Error checking boundary containment:",w),!1}}function C(v,w){if(!w)return!0;if(w.type==="FeatureCollection")return w.features.some(y=>C(v,y.geometry));if(w.type==="Feature")return C(v,w.geometry);if(w.type==="Polygon"){const y=v[0],M=v[1],_=w.coordinates[0];let T=!1;for(let R=0,Z=_.length-1;R<_.length;Z=R++){const Q=_[R][0],X=_[R][1],re=_[Z][0],K=_[Z][1];X>M!=K>M&&y<(re-Q)*(M-X)/(K-X)+Q&&(T=!T)}return T}return!1}function N(v){return v?v.toGeoJSON().geometry:null}function B(){return!a||a.getLayers().length===0?null:N(a.getLayers()[0])}function H(v){if(!o||!v)return;a.clearLayers(),$.geoJSON(v).eachLayer(y=>{a.addLayer(y)}),a.getBounds().isValid()&&o.fitBounds(a.getBounds())}function F(v,w){return!v||!w?v===w:JSON.stringify(v)===JSON.stringify(w)}return W(()=>c.boundaryGeometry,v=>{v&&o&&i.value&&(r&&(o.removeLayer(r),r=null),G(),setTimeout(()=>{o.invalidateSize(),r&&r.getBounds().isValid()&&o.fitBounds(r.getBounds())},100))},{deep:!0}),(v,w)=>{const y=fe;return m(),g("div",$t,[n("div",{id:s.mapId,class:"map"},null,8,Gt),e.value?(m(),g("div",Ut,[b(y)])):P("",!0),t.value?(m(),g("div",zt,I(t.value),1)):P("",!0)])}}},Me=se(Ht,[["__scopeId","data-v-ef0e9609"]]),At={class:"p-4"},Rt={class:"option-group"},Nt={key:0,class:"option-group"},Bt={key:1,class:"form-container"},Ft={key:0},Vt={class:"form-container"},Yt={class:"map-container"},Wt={key:1},Zt={class:"form-container"},Xt={class:"map-container"},qt={key:2},Jt={class:"form-container"},Qt={class:"map-container"},Kt={key:2,class:"phases-detected-container"},ei={class:"info-box mb-4"},ti={class:"phases-list"},ii={class:"phase-items"},oi={class:"flex justify-between"},ai={key:3,class:"processing-container"},ni={class:"processing-title"},si={class:"processing-message"},ri={key:0,class:"processing-results"},li={key:4,class:"success-container"},di={class:"mb-4"},ci={class:"action-buttons"},hi={__name:"ProjectCreationDialog",props:{visible:Boolean},emits:["update:visible","project-created"],setup(s,{emit:u}){const c=s,D=u,e=xe(),t=Pe(),i=it(),o=De(),a=k("type-selection"),r=k(null),d=k(null),p=k(null),f=k(null),G=k(null),U=k(null),j=k(null),O=k(null),x=k(""),C=k(!1),N=k(!1),B=k([]),H=k("Creating territory..."),F=k("Your project has been created successfully."),v=k(null),w=k(!0),y=k({project_name:"",territory:null,developer:null,project_amenities:null,handover_quarter:null,handover_year:null,status:"Off-plan",availability:"Available",cover_image:null}),M=S(()=>[{name:"project_name",label:"Project Name",type:"text",validation:"required",icon:"pi pi-bookmark",fullWidth:!0},{name:"developer",label:"Developer",type:"link",doctype:"PRP Developer",validation:"required",icon:"pi pi-building",fullWidth:!1},{name:"handover_quarter",label:"Handover Quarter",type:"select",options:[1,2,3,4],icon:"pi pi-calendar",fullWidth:!1},{name:"handover_year",label:"Handover Year",type:"select",options:Z,icon:"pi pi-calendar",fullWidth:!1},{name:"availability",label:"Availability",type:"select",options:Q,icon:"pi pi-tag",fullWidth:!1}]),_=S(()=>{switch(a.value){case"type-selection":return"1";case"project-scale":case"parent-selection":return"2";case"building-location":case"development-area":case"phase-area":return"3";case"project-details":return"4";default:return"1"}}),T=k("Processing"),R=k([]),Z=Array.from({length:10},(h,l)=>new Date().getFullYear()+l),Q=["Available","Sold","Available for Secondhand"],X=S(()=>!["processing","success","project-details"].includes(a.value)),re=S(()=>a.value!=="type-selection"),K=S(()=>{switch(a.value){case"phases-detected":return"Convert to Phases";case"building-location":case"development-area":case"phase-area":return"Continue";default:return"Next"}}),me=S(()=>a.value==="phases-detected"?"pi pi-sitemap":"pi pi-arrow-right"),Ie=S(()=>{switch(a.value){case"type-selection":return!r.value;case"project-scale":return!d.value;case"parent-selection":return!p.value;case"building-location":return!U.value||!x.value.trim();case"development-area":case"phase-area":return!j.value||!x.value.trim();default:return!1}});W(()=>c.visible,h=>{h&&ce()}),W(x,h=>{y.value.project_name=h});function je(){switch(a.value){case"type-selection":case"project-scale":le();break;case"parent-selection":$e();break;case"building-location":Ge();break;case"development-area":Ue();break;case"phase-area":ze();break;case"phases-detected":Le();break}}function le(){switch(a.value){case"type-selection":r.value==="project"?a.value="project-scale":a.value="parent-selection";break;case"project-scale":d.value==="building"?a.value="building-location":a.value="development-area";break}}function de(){switch(a.value){case"project-scale":a.value="type-selection";break;case"parent-selection":a.value="type-selection";break;case"building-location":case"development-area":a.value="project-scale";break;case"phase-area":a.value="parent-selection";break;case"project-details":r.value==="project"?d.value==="building"?a.value="building-location":a.value="development-area":a.value="phase-area";break}}function ve(h){r.value=h,le()}function ge(h){d.value=h,le()}function Oe(h){y.value=Ee(ke({},h),{territory:y.value.territory}),He()}function $e(){return A(this,null,function*(){if(p.value){N.value=!0;try{const h=yield e.fetchProject(p.value);if(!h||!h.territory)throw new Error("Unable to load project territory");const l=yield t.fetchTerritory(h.territory);if(!l||!l.geo)throw new Error("Project territory has no geometry data");f.value=JSON.parse(l.geo),G.value=l.name,a.value="phase-area"}catch(h){i.add({severity:"error",summary:"Error",detail:h.message||"Failed to load parent project",life:5e3}),console.error("Error loading parent project:",h)}finally{N.value=!1}}})}function Ge(){return A(this,null,function*(){if(!(!U.value||!x.value.trim())){C.value=!0,a.value="processing",H.value="Creating building territory...";try{const h={type:"Point",coordinates:[U.value.lng,U.value.lat]},l=yield t.createTerritoryFromGeometry(x.value,h,!0);if(l.success)O.value=l.territory_id,y.value.territory=l.territory_id,a.value="project-details";else throw new Error(l.message||"Failed to create territory")}catch(h){q(h,"Failed to create building territory")}finally{C.value=!1}}})}function Ue(){return A(this,null,function*(){if(!(!j.value||!x.value.trim())){C.value=!0,a.value="processing",T.value="Creating Project Territory",H.value="Drawing boundaries and analyzing location...",R.value=[];try{const h=yield t.createTerritoryFromGeometry(x.value,j.value,!0);if(h.success)console.log(h),O.value=h.territory_id,R.value.push({icon:"pi pi-map-marker text-green-500",message:"Territory boundaries created successfully"}),h.hierarchy&&h.hierarchy.length>0&&R.value.push({icon:"pi pi-sitemap text-blue-500",message:`Location identified: ${h.hierarchy.join(" › ")}`}),y.value.territory=h.territory_id,yield new Promise(l=>setTimeout(l,1500)),h.potential_phases&&h.potential_phases.length>0?(B.value=h.potential_phases,a.value="phases-detected"):a.value="project-details";else throw new Error(h.message||"Failed to create territory")}catch(h){q(h,"Failed to create development territory")}finally{C.value=!1}}})}function ze(){return A(this,null,function*(){if(!(!j.value||!x.value.trim()||!G.value)){C.value=!0,a.value="processing",H.value="Creating phase territory...";try{const h=yield t.createPhaseForProject(G.value,x.value,j.value);if(h.success)O.value=h.phase_id,y.value.territory=h.phase_id,a.value="project-details";else throw new Error(h.message||"Failed to create phase")}catch(h){q(h,"Failed to create phase territory")}finally{C.value=!1}}})}function He(){return A(this,null,function*(){if(!(!y.value.project_name||!y.value.developer||!y.value.territory)){C.value=!0,a.value="processing",H.value="Creating project...";try{const h=yield e.createProject(y.value);v.value=h.name,r.value==="phase"?F.value="Your phase has been created successfully.":F.value="Your project has been created successfully.",a.value="success",D("project-created",h)}catch(h){q(h,"Failed to create project")}finally{C.value=!1}}})}function Le(){return A(this,null,function*(){if(O.value){C.value=!0,H.value="Converting territories to phases...";try{const h=yield t.convertToPhasesForProject(O.value);if(h.success)i.add({severity:"success",summary:"Success",detail:h.message||"Territories converted to phases successfully",life:3e3}),a.value="project-details";else throw new Error(h.message||"Failed to convert phases")}catch(h){q(h,"Failed to convert territories to phases")}finally{C.value=!1}}})}function Ae(){return A(this,null,function*(){try{yield call("prp.prp.doctype.prp_territory.prp_territory.clear_potential_phases",{project_id:O.value}),a.value="project-details"}catch(h){console.error("Error clearing potential phases:",h),a.value="project-details"}})}function Re(){v.value&&(ye(),o.push(`/projects/${v.value}`))}function q(h,l){console.error(h),i.add({severity:"error",summary:"Error",detail:h.message||l,life:5e3}),de()}function ce(){a.value="type-selection",r.value=null,d.value=null,p.value=null,f.value=null,G.value=null,U.value=null,j.value=null,O.value=null,x.value="",B.value=[],H.value="Creating territory...",F.value="Your project has been created successfully.",v.value=null,y.value={project_name:"",territory:null,developer:null,project_amenities:null,handover_quarter:null,handover_year:null,status:"Off-plan",availability:"Available",cover_image:null}}function ye(){ce(),D("update:visible",!1)}return(h,l)=>{const ee=te("Step"),Ne=te("StepList"),he=te("StepPanel"),pe=at,Be=te("StepPanels"),Fe=Se,Y=Ce,Ve=fe,Ye=nt;return m(),ie(Ye,{visible:s.visible,style:{width:"85vw",maxWidth:"950px"},modal:!0,closable:a.value!=="processing",class:"project-creation-dialog",onHide:ye,"onUpdate:visible":l[12]||(l[12]=E=>D("update:visible",E))},ot({default:z(()=>[n("div",At,[["processing","success","phases-detected"].includes(a.value)?P("",!0):(m(),ie(Fe,{key:0,value:_.value},{default:z(()=>[b(Ne,null,{default:z(()=>[b(ee,{value:"1"},{default:z(()=>l[13]||(l[13]=[J("Project Type")])),_:1}),b(ee,{value:"2"},{default:z(()=>l[14]||(l[14]=[J("Scale")])),_:1}),b(ee,{value:"3"},{default:z(()=>l[15]||(l[15]=[J("Location")])),_:1}),b(ee,{value:"4"},{default:z(()=>l[16]||(l[16]=[J("Details")])),_:1})]),_:1}),b(Be,{class:"mt-6"},{default:z(()=>[b(he,{value:"1"},{default:z(()=>[n("div",Rt,[n("div",{onClick:l[0]||(l[0]=E=>ve("project")),class:V(["option-item",{selected:r.value==="project"}])},l[17]||(l[17]=[n("div",{class:"option-icon"},[n("i",{class:"pi pi-building"})],-1),n("div",{class:"option-content"},[n("h3",null,"Project"),n("p",null,"Create a new standalone project")],-1)]),2),n("div",{onClick:l[1]||(l[1]=E=>ve("phase")),class:V(["option-item",{selected:r.value==="phase"}])},l[18]||(l[18]=[n("div",{class:"option-icon"},[n("i",{class:"pi pi-sitemap"})],-1),n("div",{class:"option-content"},[n("h3",null,"Phase"),n("p",null,"Create a phase within an existing project")],-1)]),2)])]),_:1}),b(he,{value:"2"},{default:z(()=>[r.value==="project"?(m(),g("div",Nt,[n("div",{onClick:l[2]||(l[2]=E=>ge("building")),class:V(["option-item",{selected:d.value==="building"}])},l[19]||(l[19]=[n("div",{class:"option-icon"},[n("i",{class:"pi pi-home"})],-1),n("div",{class:"option-content"},[n("h3",null,"Single Building"),n("p",null,"A single building or small plot")],-1)]),2),n("div",{onClick:l[3]||(l[3]=E=>ge("development")),class:V(["option-item",{selected:d.value==="development"}])},l[20]||(l[20]=[n("div",{class:"option-icon"},[n("i",{class:"pi pi-th-large"})],-1),n("div",{class:"option-content"},[n("h3",null,"Development Area"),n("p",null,"A large development with multiple buildings or phases")],-1)]),2)])):P("",!0),r.value==="phase"?(m(),g("div",Bt,[b(oe,{modelValue:p.value,"onUpdate:modelValue":l[4]||(l[4]=E=>p.value=E),type:"link",label:"Parent Project",doctype:"PRP Project",validation:"required",placeholder:"Select a project",icon:"pi pi-building"},null,8,["modelValue"]),l[21]||(l[21]=n("div",{class:"helper-text"},[n("i",{class:"pi pi-info-circle mr-2"}),n("span",null,"Select the project this phase will belong to")],-1))])):P("",!0)]),_:1}),b(he,{value:"3"},{default:z(()=>[r.value==="project"&&d.value==="building"?(m(),g("div",Ft,[n("div",Vt,[l[22]||(l[22]=n("label",{class:"field-label"},"Project Name",-1)),b(pe,{modelValue:x.value,"onUpdate:modelValue":l[5]||(l[5]=E=>x.value=E),placeholder:"Enter project name",class:"w-full"},null,8,["modelValue"])]),l[23]||(l[23]=n("div",{class:"helper-text mb-3"},[n("i",{class:"pi pi-map-marker mr-2"}),n("span",null,"Click on the map to place the marker at the building location")],-1)),n("div",Yt,[b(Ot,{selectedPoint:U.value,"onUpdate:selectedPoint":l[6]||(l[6]=E=>U.value=E),initialZoom:15,mapId:"point-selection-map-"+Math.random().toString(36).substring(2,9)},null,8,["selectedPoint","mapId"])])])):P("",!0),r.value==="project"&&d.value==="development"?(m(),g("div",Wt,[n("div",Zt,[l[24]||(l[24]=n("label",{class:"field-label"},"Project Name",-1)),b(pe,{modelValue:x.value,"onUpdate:modelValue":l[7]||(l[7]=E=>x.value=E),placeholder:"Enter project name",class:"w-full"},null,8,["modelValue"])]),l[25]||(l[25]=n("div",{class:"helper-text mb-3"},[n("i",{class:"pi pi-pencil mr-2"}),n("span",null,"Draw a polygon on the map to define the development boundaries")],-1)),n("div",Xt,[b(Me,{drawnGeometry:j.value,"onUpdate:drawnGeometry":l[8]||(l[8]=E=>j.value=E),initialZoom:14,mapId:"polygon-map-"+Math.random().toString(36).substring(2,9)},null,8,["drawnGeometry","mapId"])])])):P("",!0),r.value==="phase"?(m(),g("div",qt,[n("div",Jt,[l[26]||(l[26]=n("label",{class:"field-label"},"Phase Name",-1)),b(pe,{modelValue:x.value,"onUpdate:modelValue":l[9]||(l[9]=E=>x.value=E),placeholder:"Enter phase name (e.g. Phase 1)",class:"w-full"},null,8,["modelValue"])]),l[27]||(l[27]=n("div",{class:"helper-text mb-3"},[n("i",{class:"pi pi-pencil mr-2"}),n("span",null,"Draw a polygon within the parent project boundaries")],-1)),n("div",Qt,[b(Me,{drawnGeometry:j.value,"onUpdate:drawnGeometry":l[10]||(l[10]=E=>j.value=E),boundaryGeometry:f.value,restrictToParent:!0,initialZoom:15,mapId:"phase-map-"+Math.random().toString(36).substring(2,9)},null,8,["drawnGeometry","boundaryGeometry","mapId"])])])):P("",!0)]),_:1})]),_:1})]),_:1},8,["value"])),a.value==="project-details"?(m(),ie(ht,{key:1,visible:w.value,"onUpdate:visible":l[11]||(l[11]=E=>w.value=E),title:r.value==="phase"?"Phase Details":"Project Details",fields:M.value,initialData:y.value,submitButtonLabel:r.value==="phase"?"Create Phase":"Create Project",onSubmit:Oe,onCancel:de},null,8,["visible","title","fields","initialData","submitButtonLabel"])):P("",!0),a.value==="phases-detected"?(m(),g("div",Kt,[l[30]||(l[30]=n("div",{class:"result-icon"},[n("i",{class:"pi pi-sitemap"})],-1)),l[31]||(l[31]=n("h3",{class:"result-title"},"Phases Detected",-1)),n("div",ei,[l[28]||(l[28]=n("i",{class:"pi pi-info-circle text-blue-500 mr-2"},null,-1)),n("span",null,"We detected "+I(B.value.length)+" existing projects that appear to be phases of this project.",1)]),n("div",ti,[n("ul",ii,[(m(!0),g(ae,null,ne(B.value,E=>(m(),g("li",{key:E.id,class:"phase-item"},[l[29]||(l[29]=n("i",{class:"pi pi-building mr-2"},null,-1)),J(" "+I(E.name),1)]))),128))])]),l[32]||(l[32]=n("div",{class:"question-prompt text-center mt-4 mb-4"},[n("p",null,"Would you like to convert these to phases of your new project?")],-1)),n("div",oi,[b(Y,{label:"Skip",class:"p-button-text",onClick:Ae}),b(Y,{label:"Convert to Phases",icon:"pi pi-sitemap",onClick:Le})])])):P("",!0),a.value==="processing"?(m(),g("div",ai,[b(Ve,{class:"mb-4"}),n("h3",ni,I(T.value),1),n("p",si,I(H.value),1),R.value.length>0?(m(),g("div",ri,[(m(!0),g(ae,null,ne(R.value,(E,We)=>(m(),g("div",{key:We,class:"result-item"},[n("i",{class:V(E.icon)},null,2),n("span",null,I(E.message),1)]))),128))])):P("",!0)])):P("",!0),a.value==="success"?(m(),g("div",li,[l[33]||(l[33]=n("div",{class:"success-icon"},[n("i",{class:"pi pi-check-circle"})],-1)),l[34]||(l[34]=n("h3",{class:"mt-3 mb-2"},"Success!",-1)),n("p",di,I(F.value),1),n("div",ci,[b(Y,{label:"Add Another",icon:"pi pi-plus",class:"p-button-outlined mr-2",onClick:ce}),b(Y,{label:"View Project",icon:"pi pi-external-link",onClick:Re})])])):P("",!0)])]),_:2},[X.value?{name:"footer",fn:z(()=>[re.value?(m(),ie(Y,{key:0,label:"Back",icon:"pi pi-arrow-left",class:"p-button-text",onClick:de})):P("",!0),l[35]||(l[35]=n("div",{class:"flex-grow-1"},null,-1)),b(Y,{label:K.value,icon:me.value,disabled:Ie.value,loading:C.value&&a.value!=="processing",onClick:je},null,8,["label","icon","disabled","loading"])]),key:"0"}:void 0]),1032,["visible","closable"])}}},pi=se(hi,[["__scopeId","data-v-aa9aacf0"]]),ui={class:"pd-projects-container"},_i={class:"pd-header"},fi={class:"pd-search-container"},mi={class:"pd-search-input-wrapper"},vi={class:"pd-actions"},gi={key:0,class:"pd-filters-panel"},Li={class:"pd-filters-grid"},yi={class:"pd-filter-item"},bi={class:"pd-filter-item"},wi={class:"pd-filter-item"},ki={key:0,class:"pd-grid"},Ei={key:1,class:"pd-error-message"},Mi={key:2,class:"pd-empty-state"},Di={key:3,class:"pd-grid"},Ti={key:4,class:"pd-load-more"},xi=["disabled"],Pi={key:0,class:"pi pi-chevron-down"},Ci={key:1,class:"pi pi-spin pi-spinner"},Si={__name:"ProjectList",setup(s){const u=k(!1),c=k({territory:null,developer:null,status:null}),D=k(""),e=k(null),t=k(!1),i=k(!1),o=xe(),a=Pe(),r=[" ","Off-Plan","Due for Handover","Handover Completed"],d=S(()=>!O.value||!O.value.length?[{value:null,label:"All Territories"}]:[{value:null,label:"All Territories"},...O.value.map(M=>({value:M.name,label:M.name_en||M.name}))]),p=S(()=>o.projects),f=S(()=>o.isLoading),G=S(()=>o.hasError),U=S(()=>o.errorMessage),j=S(()=>o.hasMoreProjects),O=S(()=>a.projectTerritories),x=S(()=>c.value.territory!==null||c.value.developer!==null||c.value.status!==null),C=S(()=>p.value.filter(M=>!M.has_phases));function N(){i.value=!0}function B(M){o.refetchProjects()}function H(){clearTimeout(e.value),e.value=setTimeout(()=>{o.updateSearch(D.value)},300)}function F(){D.value="",o.updateSearch("")}const v=()=>A(this,null,function*(){const M={};c.value.territory&&(M.territory=c.value.territory),c.value.developer&&(M.developer=c.value.developer),c.value.status&&(M.status=c.value.status),yield o.updateFilters(M),u.value=!1}),w=()=>A(this,null,function*(){c.value={territory:null,developer:null,status:null},yield o.resetFilters()}),y=()=>A(this,null,function*(){t.value=!0;try{yield o.loadMoreProjects()}finally{t.value=!1}});return _e(()=>A(this,null,function*(){p.value.length||(yield o.fetchProjects()),O.value.length||(yield a.fetchTerritories())})),(M,_)=>(m(),g("div",ui,[n("header",_i,[n("div",fi,[n("div",mi,[_[7]||(_[7]=n("i",{class:"pi pi-search pd-search-icon"},null,-1)),st(n("input",{type:"text","onUpdate:modelValue":_[0]||(_[0]=T=>D.value=T),placeholder:"Search projects...",class:"pd-search-input",onInput:H},null,544),[[rt,D.value]]),D.value?(m(),g("button",{key:0,class:"pd-search-clear",onClick:F},_[6]||(_[6]=[n("i",{class:"pi pi-times"},null,-1)]))):P("",!0)])]),n("div",vi,[n("button",{class:V(["pd-button-icon",{active:u.value,"has-active-filters":x.value}]),onClick:_[1]||(_[1]=T=>u.value=!u.value)},_[8]||(_[8]=[n("i",{class:"pi pi-filter"},null,-1)]),2),n("button",{class:"pd-button-icon",style:{background:"var(--pd-text-primary)"},onClick:N},_[9]||(_[9]=[n("i",{class:"pi pi-plus text-zinc-100 dark:text-zinc-900"},null,-1)]))])]),b(lt,{name:"slide-fade"},{default:z(()=>[u.value?(m(),g("div",gi,[n("div",Li,[n("div",yi,[b(oe,{modelValue:c.value.territory,"onUpdate:modelValue":_[2]||(_[2]=T=>c.value.territory=T),type:"select",label:"Territory",options:d.value,icon:"pi pi-map-marker",id:"territory",disabled:f.value},null,8,["modelValue","options","disabled"])]),n("div",bi,[b(oe,{modelValue:c.value.developer,"onUpdate:modelValue":_[3]||(_[3]=T=>c.value.developer=T),type:"link",label:"Developer",doctype:"PRP Developer",displayField:"developer_name",icon:"pi pi-building",id:"developer",disabled:f.value},null,8,["modelValue","disabled"])]),n("div",wi,[b(oe,{modelValue:c.value.status,"onUpdate:modelValue":_[4]||(_[4]=T=>c.value.status=T),type:"select",label:"Status",options:r,icon:"pi pi-tag",id:"status",disabled:f.value},null,8,["modelValue","disabled"])])]),n("div",{class:"pd-filters-actions"},[n("button",{class:"pd-button-secondary",onClick:w},_[10]||(_[10]=[n("i",{class:"pi pi-times"},null,-1),n("span",null,"Clear",-1)])),n("button",{class:"pd-button-primary",onClick:v},_[11]||(_[11]=[n("i",{class:"pi pi-check"},null,-1),n("span",null,"Apply",-1)]))])])):P("",!0)]),_:1}),f.value?(m(),g("div",ki,[(m(),g(ae,null,ne(6,T=>n("div",{key:T,class:"pd-grid-item"},_[12]||(_[12]=[dt('<div class="pd-skeleton-card"><div class="pd-skeleton-image"></div><div class="pd-skeleton-content"><div class="pd-skeleton-line pd-skeleton-title"></div><div class="pd-skeleton-line"></div><div class="pd-skeleton-line"></div><div class="pd-skeleton-line pd-skeleton-button"></div></div></div>',1)]))),64))])):G.value?(m(),g("div",Ei,[_[13]||(_[13]=n("i",{class:"pi pi-exclamation-circle"},null,-1)),n("p",null,I(U.value),1)])):p.value.length?(m(),g("div",Di,[(m(!0),g(ae,null,ne(C.value,T=>(m(),g("div",{key:T.name,class:"pd-grid-item"},[b(Pt,{project:T},null,8,["project"])]))),128))])):(m(),g("div",Mi,[_[15]||(_[15]=n("div",{class:"pd-empty-icon"},[n("i",{class:"pi pi-building"})],-1)),_[16]||(_[16]=n("h3",null,"No projects found",-1)),_[17]||(_[17]=n("p",null,"Try adjusting your filters or add a new project.",-1)),n("button",{class:"pd-button-primary",onClick:N},_[14]||(_[14]=[n("i",{class:"pi pi-plus"},null,-1),n("span",null,"Add Project",-1)]))])),j.value?(m(),g("div",Ti,[n("button",{class:"pd-button-secondary",onClick:y,disabled:t.value},[n("span",null,I(t.value?"Loading...":"Load More"),1),t.value?(m(),g("i",Ci)):(m(),g("i",Pi))],8,xi)])):P("",!0),b(pi,{visible:i.value,"onUpdate:visible":_[5]||(_[5]=T=>i.value=T),onProjectCreated:B},null,8,["visible"])]))}},Ii={class:"page-container"},ji={class:"header"},Oi={class:"actions"},zi={__name:"Projects",setup(s){const u=ct("mapDialog");function c(){u&&u.open()}return(D,e)=>{const t=Ce;return m(),g("div",Ii,[n("div",ji,[e[0]||(e[0]=n("h1",null,"Projects",-1)),n("div",Oi,[b(t,{icon:"pi pi-map",class:"p-button-primary mr-2",onClick:c,label:"Map View"})])]),b(Si)])}}};export{zi as default};
