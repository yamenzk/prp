var an=Object.defineProperty,on=Object.defineProperties;var ln=Object.getOwnPropertyDescriptors;var xt=Object.getOwnPropertySymbols;var rn=Object.prototype.hasOwnProperty,un=Object.prototype.propertyIsEnumerable;var wt=(e,t,n)=>t in e?an(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Q=(e,t)=>{for(var n in t||(t={}))rn.call(t,n)&&wt(e,n,t[n]);if(xt)for(var n of xt(t))un.call(t,n)&&wt(e,n,t[n]);return e},ve=(e,t)=>on(e,ln(t));var T=(e,t,n)=>new Promise((o,a)=>{var s=g=>{try{m(n.next(g))}catch(b){a(b)}},h=g=>{try{m(n.throw(g))}catch(b){a(b)}},m=g=>g.done?o(g.value):Promise.resolve(g.value).then(s,h);m((n=n.apply(e,t)).next())});import{s as cn,b as Je,c as qe,_ as $e,f as Ge,N as dn,a as _t,u as Tt,d as It,e as Ft,g as pn,h as mn}from"./NotesView-B6CgINqt.js";import{b5 as ke,b6 as et,b7 as fn,b8 as Dt,b9 as $t,ba as Re,bb as vn,M as gn,j as u,k as c,l as i,A as H,N as tt,Z as Pt,R as Et,ac as nt,B as se,P as it,q as Z,C as S,Q as me,t as pe,g as X,S as je,x as M,bc as hn,aq as bn,O as Ne,y as ge,z as E,L as Be,at as Mt,H as ce,D as v,F as le,aK as yn,aJ as kt,ar as Ct,E as xn,_ as we,r as w,a_ as oe,b0 as zt,bd as st,a$ as Ee,i as Me,aZ as Ce,a as N,o as be,n as wn,b2 as At,m as ze,e as he,b3 as Rt,be as Ot,bf as He,aQ as _n,I as Xe,aR as Dn,aS as $n,ae as kn,b1 as Cn,bg as Ln,K as Lt,bh as Ut,v as Vt,aX as jn,p as Bn}from"./index-BXHSmgx-.js";import{_ as Ve,u as Sn}from"./CreateDialog-DeYsMeuo.js";function Ue(e,t){const n=+ke(e)-+ke(t);return n<0?-1:n>0?1:n}function Tn(e,t,n){const[o,a]=et(n==null?void 0:n.in,e,t),s=o.getFullYear()-a.getFullYear(),h=o.getMonth()-a.getMonth();return s*12+h}function In(e){return t=>{const o=(e?Math[e]:Math.trunc)(t);return o===0?0:o}}function Fn(e,t){return+ke(e)-+ke(t)}function Pn(e,t){const n=ke(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function En(e,t){const n=ke(e,t==null?void 0:t.in),o=n.getMonth();return n.setFullYear(n.getFullYear(),o+1,0),n.setHours(23,59,59,999),n}function Mn(e,t){const n=ke(e,t==null?void 0:t.in);return+Pn(n,t)==+En(n,t)}function zn(e,t,n){const[o,a,s]=et(n==null?void 0:n.in,e,e,t),h=Ue(a,s),m=Math.abs(Tn(a,s));if(m<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-h*m);let g=Ue(a,s)===-h;Mn(o)&&m===1&&Ue(o,s)===1&&(g=!1);const b=h*(m-+g);return b===0?0:b}function An(e,t,n){const o=Fn(e,t)/1e3;return In(n==null?void 0:n.roundingMethod)(o)}function Rn(e,t,n){var j,r;const o=vn(),a=(r=(j=n==null?void 0:n.locale)!=null?j:o.locale)!=null?r:fn,s=2520,h=Ue(e,t);if(isNaN(h))throw new RangeError("Invalid time value");const m=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:h}),[g,b]=et(n==null?void 0:n.in,...h>0?[t,e]:[e,t]),y=An(b,g),C=(Dt(b)-Dt(g))/1e3,D=Math.round((y-C)/60);let I;if(D<2)return n!=null&&n.includeSeconds?y<5?a.formatDistance("lessThanXSeconds",5,m):y<10?a.formatDistance("lessThanXSeconds",10,m):y<20?a.formatDistance("lessThanXSeconds",20,m):y<40?a.formatDistance("halfAMinute",0,m):y<60?a.formatDistance("lessThanXMinutes",1,m):a.formatDistance("xMinutes",1,m):D===0?a.formatDistance("lessThanXMinutes",1,m):a.formatDistance("xMinutes",D,m);if(D<45)return a.formatDistance("xMinutes",D,m);if(D<90)return a.formatDistance("aboutXHours",1,m);if(D<$t){const d=Math.round(D/60);return a.formatDistance("aboutXHours",d,m)}else{if(D<s)return a.formatDistance("xDays",1,m);if(D<Re){const d=Math.round(D/$t);return a.formatDistance("xDays",d,m)}else if(D<Re*2)return I=Math.round(D/Re),a.formatDistance("aboutXMonths",I,m)}if(I=zn(b,g),I<12){const d=Math.round(D/Re);return a.formatDistance("xMonths",d,m)}else{const d=I%12,L=Math.trunc(I/12);return d<3?a.formatDistance("aboutXYears",L,m):d<9?a.formatDistance("overXYears",L,m):a.formatDistance("almostXYears",L+1,m)}}var qt={name:"UploadIcon",extends:gn};function On(e,t,n,o,a,s){return u(),c("svg",H({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.pti()),t[0]||(t[0]=[i("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.58942 9.82197C6.70165 9.93405 6.85328 9.99793 7.012 10C7.17071 9.99793 7.32234 9.93405 7.43458 9.82197C7.54681 9.7099 7.61079 9.55849 7.61286 9.4V2.04798L9.79204 4.22402C9.84752 4.28011 9.91365 4.32457 9.98657 4.35479C10.0595 4.38502 10.1377 4.40039 10.2167 4.40002C10.2956 4.40039 10.3738 4.38502 10.4467 4.35479C10.5197 4.32457 10.5858 4.28011 10.6413 4.22402C10.7538 4.11152 10.817 3.95902 10.817 3.80002C10.817 3.64102 10.7538 3.48852 10.6413 3.37602L7.45127 0.190618C7.44656 0.185584 7.44176 0.180622 7.43687 0.175736C7.32419 0.063214 7.17136 0 7.012 0C6.85264 0 6.69981 0.063214 6.58712 0.175736C6.58181 0.181045 6.5766 0.186443 6.5715 0.191927L3.38282 3.37602C3.27669 3.48976 3.2189 3.6402 3.22165 3.79564C3.2244 3.95108 3.28746 4.09939 3.39755 4.20932C3.50764 4.31925 3.65616 4.38222 3.81182 4.38496C3.96749 4.3877 4.11814 4.33001 4.23204 4.22402L6.41113 2.04807V9.4C6.41321 9.55849 6.47718 9.7099 6.58942 9.82197ZM11.9952 14H2.02883C1.751 13.9887 1.47813 13.9228 1.22584 13.8061C0.973545 13.6894 0.746779 13.5241 0.558517 13.3197C0.370254 13.1154 0.22419 12.876 0.128681 12.6152C0.0331723 12.3545 -0.00990605 12.0775 0.0019109 11.8V9.40005C0.0019109 9.24092 0.065216 9.08831 0.1779 8.97579C0.290584 8.86326 0.443416 8.80005 0.602775 8.80005C0.762134 8.80005 0.914966 8.86326 1.02765 8.97579C1.14033 9.08831 1.20364 9.24092 1.20364 9.40005V11.8C1.18295 12.0376 1.25463 12.274 1.40379 12.4602C1.55296 12.6463 1.76817 12.7681 2.00479 12.8H11.9952C12.2318 12.7681 12.447 12.6463 12.5962 12.4602C12.7453 12.274 12.817 12.0376 12.7963 11.8V9.40005C12.7963 9.24092 12.8596 9.08831 12.9723 8.97579C13.085 8.86326 13.2378 8.80005 13.3972 8.80005C13.5565 8.80005 13.7094 8.86326 13.8221 8.97579C13.9347 9.08831 13.998 9.24092 13.998 9.40005V11.8C14.022 12.3563 13.8251 12.8996 13.45 13.3116C13.0749 13.7236 12.552 13.971 11.9952 14Z",fill:"currentColor"},null,-1)]),16)}qt.render=On;var Un=({dt:e})=>`
.p-message {
    border-radius: ${e("message.border.radius")};
    outline-width: ${e("message.border.width")};
    outline-style: solid;
}

.p-message-content {
    display: flex;
    align-items: center;
    padding: ${e("message.content.padding")};
    gap: ${e("message.content.gap")};
    height: 100%;
}

.p-message-icon {
    flex-shrink: 0;
}

.p-message-close-button {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-inline-start: auto;
    overflow: hidden;
    position: relative;
    width: ${e("message.close.button.width")};
    height: ${e("message.close.button.height")};
    border-radius: ${e("message.close.button.border.radius")};
    background: transparent;
    transition: background ${e("message.transition.duration")}, color ${e("message.transition.duration")}, outline-color ${e("message.transition.duration")}, box-shadow ${e("message.transition.duration")}, opacity 0.3s;
    outline-color: transparent;
    color: inherit;
    padding: 0;
    border: none;
    cursor: pointer;
    user-select: none;
}

.p-message-close-icon {
    font-size: ${e("message.close.icon.size")};
    width: ${e("message.close.icon.size")};
    height: ${e("message.close.icon.size")};
}

.p-message-close-button:focus-visible {
    outline-width: ${e("message.close.button.focus.ring.width")};
    outline-style: ${e("message.close.button.focus.ring.style")};
    outline-offset: ${e("message.close.button.focus.ring.offset")};
}

.p-message-info {
    background: ${e("message.info.background")};
    outline-color: ${e("message.info.border.color")};
    color: ${e("message.info.color")};
    box-shadow: ${e("message.info.shadow")};
}

.p-message-info .p-message-close-button:focus-visible {
    outline-color: ${e("message.info.close.button.focus.ring.color")};
    box-shadow: ${e("message.info.close.button.focus.ring.shadow")};
}

.p-message-info .p-message-close-button:hover {
    background: ${e("message.info.close.button.hover.background")};
}

.p-message-info.p-message-outlined {
    color: ${e("message.info.outlined.color")};
    outline-color: ${e("message.info.outlined.border.color")};
}

.p-message-info.p-message-simple {
    color: ${e("message.info.simple.color")};
}

.p-message-success {
    background: ${e("message.success.background")};
    outline-color: ${e("message.success.border.color")};
    color: ${e("message.success.color")};
    box-shadow: ${e("message.success.shadow")};
}

.p-message-success .p-message-close-button:focus-visible {
    outline-color: ${e("message.success.close.button.focus.ring.color")};
    box-shadow: ${e("message.success.close.button.focus.ring.shadow")};
}

.p-message-success .p-message-close-button:hover {
    background: ${e("message.success.close.button.hover.background")};
}

.p-message-success.p-message-outlined {
    color: ${e("message.success.outlined.color")};
    outline-color: ${e("message.success.outlined.border.color")};
}

.p-message-success.p-message-simple {
    color: ${e("message.success.simple.color")};
}

.p-message-warn {
    background: ${e("message.warn.background")};
    outline-color: ${e("message.warn.border.color")};
    color: ${e("message.warn.color")};
    box-shadow: ${e("message.warn.shadow")};
}

.p-message-warn .p-message-close-button:focus-visible {
    outline-color: ${e("message.warn.close.button.focus.ring.color")};
    box-shadow: ${e("message.warn.close.button.focus.ring.shadow")};
}

.p-message-warn .p-message-close-button:hover {
    background: ${e("message.warn.close.button.hover.background")};
}

.p-message-warn.p-message-outlined {
    color: ${e("message.warn.outlined.color")};
    outline-color: ${e("message.warn.outlined.border.color")};
}

.p-message-warn.p-message-simple {
    color: ${e("message.warn.simple.color")};
}

.p-message-error {
    background: ${e("message.error.background")};
    outline-color: ${e("message.error.border.color")};
    color: ${e("message.error.color")};
    box-shadow: ${e("message.error.shadow")};
}

.p-message-error .p-message-close-button:focus-visible {
    outline-color: ${e("message.error.close.button.focus.ring.color")};
    box-shadow: ${e("message.error.close.button.focus.ring.shadow")};
}

.p-message-error .p-message-close-button:hover {
    background: ${e("message.error.close.button.hover.background")};
}

.p-message-error.p-message-outlined {
    color: ${e("message.error.outlined.color")};
    outline-color: ${e("message.error.outlined.border.color")};
}

.p-message-error.p-message-simple {
    color: ${e("message.error.simple.color")};
}

.p-message-secondary {
    background: ${e("message.secondary.background")};
    outline-color: ${e("message.secondary.border.color")};
    color: ${e("message.secondary.color")};
    box-shadow: ${e("message.secondary.shadow")};
}

.p-message-secondary .p-message-close-button:focus-visible {
    outline-color: ${e("message.secondary.close.button.focus.ring.color")};
    box-shadow: ${e("message.secondary.close.button.focus.ring.shadow")};
}

.p-message-secondary .p-message-close-button:hover {
    background: ${e("message.secondary.close.button.hover.background")};
}

.p-message-secondary.p-message-outlined {
    color: ${e("message.secondary.outlined.color")};
    outline-color: ${e("message.secondary.outlined.border.color")};
}

.p-message-secondary.p-message-simple {
    color: ${e("message.secondary.simple.color")};
}

.p-message-contrast {
    background: ${e("message.contrast.background")};
    outline-color: ${e("message.contrast.border.color")};
    color: ${e("message.contrast.color")};
    box-shadow: ${e("message.contrast.shadow")};
}

.p-message-contrast .p-message-close-button:focus-visible {
    outline-color: ${e("message.contrast.close.button.focus.ring.color")};
    box-shadow: ${e("message.contrast.close.button.focus.ring.shadow")};
}

.p-message-contrast .p-message-close-button:hover {
    background: ${e("message.contrast.close.button.hover.background")};
}

.p-message-contrast.p-message-outlined {
    color: ${e("message.contrast.outlined.color")};
    outline-color: ${e("message.contrast.outlined.border.color")};
}

.p-message-contrast.p-message-simple {
    color: ${e("message.contrast.simple.color")};
}

.p-message-text {
    font-size: ${e("message.text.font.size")};
    font-weight: ${e("message.text.font.weight")};
}

.p-message-icon {
    font-size: ${e("message.icon.size")};
    width: ${e("message.icon.size")};
    height: ${e("message.icon.size")};
}

.p-message-enter-from {
    opacity: 0;
}

.p-message-enter-active {
    transition: opacity 0.3s;
}

.p-message.p-message-leave-from {
    max-height: 1000px;
}

.p-message.p-message-leave-to {
    max-height: 0;
    opacity: 0;
    margin: 0;
}

.p-message-leave-active {
    overflow: hidden;
    transition: max-height 0.45s cubic-bezier(0, 1, 0, 1), opacity 0.3s, margin 0.3s;
}

.p-message-leave-active .p-message-close-button {
    opacity: 0;
}

.p-message-sm .p-message-content {
    padding: ${e("message.content.sm.padding")};
}

.p-message-sm .p-message-text {
    font-size: ${e("message.text.sm.font.size")};
}

.p-message-sm .p-message-icon {
    font-size: ${e("message.icon.sm.size")};
    width: ${e("message.icon.sm.size")};
    height: ${e("message.icon.sm.size")};
}

.p-message-sm .p-message-close-icon {
    font-size: ${e("message.close.icon.sm.size")};
    width: ${e("message.close.icon.sm.size")};
    height: ${e("message.close.icon.sm.size")};
}

.p-message-lg .p-message-content {
    padding: ${e("message.content.lg.padding")};
}

.p-message-lg .p-message-text {
    font-size: ${e("message.text.lg.font.size")};
}

.p-message-lg .p-message-icon {
    font-size: ${e("message.icon.lg.size")};
    width: ${e("message.icon.lg.size")};
    height: ${e("message.icon.lg.size")};
}

.p-message-lg .p-message-close-icon {
    font-size: ${e("message.close.icon.lg.size")};
    width: ${e("message.close.icon.lg.size")};
    height: ${e("message.close.icon.lg.size")};
}

.p-message-outlined {
    background: transparent;
    outline-width: ${e("message.outlined.border.width")};
}

.p-message-simple {
    background: transparent;
    outline-color: transparent;
    box-shadow: none;
}

.p-message-simple .p-message-content {
    padding: ${e("message.simple.content.padding")};
}

.p-message-outlined .p-message-close-button:hover,
.p-message-simple .p-message-close-button:hover {
    background: transparent;
}
`,Vn={root:function(t){var n=t.props;return["p-message p-component p-message-"+n.severity,{"p-message-outlined":n.variant==="outlined","p-message-simple":n.variant==="simple","p-message-sm":n.size==="small","p-message-lg":n.size==="large"}]},content:"p-message-content",icon:"p-message-icon",text:"p-message-text",closeButton:"p-message-close-button",closeIcon:"p-message-close-icon"},qn=tt.extend({name:"message",style:Un,classes:Vn}),Nn={name:"BaseMessage",extends:Ne,props:{severity:{type:String,default:"info"},closable:{type:Boolean,default:!1},life:{type:Number,default:null},icon:{type:String,default:void 0},closeIcon:{type:String,default:void 0},closeButtonProps:{type:null,default:null},size:{type:String,default:null},variant:{type:String,default:null}},style:qn,provide:function(){return{$pcMessage:this,$parentInstance:this}}};function Fe(e){"@babel/helpers - typeof";return Fe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fe(e)}function jt(e,t,n){return(t=Hn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hn(e){var t=Wn(e,"string");return Fe(t)=="symbol"?t:t+""}function Wn(e,t){if(Fe(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(Fe(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nt={name:"Message",extends:Nn,inheritAttrs:!1,emits:["close","life-end"],timeout:null,data:function(){return{visible:!0}},mounted:function(){var t=this;this.life&&setTimeout(function(){t.visible=!1,t.$emit("life-end")},this.life)},methods:{close:function(t){this.visible=!1,this.$emit("close",t)}},computed:{closeAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.close:void 0},dataP:function(){return Pt(jt(jt({outlined:this.variant==="outlined",simple:this.variant==="simple"},this.severity,this.severity),this.size,this.size))}},directives:{ripple:Et},components:{TimesIcon:nt}};function Pe(e){"@babel/helpers - typeof";return Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(e)}function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,o)}return n}function St(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Bt(Object(n),!0).forEach(function(o){Kn(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Kn(e,t,n){return(t=Zn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zn(e){var t=Yn(e,"string");return Pe(t)=="symbol"?t:t+""}function Yn(e,t){if(Pe(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(Pe(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xn=["data-p"],Qn=["data-p"],Jn=["data-p"],Gn=["aria-label","data-p"],ei=["data-p"];function ti(e,t,n,o,a,s){var h=se("TimesIcon"),m=it("ripple");return u(),Z(bn,H({name:"p-message",appear:""},e.ptmi("transition")),{default:S(function(){return[me(i("div",H({class:e.cx("root"),role:"alert","aria-live":"assertive","aria-atomic":"true","data-p":s.dataP},e.ptm("root")),[e.$slots.container?pe(e.$slots,"container",{key:0,closeCallback:s.close}):(u(),c("div",H({key:1,class:e.cx("content"),"data-p":s.dataP},e.ptm("content")),[pe(e.$slots,"icon",{class:X(e.cx("icon"))},function(){return[(u(),Z(je(e.icon?"span":null),H({class:[e.cx("icon"),e.icon],"data-p":s.dataP},e.ptm("icon")),null,16,["class","data-p"]))]}),e.$slots.default?(u(),c("div",H({key:0,class:e.cx("text"),"data-p":s.dataP},e.ptm("text")),[pe(e.$slots,"default")],16,Jn)):M("",!0),e.closable?me((u(),c("button",H({key:1,class:e.cx("closeButton"),"aria-label":s.closeAriaLabel,type:"button",onClick:t[0]||(t[0]=function(g){return s.close(g)}),"data-p":s.dataP},St(St({},e.closeButtonProps),e.ptm("closeButton"))),[pe(e.$slots,"closeicon",{},function(){return[e.closeIcon?(u(),c("i",H({key:0,class:[e.cx("closeIcon"),e.closeIcon],"data-p":s.dataP},e.ptm("closeIcon")),null,16,ei)):(u(),Z(h,H({key:1,class:[e.cx("closeIcon"),e.closeIcon],"data-p":s.dataP},e.ptm("closeIcon")),null,16,["class","data-p"]))]})],16,Gn)),[[m]]):M("",!0)],16,Qn))],16,Xn),[[hn,a.visible]])]}),_:3},16)}Nt.render=ti;var ni=({dt:e})=>`
.p-progressbar {
    position: relative;
    overflow: hidden;
    height: ${e("progressbar.height")};
    background: ${e("progressbar.background")};
    border-radius: ${e("progressbar.border.radius")};
}

.p-progressbar-value {
    margin: 0;
    background: ${e("progressbar.value.background")};
}

.p-progressbar-label {
    color: ${e("progressbar.label.color")};
    font-size: ${e("progressbar.label.font.size")};
    font-weight: ${e("progressbar.label.font.weight")};
}

.p-progressbar-determinate .p-progressbar-value {
    height: 100%;
    width: 0%;
    position: absolute;
    display: none;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    transition: width 1s ease-in-out;
}

.p-progressbar-determinate .p-progressbar-label {
    display: inline-flex;
}

.p-progressbar-indeterminate .p-progressbar-value::before {
    content: "";
    position: absolute;
    background: inherit;
    inset-block-start: 0;
    inset-inline-start: 0;
    inset-block-end: 0;
    will-change: inset-inline-start, inset-inline-end;
    animation: p-progressbar-indeterminate-anim 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
}

.p-progressbar-indeterminate .p-progressbar-value::after {
    content: "";
    position: absolute;
    background: inherit;
    inset-block-start: 0;
    inset-inline-start: 0;
    inset-block-end: 0;
    will-change: inset-inline-start, inset-inline-end;
    animation: p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) infinite;
    animation-delay: 1.15s;
}

@keyframes p-progressbar-indeterminate-anim {
    0% {
        inset-inline-start: -35%;
        inset-inline-end: 100%;
    }
    60% {
        inset-inline-start: 100%;
        inset-inline-end: -90%;
    }
    100% {
        inset-inline-start: 100%;
        inset-inline-end: -90%;
    }
}
@-webkit-keyframes p-progressbar-indeterminate-anim {
    0% {
        inset-inline-start: -35%;
        inset-inline-end: 100%;
    }
    60% {
        inset-inline-start: 100%;
        inset-inline-end: -90%;
    }
    100% {
        inset-inline-start: 100%;
        inset-inline-end: -90%;
    }
}

@keyframes p-progressbar-indeterminate-anim-short {
    0% {
        inset-inline-start: -200%;
        inset-inline-end: 100%;
    }
    60% {
        inset-inline-start: 107%;
        inset-inline-end: -8%;
    }
    100% {
        inset-inline-start: 107%;
        inset-inline-end: -8%;
    }
}
@-webkit-keyframes p-progressbar-indeterminate-anim-short {
    0% {
        inset-inline-start: -200%;
        inset-inline-end: 100%;
    }
    60% {
        inset-inline-start: 107%;
        inset-inline-end: -8%;
    }
    100% {
        inset-inline-start: 107%;
        inset-inline-end: -8%;
    }
}
`,ii={root:function(t){var n=t.instance;return["p-progressbar p-component",{"p-progressbar-determinate":n.determinate,"p-progressbar-indeterminate":n.indeterminate}]},value:"p-progressbar-value",label:"p-progressbar-label"},si=tt.extend({name:"progressbar",style:ni,classes:ii}),ai={name:"BaseProgressBar",extends:Ne,props:{value:{type:Number,default:null},mode:{type:String,default:"determinate"},showValue:{type:Boolean,default:!0}},style:si,provide:function(){return{$pcProgressBar:this,$parentInstance:this}}},Ht={name:"ProgressBar",extends:ai,inheritAttrs:!1,computed:{progressStyle:function(){return{width:this.value+"%",display:"flex"}},indeterminate:function(){return this.mode==="indeterminate"},determinate:function(){return this.mode==="determinate"},dataP:function(){return Pt({determinate:this.determinate,indeterminate:this.indeterminate})}}},oi=["aria-valuenow","data-p"],li=["data-p"],ri=["data-p"],ui=["data-p"];function ci(e,t,n,o,a,s){return u(),c("div",H({role:"progressbar",class:e.cx("root"),"aria-valuemin":"0","aria-valuenow":e.value,"aria-valuemax":"100"},e.ptmi("root"),{"data-p":s.dataP}),[s.determinate?(u(),c("div",H({key:0,class:e.cx("value"),style:s.progressStyle},e.ptm("value"),{"data-p":s.dataP}),[e.value!=null&&e.value!==0&&e.showValue?(u(),c("div",H({key:0,class:e.cx("label")},e.ptm("label"),{"data-p":s.dataP}),[pe(e.$slots,"default",{},function(){return[ge(E(e.value+"%"),1)]})],16,ri)):M("",!0)],16,li)):s.indeterminate?(u(),c("div",H({key:1,class:e.cx("value")},e.ptm("value"),{"data-p":s.dataP}),null,16,ui)):M("",!0)],16,oi)}Ht.render=ci;var di=({dt:e})=>`
.p-fileupload input[type="file"] {
    display: none;
}

.p-fileupload-advanced {
    border: 1px solid ${e("fileupload.border.color")};
    border-radius: ${e("fileupload.border.radius")};
    background: ${e("fileupload.background")};
    color: ${e("fileupload.color")};
}

.p-fileupload-header {
    display: flex;
    align-items: center;
    padding: ${e("fileupload.header.padding")};
    background: ${e("fileupload.header.background")};
    color: ${e("fileupload.header.color")};
    border-style: solid;
    border-width: ${e("fileupload.header.border.width")};
    border-color: ${e("fileupload.header.border.color")};
    border-radius: ${e("fileupload.header.border.radius")};
    gap: ${e("fileupload.header.gap")};
}

.p-fileupload-content {
    border: 1px solid transparent;
    display: flex;
    flex-direction: column;
    gap: ${e("fileupload.content.gap")};
    transition: border-color ${e("fileupload.transition.duration")};
    padding: ${e("fileupload.content.padding")};
}

.p-fileupload-content .p-progressbar {
    width: 100%;
    height: ${e("fileupload.progressbar.height")};
}

.p-fileupload-file-list {
    display: flex;
    flex-direction: column;
    gap: ${e("fileupload.filelist.gap")};
}

.p-fileupload-file {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    padding: ${e("fileupload.file.padding")};
    border-block-end: 1px solid ${e("fileupload.file.border.color")};
    gap: ${e("fileupload.file.gap")};
}

.p-fileupload-file:last-child {
    border-block-end: 0;
}

.p-fileupload-file-info {
    display: flex;
    flex-direction: column;
    gap: ${e("fileupload.file.info.gap")};
}

.p-fileupload-file-thumbnail {
    flex-shrink: 0;
}

.p-fileupload-file-actions {
    margin-inline-start: auto;
}

.p-fileupload-highlight {
    border: 1px dashed ${e("fileupload.content.highlight.border.color")};
}

.p-fileupload-basic {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: ${e("fileupload.basic.gap")};
}
`,pi={root:function(t){var n=t.props;return["p-fileupload p-fileupload-".concat(n.mode," p-component")]},header:"p-fileupload-header",pcChooseButton:"p-fileupload-choose-button",pcUploadButton:"p-fileupload-upload-button",pcCancelButton:"p-fileupload-cancel-button",content:"p-fileupload-content",fileList:"p-fileupload-file-list",file:"p-fileupload-file",fileThumbnail:"p-fileupload-file-thumbnail",fileInfo:"p-fileupload-file-info",fileName:"p-fileupload-file-name",fileSize:"p-fileupload-file-size",pcFileBadge:"p-fileupload-file-badge",fileActions:"p-fileupload-file-actions",pcFileRemoveButton:"p-fileupload-file-remove-button"},mi=tt.extend({name:"fileupload",style:di,classes:pi}),fi={name:"BaseFileUpload",extends:Ne,props:{name:{type:String,default:null},url:{type:String,default:null},mode:{type:String,default:"advanced"},multiple:{type:Boolean,default:!1},accept:{type:String,default:null},disabled:{type:Boolean,default:!1},auto:{type:Boolean,default:!1},maxFileSize:{type:Number,default:null},invalidFileSizeMessage:{type:String,default:"{0}: Invalid file size, file size should be smaller than {1}."},invalidFileTypeMessage:{type:String,default:"{0}: Invalid file type, allowed file types: {1}."},fileLimit:{type:Number,default:null},invalidFileLimitMessage:{type:String,default:"Maximum number of files exceeded, limit is {0} at most."},withCredentials:{type:Boolean,default:!1},previewWidth:{type:Number,default:50},chooseLabel:{type:String,default:null},uploadLabel:{type:String,default:null},cancelLabel:{type:String,default:null},customUpload:{type:Boolean,default:!1},showUploadButton:{type:Boolean,default:!0},showCancelButton:{type:Boolean,default:!0},chooseIcon:{type:String,default:void 0},uploadIcon:{type:String,default:void 0},cancelIcon:{type:String,default:void 0},style:null,class:null,chooseButtonProps:{type:null,default:null},uploadButtonProps:{type:Object,default:function(){return{severity:"secondary"}}},cancelButtonProps:{type:Object,default:function(){return{severity:"secondary"}}}},style:mi,provide:function(){return{$pcFileUpload:this,$parentInstance:this}}},Wt={name:"FileContent",hostName:"FileUpload",extends:Ne,emits:["remove"],props:{files:{type:Array,default:function(){return[]}},badgeSeverity:{type:String,default:"warn"},badgeValue:{type:String,default:null},previewWidth:{type:Number,default:50},templates:{type:null,default:null}},methods:{formatSize:function(t){var n,o=1024,a=3,s=((n=this.$primevue.config.locale)===null||n===void 0?void 0:n.fileSizeTypes)||["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t===0)return"0 ".concat(s[0]);var h=Math.floor(Math.log(t)/Math.log(o)),m=parseFloat((t/Math.pow(o,h)).toFixed(a));return"".concat(m," ").concat(s[h])}},components:{Button:Be,Badge:Mt,TimesIcon:nt}},vi=["alt","src","width"];function gi(e,t,n,o,a,s){var h=se("Badge"),m=se("TimesIcon"),g=se("Button");return u(!0),c(le,null,ce(n.files,function(b,y){return u(),c("div",H({key:b.name+b.type+b.size,class:e.cx("file"),ref_for:!0},e.ptm("file")),[i("img",H({role:"presentation",class:e.cx("fileThumbnail"),alt:b.name,src:b.objectURL,width:n.previewWidth,ref_for:!0},e.ptm("fileThumbnail")),null,16,vi),i("div",H({class:e.cx("fileInfo"),ref_for:!0},e.ptm("fileInfo")),[i("div",H({class:e.cx("fileName"),ref_for:!0},e.ptm("fileName")),E(b.name),17),i("span",H({class:e.cx("fileSize"),ref_for:!0},e.ptm("fileSize")),E(s.formatSize(b.size)),17)],16),v(h,{value:n.badgeValue,class:X(e.cx("pcFileBadge")),severity:n.badgeSeverity,unstyled:e.unstyled,pt:e.ptm("pcFileBadge")},null,8,["value","class","severity","unstyled","pt"]),i("div",H({class:e.cx("fileActions"),ref_for:!0},e.ptm("fileActions")),[v(g,{onClick:function(D){return e.$emit("remove",y)},text:"",rounded:"",severity:"danger",class:X(e.cx("pcFileRemoveButton")),unstyled:e.unstyled,pt:e.ptm("pcFileRemoveButton")},{icon:S(function(C){return[n.templates.fileremoveicon?(u(),Z(je(n.templates.fileremoveicon),{key:0,class:X(C.class),file:b,index:y},null,8,["class","file","index"])):(u(),Z(m,H({key:1,class:C.class,"aria-hidden":"true",ref_for:!0},e.ptm("pcFileRemoveButton").icon),null,16,["class"]))]}),_:2},1032,["onClick","class","unstyled","pt"])],16)],16)}),128)}Wt.render=gi;function Ze(e){return yi(e)||bi(e)||Kt(e)||hi()}function hi(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bi(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yi(e){if(Array.isArray(e))return Qe(e)}function Oe(e,t){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Kt(e))||t){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,h=!0,m=!1;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return h=b.done,b},e:function(b){m=!0,s=b},f:function(){try{h||n.return==null||n.return()}finally{if(m)throw s}}}}function Kt(e,t){if(e){if(typeof e=="string")return Qe(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(e,t):void 0}}function Qe(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var Zt={name:"FileUpload",extends:fi,inheritAttrs:!1,emits:["select","uploader","before-upload","progress","upload","error","before-send","clear","remove","remove-uploaded-file"],duplicateIEEvent:!1,data:function(){return{uploadedFileCount:0,files:[],messages:[],focused:!1,progress:null,uploadedFiles:[]}},methods:{upload:function(){this.hasFiles&&this.uploader()},onBasicUploaderClick:function(t){t.button===0&&this.$refs.fileInput.click()},onFileSelect:function(t){if(t.type!=="drop"&&this.isIE11()&&this.duplicateIEEvent){this.duplicateIEEvent=!1;return}this.isBasic&&this.hasFiles&&(this.files=[]),this.messages=[],this.files=this.files||[];var n=t.dataTransfer?t.dataTransfer.files:t.target.files,o=Oe(n),a;try{for(o.s();!(a=o.n()).done;){var s=a.value;!this.isFileSelected(s)&&!this.isFileLimitExceeded()&&this.validate(s)&&(this.isImage(s)&&(s.objectURL=window.URL.createObjectURL(s)),this.files.push(s))}}catch(h){o.e(h)}finally{o.f()}this.$emit("select",{originalEvent:t,files:this.files}),this.fileLimit&&this.checkFileLimit(),this.auto&&this.hasFiles&&!this.isFileLimitExceeded()&&this.uploader(),t.type!=="drop"&&this.isIE11()?this.clearIEInput():this.clearInputElement()},choose:function(){this.$refs.fileInput.click()},uploader:function(){var t=this;if(this.customUpload)this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.$emit("uploader",{files:this.files}),this.clear();else{var n=new XMLHttpRequest,o=new FormData;this.$emit("before-upload",{xhr:n,formData:o});var a=Oe(this.files),s;try{for(a.s();!(s=a.n()).done;){var h=s.value;o.append(this.name,h,h.name)}}catch(m){a.e(m)}finally{a.f()}n.upload.addEventListener("progress",function(m){m.lengthComputable&&(t.progress=Math.round(m.loaded*100/m.total)),t.$emit("progress",{originalEvent:m,progress:t.progress})}),n.onreadystatechange=function(){if(n.readyState===4){var m;t.progress=0,n.status>=200&&n.status<300?(t.fileLimit&&(t.uploadedFileCount+=t.files.length),t.$emit("upload",{xhr:n,files:t.files})):t.$emit("error",{xhr:n,files:t.files}),(m=t.uploadedFiles).push.apply(m,Ze(t.files)),t.clear()}},this.url&&(n.open("POST",this.url,!0),this.$emit("before-send",{xhr:n,formData:o}),n.withCredentials=this.withCredentials,n.send(o))}},clear:function(){this.files=[],this.messages=null,this.$emit("clear"),this.isAdvanced&&this.clearInputElement()},onFocus:function(){this.focused=!0},onBlur:function(){this.focused=!1},isFileSelected:function(t){if(this.files&&this.files.length){var n=Oe(this.files),o;try{for(n.s();!(o=n.n()).done;){var a=o.value;if(a.name+a.type+a.size===t.name+t.type+t.size)return!0}}catch(s){n.e(s)}finally{n.f()}}return!1},isIE11:function(){return!!window.MSInputMethodContext&&!!document.documentMode},validate:function(t){return this.accept&&!this.isFileTypeValid(t)?(this.messages.push(this.invalidFileTypeMessage.replace("{0}",t.name).replace("{1}",this.accept)),!1):this.maxFileSize&&t.size>this.maxFileSize?(this.messages.push(this.invalidFileSizeMessage.replace("{0}",t.name).replace("{1}",this.formatSize(this.maxFileSize))),!1):!0},isFileTypeValid:function(t){var n=this.accept.split(",").map(function(m){return m.trim()}),o=Oe(n),a;try{for(o.s();!(a=o.n()).done;){var s=a.value,h=this.isWildcard(s)?this.getTypeClass(t.type)===this.getTypeClass(s):t.type==s||this.getFileExtension(t).toLowerCase()===s.toLowerCase();if(h)return!0}}catch(m){o.e(m)}finally{o.f()}return!1},getTypeClass:function(t){return t.substring(0,t.indexOf("/"))},isWildcard:function(t){return t.indexOf("*")!==-1},getFileExtension:function(t){return"."+t.name.split(".").pop()},isImage:function(t){return/^image\//.test(t.type)},onDragEnter:function(t){this.disabled||(t.stopPropagation(),t.preventDefault())},onDragOver:function(t){this.disabled||(!this.isUnstyled&&yn(this.$refs.content,"p-fileupload-highlight"),this.$refs.content.setAttribute("data-p-highlight",!0),t.stopPropagation(),t.preventDefault())},onDragLeave:function(){this.disabled||(!this.isUnstyled&&kt(this.$refs.content,"p-fileupload-highlight"),this.$refs.content.setAttribute("data-p-highlight",!1))},onDrop:function(t){if(!this.disabled){!this.isUnstyled&&kt(this.$refs.content,"p-fileupload-highlight"),this.$refs.content.setAttribute("data-p-highlight",!1),t.stopPropagation(),t.preventDefault();var n=t.dataTransfer?t.dataTransfer.files:t.target.files,o=this.multiple||n&&n.length===1;o&&this.onFileSelect(t)}},remove:function(t){this.clearInputElement();var n=this.files.splice(t,1)[0];this.files=Ze(this.files),this.$emit("remove",{file:n,files:this.files})},removeUploadedFile:function(t){var n=this.uploadedFiles.splice(t,1)[0];this.uploadedFiles=Ze(this.uploadedFiles),this.$emit("remove-uploaded-file",{file:n,files:this.uploadedFiles})},clearInputElement:function(){this.$refs.fileInput.value=""},clearIEInput:function(){this.$refs.fileInput&&(this.duplicateIEEvent=!0,this.$refs.fileInput.value="")},formatSize:function(t){var n,o=1024,a=3,s=((n=this.$primevue.config.locale)===null||n===void 0?void 0:n.fileSizeTypes)||["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t===0)return"0 ".concat(s[0]);var h=Math.floor(Math.log(t)/Math.log(o)),m=parseFloat((t/Math.pow(o,h)).toFixed(a));return"".concat(m," ").concat(s[h])},isFileLimitExceeded:function(){return this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount&&this.focused&&(this.focused=!1),this.fileLimit&&this.fileLimit<this.files.length+this.uploadedFileCount},checkFileLimit:function(){this.isFileLimitExceeded()&&this.messages.push(this.invalidFileLimitMessage.replace("{0}",this.fileLimit.toString()))},onMessageClose:function(){this.messages=null}},computed:{isAdvanced:function(){return this.mode==="advanced"},isBasic:function(){return this.mode==="basic"},chooseButtonClass:function(){return[this.cx("pcChooseButton"),this.class]},basicFileChosenLabel:function(){var t;if(this.auto)return this.chooseButtonLabel;if(this.hasFiles){var n;return this.files&&this.files.length===1?this.files[0].name:(n=this.$primevue.config.locale)===null||n===void 0||(n=n.fileChosenMessage)===null||n===void 0?void 0:n.replace("{0}",this.files.length)}return((t=this.$primevue.config.locale)===null||t===void 0?void 0:t.noFileChosenMessage)||""},hasFiles:function(){return this.files&&this.files.length>0},hasUploadedFiles:function(){return this.uploadedFiles&&this.uploadedFiles.length>0},chooseDisabled:function(){return this.disabled||this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount},uploadDisabled:function(){return this.disabled||!this.hasFiles||this.fileLimit&&this.fileLimit<this.files.length},cancelDisabled:function(){return this.disabled||!this.hasFiles},chooseButtonLabel:function(){return this.chooseLabel||this.$primevue.config.locale.choose},uploadButtonLabel:function(){return this.uploadLabel||this.$primevue.config.locale.upload},cancelButtonLabel:function(){return this.cancelLabel||this.$primevue.config.locale.cancel},completedLabel:function(){return this.$primevue.config.locale.completed},pendingLabel:function(){return this.$primevue.config.locale.pending}},components:{Button:Be,ProgressBar:Ht,Message:Nt,FileContent:Wt,PlusIcon:cn,UploadIcon:qt,TimesIcon:nt},directives:{ripple:Et}},xi=["multiple","accept","disabled"],wi=["files"],_i=["accept","disabled","multiple"];function Di(e,t,n,o,a,s){var h=se("Button"),m=se("ProgressBar"),g=se("Message"),b=se("FileContent");return s.isAdvanced?(u(),c("div",H({key:0,class:e.cx("root")},e.ptmi("root")),[i("input",H({ref:"fileInput",type:"file",onChange:t[0]||(t[0]=function(){return s.onFileSelect&&s.onFileSelect.apply(s,arguments)}),multiple:e.multiple,accept:e.accept,disabled:s.chooseDisabled},e.ptm("input")),null,16,xi),i("div",H({class:e.cx("header")},e.ptm("header")),[pe(e.$slots,"header",{files:a.files,uploadedFiles:a.uploadedFiles,chooseCallback:s.choose,uploadCallback:s.uploader,clearCallback:s.clear},function(){return[v(h,H({label:s.chooseButtonLabel,class:s.chooseButtonClass,style:e.style,disabled:e.disabled,unstyled:e.unstyled,onClick:s.choose,onKeydown:Ct(s.choose,["enter"]),onFocus:s.onFocus,onBlur:s.onBlur},e.chooseButtonProps,{pt:e.ptm("pcChooseButton")}),{icon:S(function(y){return[pe(e.$slots,"chooseicon",{},function(){return[(u(),Z(je(e.chooseIcon?"span":"PlusIcon"),H({class:[y.class,e.chooseIcon],"aria-hidden":"true"},e.ptm("pcChooseButton").icon),null,16,["class"]))]})]}),_:3},16,["label","class","style","disabled","unstyled","onClick","onKeydown","onFocus","onBlur","pt"]),e.showUploadButton?(u(),Z(h,H({key:0,class:e.cx("pcUploadButton"),label:s.uploadButtonLabel,onClick:s.uploader,disabled:s.uploadDisabled,unstyled:e.unstyled},e.uploadButtonProps,{pt:e.ptm("pcUploadButton")}),{icon:S(function(y){return[pe(e.$slots,"uploadicon",{},function(){return[(u(),Z(je(e.uploadIcon?"span":"UploadIcon"),H({class:[y.class,e.uploadIcon],"aria-hidden":"true"},e.ptm("pcUploadButton").icon,{"data-pc-section":"uploadbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","label","onClick","disabled","unstyled","pt"])):M("",!0),e.showCancelButton?(u(),Z(h,H({key:1,class:e.cx("pcCancelButton"),label:s.cancelButtonLabel,onClick:s.clear,disabled:s.cancelDisabled,unstyled:e.unstyled},e.cancelButtonProps,{pt:e.ptm("pcCancelButton")}),{icon:S(function(y){return[pe(e.$slots,"cancelicon",{},function(){return[(u(),Z(je(e.cancelIcon?"span":"TimesIcon"),H({class:[y.class,e.cancelIcon],"aria-hidden":"true"},e.ptm("pcCancelButton").icon,{"data-pc-section":"cancelbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","label","onClick","disabled","unstyled","pt"])):M("",!0)]})],16),i("div",H({ref:"content",class:e.cx("content"),onDragenter:t[1]||(t[1]=function(){return s.onDragEnter&&s.onDragEnter.apply(s,arguments)}),onDragover:t[2]||(t[2]=function(){return s.onDragOver&&s.onDragOver.apply(s,arguments)}),onDragleave:t[3]||(t[3]=function(){return s.onDragLeave&&s.onDragLeave.apply(s,arguments)}),onDrop:t[4]||(t[4]=function(){return s.onDrop&&s.onDrop.apply(s,arguments)})},e.ptm("content"),{"data-p-highlight":!1}),[pe(e.$slots,"content",{files:a.files,uploadedFiles:a.uploadedFiles,removeUploadedFileCallback:s.removeUploadedFile,removeFileCallback:s.remove,progress:a.progress,messages:a.messages},function(){return[s.hasFiles?(u(),Z(m,{key:0,value:a.progress,showValue:!1,unstyled:e.unstyled,pt:e.ptm("pcProgressbar")},null,8,["value","unstyled","pt"])):M("",!0),(u(!0),c(le,null,ce(a.messages,function(y){return u(),Z(g,{key:y,severity:"error",onClose:s.onMessageClose,unstyled:e.unstyled,pt:e.ptm("pcMessage")},{default:S(function(){return[ge(E(y),1)]}),_:2},1032,["onClose","unstyled","pt"])}),128)),s.hasFiles?(u(),c("div",{key:1,class:X(e.cx("fileList"))},[v(b,{files:a.files,onRemove:s.remove,badgeValue:s.pendingLabel,previewWidth:e.previewWidth,templates:e.$slots,unstyled:e.unstyled,pt:e.pt},null,8,["files","onRemove","badgeValue","previewWidth","templates","unstyled","pt"])],2)):M("",!0),s.hasUploadedFiles?(u(),c("div",{key:2,class:X(e.cx("fileList"))},[v(b,{files:a.uploadedFiles,onRemove:s.removeUploadedFile,badgeValue:s.completedLabel,badgeSeverity:"success",previewWidth:e.previewWidth,templates:e.$slots,unstyled:e.unstyled,pt:e.pt},null,8,["files","onRemove","badgeValue","previewWidth","templates","unstyled","pt"])],2)):M("",!0)]}),e.$slots.empty&&!s.hasFiles&&!s.hasUploadedFiles?(u(),c("div",xn(H({key:0},e.ptm("empty"))),[pe(e.$slots,"empty")],16)):M("",!0)],16)],16)):s.isBasic?(u(),c("div",H({key:1,class:e.cx("root")},e.ptmi("root")),[(u(!0),c(le,null,ce(a.messages,function(y){return u(),Z(g,{key:y,severity:"error",onClose:s.onMessageClose,unstyled:e.unstyled,pt:e.ptm("pcMessage")},{default:S(function(){return[ge(E(y),1)]}),_:2},1032,["onClose","unstyled","pt"])}),128)),v(h,H({label:s.chooseButtonLabel,class:s.chooseButtonClass,style:e.style,disabled:e.disabled,unstyled:e.unstyled,onMouseup:s.onBasicUploaderClick,onKeydown:Ct(s.choose,["enter"]),onFocus:s.onFocus,onBlur:s.onBlur},e.chooseButtonProps,{pt:e.ptm("pcChooseButton")}),{icon:S(function(y){return[pe(e.$slots,"chooseicon",{},function(){return[(u(),Z(je(e.chooseIcon?"span":"PlusIcon"),H({class:[y.class,e.chooseIcon],"aria-hidden":"true"},e.ptm("pcChooseButton").icon),null,16,["class"]))]})]}),_:3},16,["label","class","style","disabled","unstyled","onMouseup","onKeydown","onFocus","onBlur","pt"]),e.auto?M("",!0):pe(e.$slots,"filelabel",{key:0,class:X(e.cx("filelabel"))},function(){return[i("span",{class:X(e.cx("filelabel")),files:a.files},E(s.basicFileChosenLabel),11,wi)]}),i("input",H({ref:"fileInput",type:"file",accept:e.accept,disabled:e.disabled,multiple:e.multiple,onChange:t[5]||(t[5]=function(){return s.onFileSelect&&s.onFileSelect.apply(s,arguments)}),onFocus:t[6]||(t[6]=function(){return s.onFocus&&s.onFocus.apply(s,arguments)}),onBlur:t[7]||(t[7]=function(){return s.onBlur&&s.onBlur.apply(s,arguments)})},e.ptm("input")),null,16,_i)],16)):M("",!0)}Zt.render=Di;const $i={class:"pd-map-panel"},ki={key:0,class:"pd-map-loading"},Ci={key:1,class:"pd-map-error"},Li={key:2,id:"project-map",class:"pd-map-container"},ji={__name:"MapPanel",setup(e){const t=w(!0),n=w(!1),o=w(""),a=w(null),s=w(null),h=w(null),m=w(null),g=w(!1),b=w(null),y=w(null),C=w(null),D=w(null),I=w(oe.icon({iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png",shadowSize:[41,41],shadowAnchor:[13,41]})),j=zt(),r=st(),d=Ee(),L=Me("emitter"),p=Ce(),R=N(()=>p.params.id);be(()=>{L.on("building-selected",$=>{G($)}),L.on("show-location-dialog",$=>{y.value=$,ae()})}),be(()=>T(this,null,function*(){try{t.value=!1,yield wn(),B(),yield q(),yield r.fetchBuildingsByProject(R.value),J()}catch($){console.error("Error initializing map:",$),n.value=!0,o.value="Failed to initialize map. Please refresh the page."}}));function B(){a.value=oe.map("project-map",{zoomControl:!1,attributionControl:!0,doubleClickZoom:!1}),a.value.setView([25.276987,55.296249],12),oe.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20}).addTo(a.value),m.value=oe.layerGroup().addTo(a.value)}function q(){return T(this,null,function*(){try{yield d.fetchProject(R.value);const $=d.currentProject;if(!$||!$.territory){console.warn("Project has no territory field:",R.value);return}yield j.fetchTerritories();const V=j.territories.find(ie=>ie.name===$.territory);V?(console.log("Found project territory:",V.name),D.value=V,te(V)):console.warn("Territory not found for project:",$.territory)}catch($){console.error("Error fetching project territory:",$)}})}function te($){if(!$||!$.geo){console.warn("No geometry data for territory:",$==null?void 0:$.name);return}const F=typeof $.geo=="string"?JSON.parse($.geo):$.geo;if(h.value&&a.value.removeLayer(h.value),F.type==="Point")h.value=oe.marker([F.coordinates[1],F.coordinates[0]],{icon:I.value}).addTo(a.value).bindPopup(`<b>${$.name_en||$.name}</b>`),a.value.setView([F.coordinates[1],F.coordinates[0]],16);else if(F.type==="Polygon"){const V=F.coordinates[0].map(ie=>[ie[1],ie[0]]);h.value=oe.polygon(V,{color:"#0071ff",weight:2,opacity:.8,fillColor:"#0071ff",fillOpacity:.2}).addTo(a.value).bindPopup(`<b>${$.name_en||$.name}</b>`),a.value.fitBounds(h.value.getBounds(),{padding:[20,20],maxZoom:17})}}function J(){m.value&&m.value.clearLayers(),r.buildings.forEach($=>{if($.lat&&$.lng){const F=oe.latLng(parseFloat($.lat),parseFloat($.lng)),V=oe.marker(F,{icon:I.value,title:$.building_name});V.addTo(m.value);const ie=`
        <b>${$.building_name}</b><br>
        Status: ${$.status||"Off-plan"}<br>
        Availability: ${$.availability||"Available"}
      `,de=oe.popup({closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,closeOnClick:!0}).setContent(ie);V.bindPopup(de),V.buildingData=$}})}function G($){!$||!$.lat||!$.lng||m.value.eachLayer(F=>{if(F.buildingData&&(F.setIcon(I.value),F.buildingData.name===$.name)){const V=oe.icon(Q({},I.value.options));F.setIcon(V),F.openPopup(),a.value.setView([$.lat,$.lng],17)}})}function ae(){y.value&&(g.value=!0,setTimeout(()=>{O()},100))}function O(){if(s.value=oe.map("location-map",{zoomControl:!1,doubleClickZoom:!1}),oe.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20}).addTo(s.value),s.value.setView([25.276987,55.296249],12),D.value&&D.value.geo){const $=typeof D.value.geo=="string"?JSON.parse(D.value.geo):D.value.geo;if($.type==="Polygon"){const F=$.coordinates[0].map(ie=>[ie[1],ie[0]]),V=oe.polygon(F,{color:"#0071ff",weight:2,opacity:.8,fillColor:"#0071ff",fillOpacity:.2}).addTo(s.value);s.value.fitBounds(V.getBounds(),{padding:[20,20],maxZoom:17})}else $.type==="Point"&&s.value.setView([$.coordinates[1],$.coordinates[0]],16)}s.value.on("click",k),y.value.lat&&y.value.lng&&(b.value={lat:y.value.lat,lng:y.value.lng},C.value=oe.marker([y.value.lat,y.value.lng],{icon:I.value}).addTo(s.value))}function _($,F){if(!F||!$)return!1;let V=!1;const ie=$[0],de=$[1];for(let P=0,x=F.length-1;P<F.length;x=P++){const W=F[P][0],re=F[P][1],Le=F[x][0],_e=F[x][1];re>de!=_e>de&&ie<(Le-W)*(de-re)/(_e-re)+W&&(V=!V)}return V}function k($){if(D.value&&D.value.geo){const V=typeof D.value.geo=="string"?JSON.parse(D.value.geo):D.value.geo;if(V.type==="Polygon"){const ie=[$.latlng.lng,$.latlng.lat],de=V.coordinates[0];if(!_(ie,de)){L.emit("show-notification",{severity:"error",summary:"Invalid Location",detail:"Building location must be within the project boundaries."});return}}}b.value={lat:$.latlng.lat,lng:$.latlng.lng},C.value&&s.value.removeLayer(C.value),C.value=oe.marker([$.latlng.lat,$.latlng.lng],{icon:I.value}).addTo(s.value);const F=oe.popup({closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,closeOnClick:!0}).setContent(`New location for ${y.value.building_name}`);C.value.bindPopup(F).openPopup()}function U(){return T(this,null,function*(){if(!(!b.value||!y.value))try{yield r.updateLocation(y.value.name,b.value.lat.toFixed(6),b.value.lng.toFixed(6)),g.value=!1,y.value.lat=b.value.lat.toFixed(6),y.value.lng=b.value.lng.toFixed(6),J(),b.value=null,C.value=null}catch($){console.error("Error saving building location:",$)}})}function A(){g.value=!1,b.value=null,C.value=null}function ne(){a.value&&a.value.zoomIn()}function ye(){a.value&&a.value.zoomOut()}function xe(){a.value&&(h.value?h.value.getBounds?a.value.fitBounds(h.value.getBounds(),{padding:[20,20],maxZoom:17}):h.value.getLatLng&&a.value.setView(h.value.getLatLng(),16):a.value.setView([25.276987,55.296249],12))}return($,F)=>{const V=Be,ie=At;return u(),c("div",$i,[t.value?(u(),c("div",ki,F[1]||(F[1]=[i("i",{class:"pi pi-spin pi-spinner pd-spinner"},null,-1),i("span",null,"Loading map...",-1)]))):n.value?(u(),c("div",Ci,[F[2]||(F[2]=i("i",{class:"pi pi-exclamation-triangle"},null,-1)),i("p",null,E(o.value),1)])):(u(),c("div",Li)),i("div",{class:"pd-map-controls"},[i("button",{class:"pd-map-control-button",onClick:ne,title:"Zoom in"},F[3]||(F[3]=[i("i",{class:"pi pi-plus"},null,-1)])),i("button",{class:"pd-map-control-button",onClick:ye,title:"Zoom out"},F[4]||(F[4]=[i("i",{class:"pi pi-minus"},null,-1)])),i("button",{class:"pd-map-control-button",onClick:xe,title:"Reset view"},F[5]||(F[5]=[i("i",{class:"pi pi-home"},null,-1)]))]),v(ie,{visible:g.value,"onUpdate:visible":F[0]||(F[0]=de=>g.value=de),header:"Set Building Location",modal:"",style:{width:"50rem"}},{footer:S(()=>[v(V,{label:"Cancel",text:"",onClick:A}),v(V,{label:"Save Location",onClick:U,disabled:!b.value},null,8,["disabled"])]),default:S(()=>[F[6]||(F[6]=i("div",{class:"pd-location-dialog-content"},[i("p",{class:"pd-location-help"},"Click on the map to set the building location."),i("div",{id:"location-map",class:"pd-location-map"})],-1))]),_:1},8,["visible"])])}}},Bi=we(ji,[["__scopeId","data-v-bc8eff2f"]]),Si={class:"flex flex-col h-full bg-[var(--pd-bg-surface)] overflow-hidden"},Ti={class:"flex justify-between items-center p-4 border-b border-[var(--pd-border-light)]"},Ii={class:"flex items-center gap-2"},Fi={class:"flex items-center gap-3"},Pi={class:"relative w-[200px]"},Ei={key:0,class:"flex-1 flex items-center justify-center"},Mi={key:1,class:"flex-1 flex items-center justify-center"},zi={key:2,class:"flex-1 overflow-auto p-3"},Ai={class:"grid grid-cols-[repeat(auto-fill,minmax(100px,1fr))] gap-3"},Ri=["onClick","onContextmenu"],Oi={class:"absolute top-1 right-1 flex"},Ui={key:0,class:"w-5 h-5 rounded-full text-[var(--pd-primary)] flex items-center justify-center text-[10px]"},Vi={class:"text-[13px] font-medium text-[var(--pd-text-primary)] text-center whitespace-nowrap overflow-hidden text-ellipsis w-full"},qi={key:3,class:"flex-1 flex items-center justify-center"},Ni={class:"flex flex-col items-center justify-center p-6 text-center"},Hi={class:"text-sm text-[var(--pd-text-secondary)] mb-4"},Wi={key:4,class:"p-3 flex justify-center border-t border-[var(--pd-border-light)]"},Ki=["disabled"],Zi={key:0,class:"pi pi-chevron-down"},Yi={key:1,class:"pi pi-spin pi-spinner"},Xi={__name:"BuildingPanel",setup(e){const t=ze(),n=Ce(),o=N(()=>n.params.id),a=Me("emitter"),s=st(),h=zt(),m=Ee(),g=w(null),b=w(!1),y=w(!1),C=w(!1),D=w(!1),I=w(null),j=w(null),r=w(null),d=w({name:"",type:"text",value:"",label:"",options:[]}),L=N(()=>s.buildings),p=N(()=>s.isLoading),R=N(()=>s.hasMoreBuildings),B=w(""),q=w([]),te=N(()=>B.value?q.value:L.value),J=N(()=>{const P=[{label:"Edit Building Name",icon:"pi pi-pencil",command:()=>ye()},{label:"Edit Configuration",icon:"pi pi-cog",command:()=>xe()},{label:"Add Listing",icon:"pi pi-plus",command:()=>a.emit("show-create-listing",{building:g.value})}];return r.value==="Polygon"&&P.push({label:"Set Location",icon:"pi pi-map-marker",command:()=>a.emit("show-location-dialog",g.value)}),P.push({separator:!0}),P.push({label:"Delete Building",icon:"pi pi-trash",class:"text-red-500",command:()=>C.value=!0}),P}),G=N(()=>[{name:"project",label:"Project",type:"link",doctype:"PRP Project",validation:"required",default:o.value,readonly:!0,fullWidth:!1},{name:"building_name",label:"Building Name",type:"text",validation:"required",fullWidth:!1},{name:"building_configuration",label:"Building Configuration",type:"text",fullWidth:!0}]);he(g,P=>{P&&a.emit("building-selected",P)}),be(()=>T(this,null,function*(){if(yield O(),yield _(),n.params.buildingId){const P=n.params.buildingId,x=L.value.find(W=>W.name===P);if(x)g.value=x;else try{const W=yield s.fetchBuilding(P);W&&(g.value=W)}catch(W){console.error("Error fetching building from URL:",W)}}})),he(()=>n.params.buildingId,P=>T(this,null,function*(){if(P){const x=L.value.find(W=>W.name===P);if(x)g.value=x;else try{const W=yield s.fetchBuilding(P);W&&(g.value=W)}catch(W){console.error("Error fetching building from URL:",W)}}else g.value=null}));function ae(P){j.value.toggle(P)}function O(){return T(this,null,function*(){try{yield m.fetchProject(o.value);const P=m.currentProject;if(!P||!P.territory){console.warn("Project has no territory field:",o.value);return}yield h.fetchTerritories();const x=h.territories.find(W=>W.name===P.territory);if(x&&x.geo){const W=typeof x.geo=="string"?JSON.parse(x.geo):x.geo;console.log("Project territory geo type:",W.type),r.value=W.type}else console.warn("Territory not found or has no geometry data:",P.territory)}catch(P){console.error("Error fetching project data:",P)}})}function _(){return T(this,null,function*(){o.value&&(yield s.fetchBuildingsByProject(o.value))})}function k(){return T(this,null,function*(){D.value=!0;try{yield s.loadMoreBuildings()}finally{D.value=!1}})}function U(P){(!g.value||g.value.name!==P.name)&&(g.value=P,t.push({name:"BuildingDetails",params:{id:o.value,buildingId:P.name}}),a.emit("clear-current-listing"))}function A(P,x){g.value=x,I.value.show(P)}function ne(){b.value=!0}function ye(){g.value&&(d.value={name:"building_name",label:"Building Name",type:"text",value:g.value.building_name,validation:"required"},y.value=!0)}function xe(){g.value&&(d.value={name:"building_configuration",label:"Building Configuration",type:"text",value:g.value.building_configuration||"",validation:null},y.value=!0)}function $(){if(!B.value.trim()){q.value=[];return}const P=B.value.toLowerCase();q.value=L.value.filter(x=>x.building_name.toLowerCase().includes(P)||x.building_configuration&&x.building_configuration.toLowerCase().includes(P)||x.status&&x.status.toLowerCase().includes(P))}function F(){B.value="",q.value=[]}function V(P){return T(this,null,function*(){try{if(r.value==="Point"){const x=h.territories.find(W=>W.is_project&&W.name===o.value);if(x&&x.geo){const W=typeof x.geo=="string"?JSON.parse(x.geo):x.geo;W.type==="Point"&&(P.lat=W.coordinates[1],P.lng=W.coordinates[0])}}yield s.createBuilding(P)}catch(x){console.error("Error creating building:",x)}})}function ie(W){return T(this,arguments,function*({fieldName:P,value:x}){if(g.value)try{const re={[P]:x};yield s.updateBuilding(g.value.name,re),g.value=ve(Q({},g.value),{[P]:x})}catch(re){console.error("Error updating building:",re)}})}function de(){return T(this,null,function*(){if(g.value)try{yield s.deleteBuilding(g.value.name),g.value=null}catch(P){console.error("Error deleting building:",P)}})}return(P,x)=>{var Le,_e;const W=se("Popover"),re=Ot;return u(),c("div",Si,[i("div",Ti,[i("div",Ii,[x[6]||(x[6]=i("h3",{class:"text-lg font-semibold text-[var(--pd-text-primary)] m-0 tracking-tight"}," Buildings ",-1)),i("button",{class:"text-[var(--pd-text-tertiary)] hover:text-[var(--pd-text-secondary)] hover:bg-[var(--pd-bg-surface-hover)] p-1 rounded-full",onClick:ae},x[4]||(x[4]=[i("i",{class:"pi pi-info-circle"},null,-1)])),v(W,{ref_key:"infoPopover",ref:j},{default:S(()=>x[5]||(x[5]=[i("div",{class:"p-4 w-72"},[i("h4",{class:"text-[15px] font-semibold mb-3 text-[var(--pd-text-primary)]"}," Legend "),i("div",{class:"mb-4"},[i("div",{class:"text-[13px] font-medium text-[var(--pd-text-secondary)] mb-2"}," Location Status "),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-primary)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-map-marker"})]),i("span",null,"Building location mapped")])]),i("div",{class:"mb-4"},[i("div",{class:"text-[13px] font-medium text-[var(--pd-text-secondary)] mb-2"}," Construction Status "),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-info)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-clock"})]),i("span",null,"Off-plan")]),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-warning)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-clock"})]),i("span",null,"Due for Handover")]),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-success)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-clock"})]),i("span",null,"Handover Completed")])]),i("div",{class:"mb-2"},[i("div",{class:"text-[13px] font-medium text-[var(--pd-text-secondary)] mb-2"}," Availability Status "),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-success)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-tag"})]),i("span",null,"Available")]),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-error)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-tag"})]),i("span",null,"Sold")]),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-warning)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-tag"})]),i("span",null,"Available for Secondhand")])])],-1)])),_:1},512)]),i("div",Fi,[i("div",Pi,[me(i("input",{type:"text","onUpdate:modelValue":x[0]||(x[0]=Y=>B.value=Y),placeholder:"Search buildings...",class:"w-full h-8 px-8 py-2 rounded-md border border-[var(--pd-border-light)] bg-[var(--pd-bg-base)] text-[var(--pd-text-primary)] text-sm transition-all duration-200 focus:outline-none focus:border-[var(--pd-border-medium)] focus:shadow",onInput:$},null,544),[[Rt,B.value]]),x[8]||(x[8]=i("i",{class:"pi pi-search absolute left-2 top-1/2 -translate-y-1/2 text-sm text-[var(--pd-text-tertiary)]"},null,-1)),B.value?(u(),c("button",{key:0,class:"absolute right-2 top-1/2 -translate-y-1/2 border-none bg-transparent text-[var(--pd-text-tertiary)] cursor-pointer w-4 h-4 rounded-full flex items-center justify-center text-xs hover:bg-[var(--pd-bg-surface-hover)] hover:text-[var(--pd-text-primary)]",onClick:F},x[7]||(x[7]=[i("i",{class:"pi pi-times"},null,-1)]))):M("",!0)]),i("button",{class:"w-8 h-8 flex items-center justify-center rounded-full border border-[var(--pd-border-light)] bg-[var(--pd-bg-base)] text-[var(--pd-text-secondary)] cursor-pointer transition-all duration-200 hover:bg-[var(--pd-bg-surface-hover)] hover:text-[var(--pd-text-primary)] hover:-translate-y-0.5 hover:shadow-sm",onClick:ne},x[9]||(x[9]=[i("i",{class:"pi pi-plus"},null,-1)]))])]),p.value?(u(),c("div",Ei,x[10]||(x[10]=[i("i",{class:"pi pi-spin pi-spinner text-2xl text-[var(--pd-text-tertiary)]"},null,-1)]))):L.value.length?te.value.length?(u(),c("div",zi,[i("div",Ai,[(u(!0),c(le,null,ce(te.value,Y=>(u(),c("div",{key:Y.name,class:X(["relative flex flex-col items-center justify-end pt-5 pb-3 px-2 rounded-xl bg-[var(--pd-bg-base)] border border-[var(--pd-border-light)] cursor-pointer transition-all duration-200 h-[110px] hover:-translate-y-0.5 hover:shadow-md",{"bg-[var(--pd-bg-surface-hover)] border-[var(--pd-border-medium)]":g.value&&g.value.name===Y.name}]),onClick:Se=>U(Y),onContextmenu:Se=>A(Se,Y)},[i("div",Oi,[Y.lat&&Y.lng?(u(),c("span",Ui,x[14]||(x[14]=[i("i",{class:"pi pi-map-marker",style:{"font-size":"12px"}},null,-1)]))):M("",!0),i("span",{class:X(["w-5 h-5 rounded-full flex items-center justify-center text-[10px]",{" text-[var(--pd-info)]":!Y.status||Y.status==="Off-plan","text-[var(--pd-warning)]":Y.status==="Due for Handover"," text-[var(--pd-success)]":Y.status==="Handover Completed"}])},x[15]||(x[15]=[i("i",{class:"pi pi-clock",style:{"font-size":"12px"}},null,-1)]),2),i("span",{class:X(["w-5 h-5 rounded-full flex items-center justify-center text-[10px]",{" text-[var(--pd-success)]":!Y.availability||Y.availability==="Available"," text-[var(--pd-error)]":Y.availability==="Sold","text-[var(--pd-warning)]":Y.availability==="Available for Secondhand"}])},x[16]||(x[16]=[i("i",{class:"pi pi-tag",style:{"font-size":"12px"}},null,-1)]),2)]),x[17]||(x[17]=i("div",{class:"w-[38px] h-[38px] rounded-lg bg-[var(--pd-badge-bg)] flex items-center justify-center mb-2.5"},[i("i",{class:"pi pi-building text-lg text-[var(--pd-badge-text)]"})],-1)),i("div",Vi,E(Y.building_name),1)],42,Ri))),128))])])):B.value&&!te.value.length?(u(),c("div",qi,[i("div",Ni,[x[19]||(x[19]=i("i",{class:"pi pi-search text-2xl text-[var(--pd-text-tertiary)] mb-3"},null,-1)),i("p",Hi,' No buildings found matching "'+E(B.value)+'" ',1),i("button",{class:"bg-[var(--pd-bg-base)] text-[var(--pd-text-primary)] border border-[var(--pd-border-medium)] rounded-md px-3 py-2 text-xs font-medium flex items-center gap-2 cursor-pointer transition-all duration-200 hover:bg-[var(--pd-bg-surface-hover)] hover:-translate-y-0.5",onClick:F},x[18]||(x[18]=[i("i",{class:"pi pi-times"},null,-1),i("span",null,"Clear Search",-1)]))])])):M("",!0):(u(),c("div",Mi,[i("div",{class:"flex flex-col items-center justify-center p-6 text-center"},[x[12]||(x[12]=i("i",{class:"pi pi-building text-2xl text-[var(--pd-text-tertiary)] mb-3"},null,-1)),x[13]||(x[13]=i("p",{class:"text-sm text-[var(--pd-text-secondary)] mb-4"},"No buildings found",-1)),i("button",{class:"bg-[var(--pd-bg-base)] text-[var(--pd-text-primary)] border border-[var(--pd-border-medium)] rounded-md px-3 py-2 text-xs font-medium flex items-center gap-2 cursor-pointer transition-all duration-200 hover:bg-[var(--pd-bg-surface-hover)] hover:-translate-y-0.5",onClick:ne},x[11]||(x[11]=[i("i",{class:"pi pi-plus"},null,-1),i("span",null,"Add Building",-1)]))])])),R.value?(u(),c("div",Wi,[i("button",{class:"bg-transparent border-none text-[var(--pd-text-secondary)] text-sm px-3 py-2 flex items-center gap-2 cursor-pointer rounded-md transition-all duration-200 hover:bg-[var(--pd-bg-surface-hover)] hover:text-[var(--pd-text-primary)] disabled:opacity-60 disabled:cursor-not-allowed",onClick:k,disabled:D.value},[i("span",null,E(D.value?"Loading...":"Load More"),1),D.value?(u(),c("i",Yi)):(u(),c("i",Zi))],8,Ki)])):M("",!0),v(re,{ref_key:"buildingMenu",ref:I,model:J.value},null,8,["model"]),v(Ve,{visible:b.value,"onUpdate:visible":x[1]||(x[1]=Y=>b.value=Y),title:"Add New Building",fields:G.value,submitButtonLabel:"Add Building",onSubmit:V},null,8,["visible","fields"]),v(Je,{visible:y.value,"onUpdate:visible":x[2]||(x[2]=Y=>y.value=Y),fieldName:d.value.name,fieldType:d.value.type,value:d.value.value,title:d.value.label,options:d.value.options,validation:d.value.validation,onSave:ie},null,8,["visible","fieldName","fieldType","value","title","options","validation"]),v(qe,{visible:C.value,"onUpdate:visible":x[3]||(x[3]=Y=>C.value=Y),title:"Delete Building",message:`Are you sure you want to delete building '${(Le=g.value)==null?void 0:Le.building_name}'? This will delete all associated listings and cannot be undone.`,confirmField:"building_name",confirmValue:(_e=g.value)==null?void 0:_e.building_name,onConfirm:de},null,8,["visible","message","confirmValue"])])}}},Qi={class:"flex flex-col h-full bg-[var(--pd-bg-surface)] overflow-hidden"},Ji={class:"flex justify-between items-center p-4 border-b border-[var(--pd-border-light)]"},Gi={class:"flex items-center gap-2"},es={class:"text-lg font-semibold text-[var(--pd-text-primary)] m-0 tracking-tight"},ts={key:0},ns={class:"flex items-center gap-3"},is={key:0,class:"relative w-[200px]"},ss=["disabled"],as={key:0,class:"flex-1 flex items-center justify-center"},os={key:1,class:"flex-1 flex items-center justify-center"},ls={key:2,class:"flex-1 flex items-center justify-center"},rs={key:3,class:"flex-1 flex items-center justify-center"},us={class:"flex flex-col items-center justify-center p-6 text-center"},cs={class:"text-sm text-[var(--pd-text-secondary)] mb-4"},ds={key:4,class:"flex-1 overflow-auto p-3"},ps={class:"grid grid-cols-[repeat(auto-fill,minmax(100px,1fr))] gap-3"},ms=["onClick"],fs={class:"absolute top-2 right-2 flex"},vs={class:"text-[13px] font-medium text-[var(--pd-text-primary)] text-center whitespace-nowrap overflow-hidden text-ellipsis w-full"},gs={key:5,class:"p-3 flex justify-center border-t border-[var(--pd-border-light)]"},hs=["disabled"],bs={key:0,class:"pi pi-chevron-down"},ys={key:1,class:"pi pi-spin pi-spinner"},xs={__name:"ListingPanel",setup(e){const t=Ce(),n=N(()=>t.params.id),o=Me("emitter"),a=He(),s=w(null),h=w(null),m=w(!1),g=w(!1),b=w(null),y=w(""),C=w([]),D=N(()=>a.listings),I=N(()=>a.isLoading),j=N(()=>a.hasMoreListings),r=N(()=>s.value?D.value.filter(_=>_.building===s.value.name):[]),d=N(()=>y.value?C.value:r.value),L=N(()=>{var _;return[{name:"project",label:"Project",type:"link",doctype:"PRP Project",default:n.value,disabled:!0,fullWidth:!1},{name:"building",label:"Building",type:"link",doctype:"PRP Building",validation:"required",default:(_=s.value)==null?void 0:_.name,disabled:!0,fullWidth:!1},{name:"unit_id",label:"Unit ID",type:"text",validation:"required",fullWidth:!1},{name:"availability",label:"Availability",type:"select",options:[{label:"Available",value:"Available"},{label:"Sold",value:"Sold"},{label:"Available for Secondhand",value:"Available for Secondhand"}],default:"Available",fullWidth:!1},{name:"status",label:"Handover Status",type:"select",options:[{label:"Off-plan",value:"Off-plan"},{label:"Due for Handover",value:"Due for Handover"},{label:"Handover Completed",value:"Handover Completed"}],default:"Off-plan",fullWidth:!1}]});be(()=>{o.on("building-selected",_=>{s.value=_,h.value=null,y.value="",C.value=[],B(_.name),t.params.listingId&&p()}),o.on("show-create-listing",({building:_})=>{s.value=_,ae()}),t.params.listingId&&p()});function p(){return T(this,null,function*(){const _=t.params.listingId,k=D.value.find(U=>U.name===_);if(k){if(h.value=k,!s.value&&k.building)try{const A=yield(yield fetch(`/api/resource/PRP Building/${k.building}`)).json();A&&A.data&&(s.value=A.data,B(k.building))}catch(U){console.error("Error fetching building:",U)}}else try{const U=yield a.fetchListing(_);if(U&&(h.value=U,!s.value&&U.building))try{const ne=yield(yield fetch(`/api/resource/PRP Building/${U.building}`)).json();ne&&ne.data&&(s.value=ne.data,B(U.building))}catch(A){console.error("Error fetching building:",A)}}catch(U){console.error("Error fetching listing from URL:",U)}})}he(()=>t.params.listingId,_=>T(this,null,function*(){_?p():h.value=null})),he(()=>D.value,_=>{if(t.params.listingId&&h.value){const k=_.find(U=>U.name===t.params.listingId);k&&(h.value=k)}}),be(()=>T(this,null,function*(){yield a.fetchListings()})),he(h,_=>{_&&o.emit("listing-selected",_)});function R(_){b.value.toggle(_)}function B(_){return T(this,null,function*(){yield a.updateFilters({building:_})})}function q(){if(!y.value.trim()){C.value=[];return}const _=y.value.toLowerCase();C.value=r.value.filter(k=>k.unit_id.toLowerCase().includes(_)||k.availability&&k.availability.toLowerCase().includes(_)||k.status&&k.status.toLowerCase().includes(_))}function te(){y.value="",C.value=[]}function J(){return T(this,null,function*(){g.value=!0;try{yield a.loadMoreListings()}finally{g.value=!1}})}function G(_){h.value=_}function ae(){s.value&&(m.value=!0)}function O(_){return T(this,null,function*(){try{yield a.createListing(_)}catch(k){console.error("Error creating listing:",k)}})}return(_,k)=>{const U=se("Popover");return u(),c("div",Qi,[i("div",Ji,[i("div",Gi,[i("h3",es,[s.value?(u(),c("span",ts,E(s.value.building_name)+" / ",1)):M("",!0),k[2]||(k[2]=ge("Listings "))]),i("button",{class:"text-[var(--pd-text-tertiary)] hover:text-[var(--pd-text-secondary)] hover:bg-[var(--pd-bg-surface-hover)] p-1 rounded-full",onClick:R},k[3]||(k[3]=[i("i",{class:"pi pi-info-circle"},null,-1)])),v(U,{ref_key:"infoPopover",ref:b},{default:S(()=>k[4]||(k[4]=[i("div",{class:"p-4 w-72"},[i("h4",{class:"text-[15px] font-semibold mb-3 text-[var(--pd-text-primary)]"}," Legend "),i("div",{class:"mb-4"},[i("div",{class:"text-[13px] font-medium text-[var(--pd-text-secondary)] mb-2"}," Availability Status "),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-success)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-tag"})]),i("span",null,"Available")]),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-error)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-tag"})]),i("span",null,"Sold")]),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-warning)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-tag"})]),i("span",null,"Available for Secondhand")])]),i("div",{class:"mb-2"},[i("div",{class:"text-[13px] font-medium text-[var(--pd-text-secondary)] mb-2"}," Handover Status "),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-info)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-clock"})]),i("span",null,"Off-plan")]),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-warning)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-clock"})]),i("span",null,"Due for Handover")]),i("div",{class:"flex items-center gap-2.5 mb-1.5 text-[13px] text-[var(--pd-text-secondary)]"},[i("span",{class:"w-5 h-5 rounded-full text-[var(--pd-success)] flex items-center justify-center text-[10px]"},[i("i",{class:"pi pi-clock"})]),i("span",null,"Handover Completed")])])],-1)])),_:1},512)]),i("div",ns,[s.value?(u(),c("div",is,[me(i("input",{type:"text","onUpdate:modelValue":k[0]||(k[0]=A=>y.value=A),placeholder:"Search listings...",class:"w-full h-8 px-8 py-2 rounded-md border border-[var(--pd-border-light)] bg-[var(--pd-bg-base)] text-[var(--pd-text-primary)] text-sm transition-all duration-200 focus:outline-none focus:border-[var(--pd-border-medium)] focus:shadow",onInput:q},null,544),[[Rt,y.value]]),k[6]||(k[6]=i("i",{class:"pi pi-search absolute left-2 top-1/2 -translate-y-1/2 text-sm text-[var(--pd-text-tertiary)]"},null,-1)),y.value?(u(),c("button",{key:0,class:"absolute right-2 top-1/2 -translate-y-1/2 border-none bg-transparent text-[var(--pd-text-tertiary)] cursor-pointer w-4 h-4 rounded-full flex items-center justify-center text-xs hover:bg-[var(--pd-bg-surface-hover)] hover:text-[var(--pd-text-primary)]",onClick:te},k[5]||(k[5]=[i("i",{class:"pi pi-times"},null,-1)]))):M("",!0)])):M("",!0),i("button",{class:"w-8 h-8 flex items-center justify-center rounded-full border border-[var(--pd-border-light)] bg-[var(--pd-bg-base)] text-[var(--pd-text-secondary)] cursor-pointer transition-all duration-200 hover:bg-[var(--pd-bg-surface-hover)] hover:text-[var(--pd-text-primary)] hover:-translate-y-0.5 hover:shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",onClick:ae,disabled:!s.value},k[7]||(k[7]=[i("i",{class:"pi pi-plus"},null,-1)]),8,ss)])]),s.value?I.value?(u(),c("div",os,k[9]||(k[9]=[i("i",{class:"pi pi-spin pi-spinner text-2xl text-[var(--pd-text-tertiary)]"},null,-1)]))):!d.value.length&&!y.value?(u(),c("div",ls,[i("div",{class:"flex flex-col items-center justify-center p-6 text-center"},[k[11]||(k[11]=i("i",{class:"pi pi-home text-2xl text-[var(--pd-text-tertiary)] mb-3"},null,-1)),k[12]||(k[12]=i("p",{class:"text-sm text-[var(--pd-text-secondary)] mb-4"}," No listings found for this building ",-1)),i("button",{class:"bg-[var(--pd-bg-base)] text-[var(--pd-text-primary)] border border-[var(--pd-border-medium)] rounded-md px-3 py-2 text-xs font-medium flex items-center gap-2 cursor-pointer transition-all duration-200 hover:bg-[var(--pd-bg-surface-hover)] hover:-translate-y-0.5",onClick:ae},k[10]||(k[10]=[i("i",{class:"pi pi-plus"},null,-1),i("span",null,"Add Listing",-1)]))])])):y.value&&!d.value.length?(u(),c("div",rs,[i("div",us,[k[14]||(k[14]=i("i",{class:"pi pi-search text-2xl text-[var(--pd-text-tertiary)] mb-3"},null,-1)),i("p",cs,' No listings found matching "'+E(y.value)+'" ',1),i("button",{class:"bg-[var(--pd-bg-base)] text-[var(--pd-text-primary)] border border-[var(--pd-border-medium)] rounded-md px-3 py-2 text-xs font-medium flex items-center gap-2 cursor-pointer transition-all duration-200 hover:bg-[var(--pd-bg-surface-hover)] hover:-translate-y-0.5",onClick:te},k[13]||(k[13]=[i("i",{class:"pi pi-times"},null,-1),i("span",null,"Clear Search",-1)]))])])):(u(),c("div",ds,[i("div",ps,[(u(!0),c(le,null,ce(d.value,A=>(u(),c("div",{key:A.name,class:X(["relative flex flex-col items-center justify-end pt-5 pb-3 px-2 rounded-xl bg-[var(--pd-bg-base)] border border-[var(--pd-border-light)] cursor-pointer transition-all duration-200 h-[110px] hover:-translate-y-0.5 hover:shadow-md",{"bg-[var(--pd-bg-surface-hover)] border-[var(--pd-border-medium)]":h.value&&h.value.name===A.name}]),onClick:ne=>G(A)},[i("div",fs,[i("span",{class:X(["w-5 h-5 rounded-full flex items-center justify-center text-[10px]",{"text-[var(--pd-info)]":!A.status||A.status==="Off-plan","text-[var(--pd-warning)]":A.status==="Due for Handover"," text-[var(--pd-success)]":A.status==="Handover Completed"}])},k[15]||(k[15]=[i("i",{class:"pi pi-clock",style:{"font-size":"12px"}},null,-1)]),2),i("span",{class:X(["w-5 h-5 rounded-full flex items-center justify-center text-[10px]",{" text-[var(--pd-success)]":!A.availability||A.availability==="Available"," text-[var(--pd-error)]":A.availability==="Sold","text-[var(--pd-warning)]":A.availability==="Available for Secondhand"}])},k[16]||(k[16]=[i("i",{class:"pi pi-tag",style:{"font-size":"12px"}},null,-1)]),2)]),k[17]||(k[17]=i("div",{class:"w-[38px] h-[38px] rounded-lg bg-[var(--pd-badge-bg)] flex items-center justify-center mb-2.5"},[i("i",{class:"pi pi-home text-lg text-[var(--pd-badge-text)]"})],-1)),i("div",vs,E(A.unit_id),1)],10,ms))),128))])])):(u(),c("div",as,k[8]||(k[8]=[i("div",{class:"flex flex-col items-center justify-center p-6 text-center"},[i("i",{class:"pi pi-list text-2xl text-[var(--pd-text-tertiary)] mb-3"}),i("p",{class:"text-sm text-[var(--pd-text-secondary)]"}," Select a building to view listings ")],-1)]))),j.value?(u(),c("div",gs,[i("button",{class:"bg-transparent border-none text-[var(--pd-text-secondary)] text-sm px-3 py-2 flex items-center gap-2 cursor-pointer rounded-md transition-all duration-200 hover:bg-[var(--pd-bg-surface-hover)] hover:text-[var(--pd-text-primary)] disabled:opacity-60 disabled:cursor-not-allowed",onClick:J,disabled:g.value},[i("span",null,E(g.value?"Loading...":"Load More"),1),g.value?(u(),c("i",ys)):(u(),c("i",bs))],8,hs)])):M("",!0),v(Ve,{visible:m.value,"onUpdate:visible":k[1]||(k[1]=A=>m.value=A),title:"Add New Listing",fields:L.value,submitButtonLabel:"Add Listing",onSubmit:O},null,8,["visible","fields"])])}}},ws={class:"flex flex-col gap-4"},_s={__name:"ListingInfoTab",props:{listing:{type:Object,required:!0}},emits:["edit-field"],setup(e,{emit:t}){const n=e,o=t,a=[{name:"unit_id",label:"Unit ID",type:"text",icon:"pi pi-id-card"},{name:"developer",label:"Developer",type:"link",doctype:"PRP Developer",icon:"pi pi-briefcase"},{name:"type",label:"Type",type:"select",options:["Flat","Villa","Townhouse","Penthouse"],icon:"pi pi-th-large"},{name:"bedrooms",label:"Bedrooms",type:"select",options:["Studio","1-BR","2-BR","3-BR","4-BR","5-BR","6-BR","7-BR","7+"]}],s=[{name:"availability",label:"Availability",type:"select",options:["Available","Sold"],icon:"pi pi-tag"},{name:"status",label:"Handover Status",type:"select",options:["Off-plan","Due for Handover","Handover Completed"],icon:"pi pi-clock"}],h=[{name:"enable_secondhand_selling",label:"Available for Selling",type:"boolean"},{name:"enable_secondhand_renting",label:"Available for Renting",type:"boolean"}],m=N(()=>s.map(b=>b.name==="availability"&&n.listing.availability==="Available for Secondhand"?ve(Q({},b),{readonly:!0}):b)),g=(b,y,C)=>{const I=[...a,...s,...h].find(j=>j.name===b)||{};b==="availability"&&n.listing.availability==="Available for Secondhand"||o("edit-field",{fieldName:b,currentValue:y,title:C,type:I.type||"text",options:I.options||[],validation:I.validation||null,doctype:I.doctype||""})};return(b,y)=>(u(),c("div",ws,[v($e,{legend:"Listing",fields:a,data:e.listing,columns:3,customClass:"mb-2",onEdit:g},null,8,["data"]),v($e,{legend:"Status",fields:m.value,data:e.listing,columns:3,customClass:"mb-2",onEdit:g},null,8,["fields","data"]),v($e,{legend:"Secondhand Management",fields:h,data:e.listing,columns:3,customClass:"mb-2",onEdit:g},null,8,["data"])]))}},Ds=_n("documents",{state:()=>({documentList:null,currentDocument:null,currentDocumentResource:null,filters:{},documentRoomCache:{},cacheDuration:6e4}),getters:{documents:e=>{var t;return((t=e.documentList)==null?void 0:t.data)||[]},isLoading:e=>{var t,n;return((n=(t=e.documentList)==null?void 0:t.list)==null?void 0:n.loading)||!1},hasError:e=>{var t,n;return!!((n=(t=e.documentList)==null?void 0:t.list)!=null&&n.error)},errorMessage:e=>{var t,n,o;return((o=(n=(t=e.documentList)==null?void 0:t.list)==null?void 0:n.error)==null?void 0:o.message)||""},hasMoreDocuments:e=>{var t;return((t=e.documentList)==null?void 0:t.hasNextPage)||!1},expiredDocuments:e=>e.documents.filter(t=>t.expired),archivedDocuments:e=>e.documents.filter(t=>t.archived),publicDocuments:e=>e.documents.filter(t=>t.public)},actions:{initDocumentList(){const e=Xe();return!this.documentList&&e.socket?(this.documentList=Dn({doctype:"PRP Document",fields:["*"],orderBy:"creation desc",start:0,pageLength:20,cache:"prp:prp_document",auto:!0,transform(t){return t},onSuccess(t){},onError(t){console.error("Error loading documents data:",t)}},e.socket),this.setupRealtimeListeners(e.socket)):this.documentList||console.warn("Cannot initialize document list: Socket not available"),this.documentList},setupRealtimeListeners(e){if(!e){console.warn("Cannot setup realtime listeners: Socket not available");return}e.on("prp:refetch_resource",t=>{console.log("Received refetch_resource event:",t),t.cache_key==="prp:prp_document"&&(t.event==="list_update"?(console.log("Detected list change (add/delete), reloading document list"),this.refetchDocuments(),this.clearDocumentRoomCache()):t.event==="doc_update"&&(console.log(`Detected document update for ${t.doc}`),this.currentDocument&&this.currentDocument.name===t.doc&&this.refreshCurrentDocument(),this.refetchDocuments(),this.clearDocumentRoomCache()))})},clearDocumentRoomCache(){this.documentRoomCache={}},refetchDocuments(){return T(this,null,function*(){if(this.documentList)try{return yield this.documentList.reload(),this.documents}catch(e){console.error("Error refetching documents:",e)}return null})},refreshCurrentDocument(){return T(this,null,function*(){if(this.currentDocument&&this.currentDocumentResource)try{return yield this.currentDocumentResource.get.submit(),this.currentDocument}catch(e){console.error("Error refreshing current document:",e)}return null})},fetchDocuments(){return T(this,null,function*(){try{const e=this.initDocumentList();e?yield e.reload():console.error("Document list not initialized yet. Socket might not be available.")}catch(e){console.error("Error fetching documents:",e)}})},loadMoreDocuments(){return T(this,null,function*(){if(this.hasMoreDocuments&&this.documentList)try{yield this.documentList.next()}catch(e){console.error("Error loading more documents:",e)}})},updateFilters(e){return T(this,null,function*(){if(this.filters=Q(Q({},this.filters),e),this.documentList){this.documentList.update({filters:this.filters});try{yield this.documentList.reload()}catch(t){console.error("Error updating filters:",t)}}})},resetFilters(){return T(this,null,function*(){if(this.filters={},this.documentList){this.documentList.update({filters:{}});try{yield this.documentList.reload()}catch(e){console.error("Error resetting filters:",e)}}})},fetchDocument(e){return T(this,null,function*(){const t=Xe();t.socket||console.warn("Socket not available for fetching document"),this.currentDocumentResource=$n({doctype:"PRP Document",name:e,auto:!0,onSuccess:n=>{this.currentDocument=n},onError:n=>{console.error(`Error fetching document ${e}:`,n),this.currentDocument=null}},t.socket);try{return yield this.currentDocumentResource.get.submit(),this.currentDocument}catch(n){return console.error(`Error submitting fetch for document ${e}:`,n),null}})},createDocument(e){return T(this,null,function*(){if(this.documentList||this.initDocumentList(),!this.documentList){const t="Cannot create document: Document list not initialized";throw console.error(t),new Error(t)}try{const t=yield this.documentList.insert.submit(e);return this.clearDocumentRoomCache(),t}catch(t){throw console.error("Error creating document:",t),t}})},updateDocument(e,t){return T(this,null,function*(){if(this.documentList||this.initDocumentList(),!this.documentList)throw new Error(`Cannot update document ${e}: Document list not initialized`);try{const n=yield this.documentList.setValue.submit(Q({name:e},t));return this.clearDocumentRoomCache(),n}catch(n){throw console.error(`Error updating document ${e}:`,n),n}})},deleteDocument(e){return T(this,null,function*(){if(this.documentList||this.initDocumentList(),!this.documentList)throw new Error(`Cannot delete document ${e}: Document list not initialized`);try{yield this.documentList.delete.submit(e),this.currentDocument&&this.currentDocument.name===e&&(this.currentDocument=null,this.currentDocumentResource=null),this.clearDocumentRoomCache()}catch(t){throw console.error(`Error deleting document ${e}:`,t),t}})},addDocumentToRoom(e,t,n){return T(this,null,function*(){if(this.currentDocument||(yield this.fetchDocument(e)),!this.currentDocument)throw new Error(`Cannot add document ${e} to room: Document not found`);const o=this.currentDocument.rooms||[];return o.find(s=>s.rel_doctype===t&&s.rel_docname===n)?(console.log(`Document ${e} is already associated with ${t}/${n}`),this.currentDocument):(o.push({rel_doctype:t,rel_docname:n}),this.clearRoomCache(t,n),this.updateDocument(e,{rooms:o}))})},removeDocumentFromRoom(e,t,n){return T(this,null,function*(){if(this.currentDocument||(yield this.fetchDocument(e)),!this.currentDocument)throw new Error(`Cannot remove document ${e} from room: Document not found`);const o=this.currentDocument.rooms||[],a=o.filter(s=>!(s.rel_doctype===t&&s.rel_docname===n));return a.length!==o.length?(this.clearRoomCache(t,n),this.updateDocument(e,{rooms:a})):(console.log(`Document ${e} is not associated with ${t}/${n}`),this.currentDocument)})},findDocumentsInRoom(e,t){return T(this,null,function*(){if(!e||!t)return console.log("Invalid parameters for findDocumentsInRoom:",{doctype:e,docname:t}),[];const n=`${e}/${t}`,o=this.documentRoomCache[n];if(o&&Date.now()-o.timestamp<this.cacheDuration)return o.documents;console.log(`Finding documents for ${e}/${t}`);try{const a=yield fetch(`/api/method/prp.api.get_documents_in_room?rel_doctype=${encodeURIComponent(e)}&rel_docname=${encodeURIComponent(t)}`,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Failed to fetch documents in room: ${a.statusText}`);const h=(yield a.json()).message.documents||[];return console.log(`Found ${h.length} documents for ${e}/${t} using API`),this.documentRoomCache[n]={documents:h,timestamp:Date.now()},h}catch(a){if(console.error(`Error finding documents for ${e}/${t}:`,a),this.documentList){yield this.fetchDocuments();const s=this.documents.filter(h=>!h.rooms||!Array.isArray(h.rooms)?!1:h.rooms.some(m=>m.rel_doctype===e&&m.rel_docname===t));return this.documentRoomCache[n]={documents:s,timestamp:Date.now()},s}return[]}})},clearRoomCache(e,t){const n=`${e}/${t}`;this.documentRoomCache[n]&&delete this.documentRoomCache[n]},updateDocumentStatus(e,t){return T(this,null,function*(){return this.updateDocument(e,t)})},toggleArchived(e){return T(this,null,function*(){return this.currentDocument||(yield this.fetchDocument(e)),this.updateDocument(e,{archived:!this.currentDocument.archived})})},toggleExpired(e){return T(this,null,function*(){return this.currentDocument||(yield this.fetchDocument(e)),this.updateDocument(e,{expired:!this.currentDocument.expired})})},togglePublic(e){return T(this,null,function*(){return this.currentDocument||(yield this.fetchDocument(e)),this.updateDocument(e,{public:!this.currentDocument.public})})},checkIfExpired(e){if(!this.currentDocument)return this.fetchDocument(e),!1;if(!this.currentDocument.expiry_date)return!1;const t=new Date,n=new Date(this.currentDocument.expiry_date);return t>n},updateExpiredStatus(e){return T(this,null,function*(){this.currentDocument||(yield this.fetchDocument(e));const t=this.checkIfExpired(e);return t!==this.currentDocument.expired?this.updateDocument(e,{expired:t}):this.currentDocument})},clearCurrentDocument(){this.currentDocument=null,this.currentDocumentResource=null},findDocumentsByTag(e){return T(this,null,function*(){return yield this.fetchDocuments(),this.documents.filter(t=>t.tags?t.tags.toLowerCase().includes(e.toLowerCase()):!1)})},addTagToDocument(e,t){return T(this,null,function*(){if(this.currentDocument||(yield this.fetchDocument(e)),!this.currentDocument)throw new Error(`Cannot add tag to document ${e}: Document not found`);let o=(this.currentDocument.tags||"").split(",").map(a=>a.trim()).filter(Boolean);if(!o.includes(t)){o.push(t);const a=o.join(", ");return this.updateDocument(e,{tags:a})}return this.currentDocument})},removeTagFromDocument(e,t){return T(this,null,function*(){if(this.currentDocument||(yield this.fetchDocument(e)),!this.currentDocument)throw new Error(`Cannot remove tag from document ${e}: Document not found`);let o=(this.currentDocument.tags||"").split(",").map(s=>s.trim()).filter(Boolean);o=o.filter(s=>s!==t);const a=o.join(", ");return this.updateDocument(e,{tags:a})})}}}),$s={class:"document-preview"},ks=["src"],Cs=["src","alt"],Ls={key:2,class:"document-preview-video"},js={key:3,class:"document-preview-audio"},Bs={key:4,class:"document-preview-other"},Ss={class:"document-badges"},Ts={key:0,class:"document-badge public-badge"},Is={key:1,class:"document-badge expired-badge"},Fs={key:2,class:"document-badge archived-badge"},Ps={class:"document-info"},Es={class:"document-title"},Ms={key:0,class:"document-number"},zs={class:"document-meta"},As={class:"document-date"},Rs={key:1,class:"document-tags"},Os={key:0,class:"more-tags"},Us={__name:"DocumentCard",props:{document:{type:Object,required:!0},isOwner:{type:Boolean,default:!1},isArchive:{type:Boolean,default:!1}},emits:["view","edit","delete","archive","unarchive"],setup(e,{emit:t}){const n=e,o=t,a=w(null),s=N(()=>{if(!n.document.expiry_date)return!1;const j=new Date,r=new Date(n.document.expiry_date);return j>r}),h=N(()=>{if(!n.document.expiry_date)return"";const j=new Date,r=new Date(n.document.expiry_date);if(j>r)return"Expired";try{return`Expires ${Rn(r,j,{addSuffix:!0})}`}catch(d){return`Expires on ${D(n.document.expiry_date)}`}}),m=N(()=>n.document.tags?n.document.tags.split(",").map(j=>j.trim()).filter(Boolean):[]),g=N(()=>{const j=[{label:"View Document",icon:"pi pi-eye",command:()=>o("view",n.document)}];return n.isOwner&&j.push({label:"Edit Details",icon:"pi pi-pencil",command:()=>o("edit",n.document)}),n.isArchive?j.push({label:"Unarchive",icon:"pi pi-inbox",command:()=>o("unarchive",n.document)}):j.push({label:"Archive",icon:"pi pi-inbox",command:()=>o("archive",n.document)}),n.isOwner&&(j.push({separator:!0}),j.push({label:"Delete",icon:"pi pi-trash",class:"p-error",command:()=>o("delete",n.document)})),j});function b(j){a.value.show(j)}function y(j,r){if(!j)return!1;const d=j.split(".").pop().toLowerCase();switch(r){case"pdf":return d==="pdf";case"image":return["jpg","jpeg","png","gif","webp","svg"].includes(d);case"video":return["mp4","webm","ogg","mov"].includes(d);case"audio":return["mp3","wav","ogg","aac"].includes(d);default:return!1}}function C(j){if(!j)return"file";const r=j.split(".").pop().toLowerCase();return{doc:"file-text",docx:"file-text",rtf:"file-text",txt:"file-text",xls:"file-text",xlsx:"file-text",csv:"file-text",ppt:"file-text",pptx:"file-text",zip:"archive",rar:"archive","7z":"archive",dwg:"tool",dxf:"tool",pdf:"file-text"}[r]||"file"}function D(j){if(!j)return"";try{return new Date(j).toLocaleDateString("en-AE",{year:"numeric",month:"short",day:"numeric"})}catch(r){return j}}function I(j){return j?j.startsWith("http")?j:`${j}`:""}return(j,r)=>{const d=se("FeatherIcon"),L=Ot;return u(),c("div",{class:"document-card",onClick:r[0]||(r[0]=p=>j.$emit("view",e.document)),onContextmenu:kn(b,["prevent"])},[i("div",$s,[y(e.document.attach,"pdf")?(u(),c("iframe",{key:0,src:I(e.document.attach),class:"document-iframe"},null,8,ks)):y(e.document.attach,"image")?(u(),c("img",{key:1,src:I(e.document.attach),alt:e.document.document_name,class:"document-preview-image"},null,8,Cs)):y(e.document.attach,"video")?(u(),c("div",Ls,[v(d,{name:"video",size:"48"})])):y(e.document.attach,"audio")?(u(),c("div",js,[v(d,{name:"headphones",size:"48"})])):(u(),c("div",Bs,[v(d,{name:C(e.document.attach),size:"48"},null,8,["name"])])),i("div",Ss,[e.document.public?(u(),c("span",Ts,r[1]||(r[1]=[i("i",{class:"pi pi-globe"},null,-1)]))):M("",!0),s.value?(u(),c("span",Is,r[2]||(r[2]=[i("i",{class:"pi pi-calendar-times"},null,-1)]))):M("",!0),e.document.archived?(u(),c("span",Fs,r[3]||(r[3]=[i("i",{class:"pi pi-inbox"},null,-1)]))):M("",!0)])]),i("div",Ps,[i("h3",Es,E(e.document.document_name),1),e.document.document_number?(u(),c("p",Ms," #"+E(e.document.document_number),1)):M("",!0),i("div",zs,[i("span",As,[r[4]||(r[4]=i("i",{class:"pi pi-calendar"},null,-1)),ge(" "+E(D(e.document.issue_date)),1)]),e.document.expiry_date?(u(),c("span",{key:0,class:X(["document-expiry",{expired:s.value}])},[r[5]||(r[5]=i("i",{class:"pi pi-clock"},null,-1)),ge(" "+E(h.value),1)],2)):M("",!0)]),m.value.length?(u(),c("div",Rs,[(u(!0),c(le,null,ce(m.value.slice(0,2),p=>(u(),c("span",{key:p,class:"document-tag"},E(p),1))),128)),m.value.length>2?(u(),c("span",Os,"+"+E(m.value.length-2),1)):M("",!0)])):M("",!0)]),v(L,{model:g.value,ref_key:"menu",ref:a},null,8,["model"])],32)}}},Ye=we(Us,[["__scopeId","data-v-7ab63e97"]]),Vs={class:"document-viewer relative"},qs={class:"header-section absolute top-1 right-1 z-10"},Ns=["href","onClick"],Hs=["href","onClick"],Ws={class:"px-2"},Ks=["href","onClick"],Zs={key:0,class:"empty-state"},Ys={key:1,class:"document-grid"},Xs={key:0,class:"empty-state"},Qs={key:1,class:"document-grid"},Js={key:0,class:"empty-state"},Gs={key:1,class:"document-grid"},ea={class:"document-viewer-container"},ta=["src"],na=["src"],ia={key:2,controls:"",class:"document-video"},sa=["src"],aa={key:3,controls:"",class:"document-audio"},oa=["src"],la={key:4,class:"file-placeholder"},ra={class:"file-icon"},ua={class:"file-name"},ca={class:"document-info"},da={class:"info-row"},pa={class:"info-value"},ma={key:0,class:"info-row"},fa={class:"info-value"},va={key:1,class:"info-row"},ga={key:2,class:"info-row"},ha={class:"info-value"},ba={class:"info-row"},ya={class:"info-value"},xa={class:"info-row"},wa={class:"info-value"},_a={__name:"DocumentViewer",props:{relDoctype:{type:String,required:!0},relDocname:{type:String,required:!0},recommendedTags:{type:Array,default:()=>[]},showExpiryDate:{type:Boolean,default:!0},showIssueDate:{type:Boolean,default:!0},showPlaceOfIssue:{type:Boolean,default:!0},relatedRooms:{type:Array,default:()=>[]},title:{type:String,default:"Documents"}},setup(e){const t=Cn(),n=Ce(),o=ze(),a=e,s=Ds(),h=Xe(),m=w([]),g=w(!0),b=N(()=>n.name),y=N({get(){return n.query.docTab||"all"},set(f){o.push({name:b.value,query:ve(Q({},n.query),{docTab:f})})}}),C=w(null),D=w(!1),I=w(!1),j=w(!1),r=w({}),d=w({}),L=w(!1),p=w(null),R=w(null),B=N(()=>{const f=[{name:"document_name",label:"Document Name",type:"text",fullWidth:!0,validation:"required",icon:"pi pi-file"},{name:"document_number",label:"Document Number",type:"text",validation:{required:!1},icon:"pi pi-id-card"}];return a.showIssueDate&&f.push({name:"issue_date",label:"Issue Date",type:"date",validation:{required:!1},icon:"pi pi-calendar"}),a.showExpiryDate&&f.push({name:"expiry_date",label:"Expiry Date",type:"date",validation:{required:!1},icon:"pi pi-calendar-times"}),a.showPlaceOfIssue&&f.push({name:"place_of_issue",label:"Place of Issue",type:"text",validation:{required:!1},icon:"pi pi-map-marker"}),f.push({name:"tags",label:"Tags",type:"chips",fullWidth:!0,validation:{required:!1},icon:"pi pi-tags",suggestions:a.recommendedTags}),f.push({name:"description",label:"Description",type:"textarea",fullWidth:!0,validation:{required:!1},icon:"pi pi-align-left"}),f.push({name:"public",label:"Public Document",type:"boolean",default:!0,fullWidth:!0,icon:"pi pi-globe"}),f}),q=N(()=>B.value),te=N(()=>m.value.filter(f=>!f.disabled&&!f.archived&&!f.expired&&(f.public||k(f)))),J=N(()=>m.value.filter(f=>!f.disabled&&(f.archived||f.expired)&&(f.public||k(f)))),G=N(()=>{const f=new Set;return te.value.forEach(l=>{l.tags&&l.tags.split(",").map(K=>K.trim()).filter(Boolean).forEach(K=>{f.add(K)})}),Array.from(f)});he([()=>a.relDoctype,()=>a.relDocname,()=>a.relatedRooms],()=>T(this,null,function*(){a.relDoctype&&a.relDocname&&(yield ae())})),be(()=>T(this,null,function*(){a.relDoctype&&a.relDocname&&(yield ae()),n.params.tabId==="media"&&!n.query.docTab&&o.replace({name:n.name,params:Q({},n.params),query:ve(Q({},n.query),{docTab:"all"}),hash:n.hash})})),he(()=>n.query.docTab,f=>{f&&(f==="all"||f==="archive"||G.value.includes(f))||o.replace({name:b.value,query:ve(Q({},n.query),{docTab:"all"})})});function ae(){return T(this,null,function*(){g.value=!0;try{if(!a.relDoctype||!a.relDocname){m.value=[];return}const f=yield s.findDocumentsInRoom(a.relDoctype,a.relDocname);console.log("Doctype:",a.relDoctype,"Docname:",a.relDocname),console.log("Main documents:",f);let l=[...f];for(const ue of a.relatedRooms)if(ue.doctype&&ue.docname){const Ie=yield s.findDocumentsInRoom(ue.doctype,ue.docname);l=[...l,...Ie]}const K=[],fe=new Map;l.forEach(ue=>{fe.has(ue.name)||(fe.set(ue.name,!0),K.push(ue))}),m.value=K}catch(f){console.error("Error fetching documents:",f)}finally{g.value=!1}})}function O(f){return te.value.filter(l=>l.tags?l.tags.split(",").map(K=>K.trim()).includes(f):!1)}function _(f){return!f||!f.tags?[]:f.tags.split(",").map(l=>l.trim()).filter(Boolean)}function k(f){var l;return(f==null?void 0:f.owner)===((l=h.session)==null?void 0:l.user)}function U(f){R.value=f.files[0],console.log("File selected:",R.value),R.value&&A(R.value)}function A(f){return T(this,null,function*(){try{console.log("Starting file upload...",f);const l=new FormData;l.append("file",f),l.append("is_private",0),l.append("doctype","PRP Document"),l.append("docname","new"),l.append("fieldname","attach");const K=yield fetch("/api/method/frappe.handler.upload_file",{method:"POST",body:l,credentials:"include"});if(console.log("Upload response status:",K.status),!K.ok){const ue=yield K.text();throw console.error("Server error response:",ue),new Error(`Upload failed with status: ${K.status}`)}const fe=yield K.json();if(console.log("Upload response:",fe),!fe.message||!fe.message.file_url)throw new Error("Invalid response from server");ye(f,fe.message)}catch(l){console.error("Upload error:",l),xe({files:[f],error:l.message})}})}function ne(f){try{const l=JSON.parse(f.xhr.response);if(console.log("File uploaded successfully:",l),l.message&&l.message.file_url)t.add({severity:"success",summary:"Upload Successful",detail:"File has been uploaded",life:3e3}),r.value={document_name:R.value.name.split(".")[0],attach:l.message.file_url,public:!1},I.value=!0;else throw new Error("Invalid response from server")}catch(l){console.error("Error processing upload response:",l),xe({error:"Failed to process uploaded file"})}finally{R.value=null}}function ye(f,l){t.add({severity:"success",summary:"Upload Successful",detail:"File has been uploaded",life:3e3}),r.value={document_name:f.name.split(".")[0],attach:l.file_url,public:!0},l.filename&&(r.value.document_name=l.filename.split(".")[0]),I.value=!0}function xe(f){console.error("File upload error:",f.error),t.add({severity:"error",summary:"Upload Failed",detail:f.error||"An error occurred during upload",life:5e3}),R.value=null}function $(f){return T(this,null,function*(){try{console.log("Creating document with data:",f);const l=Q({},f);if(Array.isArray(l.tags)&&(l.tags=l.tags.join(", ")),l.issue_date&&(typeof l.issue_date=="string"&&l.issue_date.includes("T")?l.issue_date=l.issue_date.split("T")[0]:l.issue_date instanceof Date&&(l.issue_date=l.issue_date.toISOString().split("T")[0])),l.expiry_date&&(typeof l.expiry_date=="string"&&l.expiry_date.includes("T")?l.expiry_date=l.expiry_date.split("T")[0]:l.expiry_date instanceof Date&&(l.expiry_date=l.expiry_date.toISOString().split("T")[0])),!l.document_name||!l.attach){t.add({severity:"error",summary:"Missing Data",detail:"Document name and attachment are required",life:3e3});return}const K=ve(Q({},l),{rooms:[{rel_doctype:a.relDoctype,rel_docname:a.relDocname}]});console.log("Sending formatted data to server:",K),yield s.createDocument(K),yield ae(),t.add({severity:"success",summary:"Document Created",detail:`Document "${l.document_name}" has been created`,life:3e3})}catch(l){console.error("Error creating document:",l),t.add({severity:"error",summary:"Creation Failed",detail:l.message||"Failed to create document",life:5e3})}})}function F(f){const l=Q({},f);typeof l.tags=="string"&&l.tags?l.tags=l.tags.split(",").map(K=>K.trim()).filter(Boolean):l.tags||(l.tags=[]),d.value=l,j.value=!0}function V(f){return T(this,null,function*(){try{const l=Q({},f);Array.isArray(l.tags)&&(l.tags=l.tags.join(", ")),l.issue_date&&(typeof l.issue_date=="string"&&l.issue_date.includes("T")?l.issue_date=l.issue_date.split("T")[0]:l.issue_date instanceof Date&&(l.issue_date=l.issue_date.toISOString().split("T")[0])),l.expiry_date&&(typeof l.expiry_date=="string"&&l.expiry_date.includes("T")?l.expiry_date=l.expiry_date.split("T")[0]:l.expiry_date instanceof Date&&(l.expiry_date=l.expiry_date.toISOString().split("T")[0])),yield s.updateDocument(l.name,l),yield ae(),t.add({severity:"success",summary:"Document Updated",detail:`Document "${l.document_name}" has been updated`,life:3e3})}catch(l){console.error("Error updating document:",l),t.add({severity:"error",summary:"Update Failed",detail:l.message||"Failed to update document",life:5e3})}})}function ie(f){p.value=f,L.value=!0}function de(){return T(this,null,function*(){if(p.value)try{yield s.updateDocumentStatus(p.value.name,{disabled:!0}),yield ae(),t.add({severity:"info",summary:"Document Disabled",detail:`Document "${p.value.document_name}" has been disabled`,life:3e3}),p.value=null}catch(f){console.error("Error disabling document:",f),t.add({severity:"error",summary:"Disable Failed",detail:f.message||"Failed to disable document",life:5e3})}})}function P(f){return T(this,null,function*(){try{yield s.toggleArchived(f.name),yield ae(),t.add({severity:"info",summary:"Document Archived",detail:`Document "${f.document_name}" has been archived`,life:3e3})}catch(l){console.error("Error archiving document:",l),t.add({severity:"error",summary:"Archive Failed",detail:l.message||"Failed to archive document",life:5e3})}})}function x(f){return T(this,null,function*(){try{f.archived&&(yield s.toggleArchived(f.name),yield ae(),t.add({severity:"info",summary:"Document Unarchived",detail:`Document "${f.document_name}" has been unarchived`,life:3e3}))}catch(l){console.error("Error unarchiving document:",l),t.add({severity:"error",summary:"Unarchive Failed",detail:l.message||"Failed to unarchive document",life:5e3})}})}function W(f){C.value=f,D.value=!0}function re(f,l){if(!f)return!1;const K=f.split(".").pop().toLowerCase();switch(l){case"pdf":return K==="pdf";case"image":return["jpg","jpeg","png","gif","webp","svg"].includes(K);case"video":return["mp4","webm","ogg","mov"].includes(K);case"audio":return["mp3","wav","ogg","aac"].includes(K);default:return!1}}function Le(f){if(!f)return"file";const l=f.split(".").pop().toLowerCase();return{doc:"file-text",docx:"file-text",rtf:"file-text",txt:"file-text",xls:"file-text",xlsx:"file-text",csv:"file-text",ppt:"file-text",pptx:"file-text",zip:"archive",rar:"archive","7z":"archive",dwg:"tool",dxf:"tool",pdf:"file-text"}[l]||"file"}function _e(f){if(!f)return"Unknown file";const l=f.split("/");return l[l.length-1]}function Y(f){if(!f)return"Not specified";try{return new Date(f).toLocaleDateString("en-AE",{year:"numeric",month:"short",day:"numeric"})}catch(l){return f}}function Se(f){if(!f||!f.expiry_date)return!1;const l=new Date,K=new Date(f.expiry_date);return l>K}function Qt(f){if(!f)return;const l=document.createElement("a");l.href=Te(f),l.download=_e(f),document.body.appendChild(l),l.click(),document.body.removeChild(l)}function Te(f){return f?f.startsWith("http")?f:`${f}`:""}return(f,l)=>{var at,ot;const K=Zt,fe=Mt,ue=se("router-link"),Ie=se("Tab"),Jt=se("TabList"),Ae=se("FeatherIcon"),We=Ge,Gt=se("TabPanels"),en=se("Tabs"),tn=Be,nn=Ln,sn=At;return u(),c("div",Vs,[i("div",qs,[v(K,{mode:"basic",url:"/api/method/upload_file",maxFileSize:25e6,onUpload:ne,onError:xe,customUpload:!0,onSelect:U,chooseLabel:"Upload",class:"p-button-outlined"})]),v(en,{activeIndex:y.value,"onUpdate:activeIndex":l[0]||(l[0]=z=>y.value=z),scrollable:""},{default:S(()=>[v(Jt,null,{default:S(()=>[v(Ie,{value:"all"},{default:S(()=>[v(ue,{to:{name:b.value,query:{docTab:"all"}},custom:""},{default:S(({href:z,navigate:ee})=>[i("a",{href:z,onClick:ee,class:"flex items-center"},[l[6]||(l[6]=i("i",{class:"pi pi-folder-open"},null,-1)),l[7]||(l[7]=i("span",{class:"px-2"},"All",-1)),te.value.length?(u(),Z(fe,{key:0,value:te.value.length},null,8,["value"])):M("",!0)],8,Ns)]),_:1},8,["to"])]),_:1}),(u(!0),c(le,null,ce(G.value,z=>(u(),Z(Ie,{key:z,value:z},{default:S(()=>[v(ue,{to:{name:b.value,query:{docTab:z}},custom:""},{default:S(({href:ee,navigate:De})=>[i("a",{href:ee,onClick:De,class:"flex items-center"},[l[8]||(l[8]=i("i",{class:"pi pi-tag"},null,-1)),i("span",Ws,E(z),1),O(z).length?(u(),Z(fe,{key:0,value:O(z).length},null,8,["value"])):M("",!0)],8,Hs)]),_:2},1032,["to"])]),_:2},1032,["value"]))),128)),v(Ie,{value:"archive"},{default:S(()=>[v(ue,{to:{name:b.value,query:{docTab:"archive"}},custom:""},{default:S(({href:z,navigate:ee})=>[i("a",{href:z,onClick:ee,class:"flex items-center"},[l[9]||(l[9]=i("i",{class:"pi pi-inbox"},null,-1)),l[10]||(l[10]=i("span",{class:"px-2"},"Archive",-1)),J.value.length?(u(),Z(fe,{key:0,value:J.value.length,severity:"danger"},null,8,["value"])):M("",!0)],8,Ks)]),_:1},8,["to"])]),_:1})]),_:1}),v(Gt,null,{default:S(()=>[v(We,{value:"all"},{default:S(()=>[te.value.length===0?(u(),c("div",Zs,[v(Ae,{name:"file",class:"w-12 h-12"}),l[11]||(l[11]=i("p",null,"No documents found. Upload a new document to get started.",-1))])):(u(),c("div",Ys,[(u(!0),c(le,null,ce(te.value,z=>(u(),Z(Ye,{key:z.name,document:z,onEdit:ee=>F(z),onDelete:ee=>ie(z),onArchive:ee=>P(z),onView:ee=>W(z),isOwner:k(z)},null,8,["document","onEdit","onDelete","onArchive","onView","isOwner"]))),128))]))]),_:1}),(u(!0),c(le,null,ce(G.value,z=>(u(),Z(We,{key:z,value:z},{default:S(()=>[O(z).length===0?(u(),c("div",Xs,[v(Ae,{name:"tag",class:"w-12 h-12"}),i("p",null,'No documents with tag "'+E(z)+'" found.',1)])):(u(),c("div",Qs,[(u(!0),c(le,null,ce(O(z),ee=>(u(),Z(Ye,{key:ee.name,document:ee,onEdit:De=>F(ee),onDelete:De=>ie(ee),onArchive:De=>P(ee),onView:De=>W(ee),isOwner:k(ee)},null,8,["document","onEdit","onDelete","onArchive","onView","isOwner"]))),128))]))]),_:2},1032,["value"]))),128)),v(We,{value:"archive"},{default:S(()=>[J.value.length===0?(u(),c("div",Js,[v(Ae,{name:"archive",class:"w-12 h-12"}),l[12]||(l[12]=i("p",null,"No archived or expired documents found.",-1))])):(u(),c("div",Gs,[(u(!0),c(le,null,ce(J.value,z=>(u(),Z(Ye,{key:z.name,document:z,onEdit:ee=>F(z),onDelete:ee=>ie(z),onUnarchive:ee=>x(z),onView:ee=>W(z),isOwner:k(z),isArchive:!0},null,8,["document","onEdit","onDelete","onUnarchive","onView","isOwner"]))),128))]))]),_:1})]),_:1})]),_:1},8,["activeIndex"]),v(Ve,{visible:I.value,"onUpdate:visible":l[1]||(l[1]=z=>I.value=z),title:"Upload New Document",fields:B.value,initialData:r.value,onSubmit:$,submitButtonLabel:"Upload Document",dialogWidth:"50rem"},null,8,["visible","fields","initialData"]),v(Ve,{visible:j.value,"onUpdate:visible":l[2]||(l[2]=z=>j.value=z),title:"Edit Document",fields:q.value,initialData:d.value,onSubmit:V,submitButtonLabel:"Save Changes"},null,8,["visible","fields","initialData"]),v(qe,{visible:L.value,"onUpdate:visible":l[3]||(l[3]=z=>L.value=z),title:"Delete Document",message:"This document will be disabled but not permanently deleted. Are you sure you want to proceed?","confirm-field":"document_name","confirm-value":(at=p.value)==null?void 0:at.document_name,"delete-button-label":"Disable Document",onConfirm:de},null,8,["visible","confirm-value"]),v(sn,{visible:D.value,"onUpdate:visible":l[5]||(l[5]=z=>D.value=z),header:((ot=C.value)==null?void 0:ot.document_name)||"Document Viewer",style:{width:"80vw",maxWidth:"1000px"},modal:"",dismissableMask:""},{default:S(()=>{var z,ee,De,lt,rt,ut,ct,dt,pt,mt,ft,vt,gt,ht,bt;return[i("div",ea,[re((z=C.value)==null?void 0:z.attach,"pdf")?(u(),c("iframe",{key:0,src:Te((ee=C.value)==null?void 0:ee.attach),width:"100%",height:"600",class:"document-iframe"},null,8,ta)):re((De=C.value)==null?void 0:De.attach,"image")?(u(),c("img",{key:1,src:Te((lt=C.value)==null?void 0:lt.attach),class:"document-image"},null,8,na)):re((rt=C.value)==null?void 0:rt.attach,"video")?(u(),c("video",ia,[i("source",{src:Te((ut=C.value)==null?void 0:ut.attach)},null,8,sa),l[13]||(l[13]=ge(" Your browser does not support video playback. "))])):re((ct=C.value)==null?void 0:ct.attach,"audio")?(u(),c("audio",aa,[i("source",{src:Te((dt=C.value)==null?void 0:dt.attach)},null,8,oa),l[14]||(l[14]=ge(" Your browser does not support audio playback. "))])):(u(),c("div",la,[i("div",ra,[v(Ae,{name:Le((pt=C.value)==null?void 0:pt.attach),class:"w-12 h-12"},null,8,["name"])]),i("p",ua,E(_e((mt=C.value)==null?void 0:mt.attach)),1),v(tn,{icon:"pi pi-download",label:"Download File",onClick:l[4]||(l[4]=Ke=>{var yt;return Qt((yt=C.value)==null?void 0:yt.attach)})})]))]),i("div",ca,[i("div",da,[l[15]||(l[15]=i("span",{class:"info-label"},"Document Number:",-1)),i("span",pa,E(((ft=C.value)==null?void 0:ft.document_number)||"N/A"),1)]),a.showIssueDate?(u(),c("div",ma,[l[16]||(l[16]=i("span",{class:"info-label"},"Issue Date:",-1)),i("span",fa,E(Y((vt=C.value)==null?void 0:vt.issue_date)),1)])):M("",!0),a.showExpiryDate?(u(),c("div",va,[l[17]||(l[17]=i("span",{class:"info-label"},"Expiry Date:",-1)),i("span",{class:X(["info-value",{"expired-date":Se(C.value)}])},[ge(E(Y((gt=C.value)==null?void 0:gt.expiry_date))+" ",1),Se(C.value)?(u(),Z(fe,{key:0,value:"Expired",severity:"danger"})):M("",!0)],2)])):M("",!0),a.showPlaceOfIssue?(u(),c("div",ga,[l[18]||(l[18]=i("span",{class:"info-label"},"Place of Issue:",-1)),i("span",ha,E(((ht=C.value)==null?void 0:ht.place_of_issue)||"N/A"),1)])):M("",!0),i("div",ba,[l[19]||(l[19]=i("span",{class:"info-label"},"Description:",-1)),i("span",ya,E(((bt=C.value)==null?void 0:bt.description)||"No description available"),1)]),i("div",xa,[l[20]||(l[20]=i("span",{class:"info-label"},"Tags:",-1)),i("span",wa,[(u(!0),c(le,null,ce(_(C.value),Ke=>(u(),Z(nn,{key:Ke,label:Ke,class:"tag-chip"},null,8,["label"]))),128))])])])]}),_:1},8,["visible","header"])])}}},Yt=we(_a,[["__scopeId","data-v-ffa0e15b"]]),Da={class:"documents-tab"},$a={__name:"DocumentsTab",setup(e){const t=He(),n=N(()=>t.currentListing),o=N(()=>{var s;return((s=n.value)==null?void 0:s.name)||""}),a=N(()=>{if(!n.value)return[];const s=[];return n.value.building&&s.push({doctype:"PRP Building",docname:n.value.building}),n.value.project&&s.push({doctype:"PRP Project",docname:n.value.project}),s});return(s,h)=>(u(),c("div",Da,[v(Yt,{relDoctype:"PRP Listing",relDocname:o.value,relatedRooms:a.value},null,8,["relDocname","relatedRooms"])]))}},ka=we($a,[["__scopeId","data-v-263f384b"]]),Xt={__name:"NoteTab",props:{doctype:{type:String,required:!0},docname:{type:String,required:!0}},setup(e){return(t,n)=>(u(),Z(dn,{doctype:e.doctype,docname:e.docname},null,8,["doctype","docname"]))}},Ca={class:"flex flex-col gap-4"},La={class:"flex flex-col"},ja={class:"font-medium"},Ba={class:"text-sm text-gray-600 dark:text-gray-400"},Sa={class:"font-bold mt-1"},Ta={class:"flex items-center justify-between w-full"},Ia={class:"font-medium"},Fa={class:"font-bold"},Pa={__name:"PricingTab",props:{listing:{type:Object,required:!0}},emits:["edit-field","update:listing"],setup(e,{emit:t}){const{formatCurrency:n}=Sn(),o=e,a=t,s=[{name:"unit_price",label:"Unit Price",type:"currency"},{name:"downpayment",label:"Down Payment",type:"currency",icon:"pi pi-money-bill"},{name:"payment_plan",label:"Payment Plan",type:"select",options:[{label:"20%/80%",value:"20/80"},{label:"30%/70%",value:"30/70"},{label:"40%/60%",value:"40/60"},{label:"50%/50%",value:"50/50"},{label:"60%/40%",value:"60/40"},{label:"70%/30%",value:"70/30"},{label:"80%/20%",value:"80/20"},{label:"100%",value:"100"}],icon:"pi pi-money-bill"}],h=[{name:"offer_title",label:"Offer Title",type:"text",icon:"pi pi-tag",validation:{required:!0}},{name:"offer_details",label:"Offer Details",type:"textarea",icon:"pi pi-align-left"},{name:"offer_value",label:"Offer Value",type:"currency",validation:{required:!0}}],m=[{name:"installment_percent",label:"Installment Percent",type:"number",icon:"pi pi-percentage",validation:{required:!0,min:0,max:100}},{name:"installment_rate",label:"Installment Rate",type:"currency",validation:{required:!0}}],g=(r,d,L)=>{const R=[...s].find(B=>B.name===r)||{};a("edit-field",{fieldName:r,currentValue:d,title:L,type:R.type||"text",options:R.options||[],validation:R.validation||null,doctype:R.doctype||""})},b=r=>{const d=Q({},o.listing);d.offers=[...d.offers||[],r],a("update:listing",d)},y=({index:r,data:d})=>{const L=Q({},o.listing);L.offers=[...L.offers||[]],L.offers[r]=d,a("update:listing",L)},C=r=>{const d=Q({},o.listing);d.offers=[...d.offers||[]],d.offers.splice(r,1),a("update:listing",d)},D=r=>{const d=Q({},o.listing);d.installments=[...d.installments||[],r],a("update:listing",d)},I=({index:r,data:d})=>{const L=Q({},o.listing);L.installments=[...L.installments||[]],L.installments[r]=d,a("update:listing",L)},j=r=>{const d=Q({},o.listing);d.installments=[...d.installments||[]],d.installments.splice(r,1),a("update:listing",d)};return(r,d)=>(u(),c("div",Ca,[v($e,{legend:"Pricing",fields:s,data:e.listing,columns:3,customClass:"mb-2",onEdit:g},null,8,["data"]),v(_t,{title:"Offers",rows:e.listing.offers||[],fields:h,"add-button-label":"Add Offer","empty-message":"No offers available.",onAdd:b,onUpdate:y,onDelete:C},{"row-content":S(({row:L})=>[i("div",La,[i("div",ja,E(L.offer_title),1),i("div",Ba,E(L.offer_details),1),i("div",Sa,E(Lt(n)(L.offer_value)),1)])]),_:1},8,["rows"]),v(_t,{title:"Installments",rows:e.listing.installments||[],fields:m,"add-button-label":"Add Installment","empty-message":"No installments available.",onAdd:D,onUpdate:I,onDelete:j},{"row-content":S(({row:L})=>[i("div",Ta,[i("div",Ia,"Installment: "+E(L.installment_percent)+"%",1),i("div",Fa,E(Lt(n)(L.installment_rate)),1)])]),_:1},8,["rows"])]))}},Ea={class:"h-full overflow-auto"},Ma={key:0,class:"flex items-center justify-center gap-2.5 p-8 text-sm rounded-xl bg-[var(--pd-bg-surface)] border border-[var(--pd-border-light)] text-[var(--pd-text-tertiary)]"},za={key:1,class:"flex items-center justify-center gap-2.5 p-8 text-sm rounded-xl bg-[var(--pd-bg-surface)] border border-[var(--pd-border-light)] text-[var(--pd-text-tertiary)]"},Aa={key:2,class:"flex items-center justify-center gap-2.5 p-8 text-sm rounded-xl bg-[var(--pd-bg-surface)] border border-[var(--pd-border-light)] text-[var(--pd-text-tertiary)]"},Ra={class:"flex flex-col gap-1 pr-6 text-right"},Oa={class:"text-[0.6875rem] font-medium text-[var(--pd-text-tertiary)] whitespace-nowrap tracking-tight"},Ua={class:"text-xs font-semibold text-[var(--pd-text-secondary)]"},Va=["onClick"],qa={class:"text-[0.8125rem] font-semibold text-[var(--pd-text-primary)]"},Na={key:0,class:"mr-1"},Ha={key:1,class:"mr-1"},Wa={key:2,class:"mr-1"},Ka={key:0,class:"flex items-center gap-1.5 text-[var(--pd-text-secondary)]"},Za={class:"min-w-[1.25rem] px-2 py-0.5 text-[0.6875rem] font-semibold text-center bg-[var(--pd-badge-bg)] text-[var(--pd-badge-text)] rounded-full"},Ya={key:0,class:"border-t border-[var(--pd-border-light)] bg-[var(--pd-bg-base)]"},Xa={class:"p-4 m-0 list-none"},Qa={key:0,xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--pd-bg-base)","stroke-width":"2.5"},Ja={key:1,xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"var(--pd-bg-base)","stroke-width":"2.5"},Ga={key:2,xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"var(--pd-bg-base)","stroke-width":"2.5"},eo={__name:"VersionTab",props:{listing:{type:Object,required:!0}},setup(e){const t=e,n=Tt(),o=w({}),a=w([]),s=w(!1),h=w(!1),m=w(""),g=w(null),b=w(null);function y(r){o.value[r]=!o.value[r]}function C(r){b.value&&clearTimeout(b.value),b.value=setTimeout(()=>{D(r)},300)}function D(r){return T(this,null,function*(){if(!(!r||s.value)&&g.value!==r.name){g.value=r.name,s.value=!0,a.value=[],h.value=!1;try{const d=yield n.loadDocumentTimeline("PRP Listing",r.name);if(a.value.push(...d.map(L=>ve(Q({},L),{sourceType:"Listing",sourceName:r.name}))),r.building){const L=yield n.loadDocumentTimeline("PRP Building",r.building);a.value.push(...L.map(p=>ve(Q({},p),{content:`[Building: ${r.building.substring(r.project.length+1)}] ${p.content}`,sourceType:"Building",sourceName:r.building})))}if(r.project){const L=yield n.loadDocumentTimeline("PRP Project",r.project);a.value.push(...L.map(p=>ve(Q({},p),{content:`[Project: ${r.project}] ${p.content}`,sourceType:"Project",sourceName:r.project})))}a.value.sort((L,p)=>p.timestamp-L.timestamp)}catch(d){console.error("Error loading combined timeline:",d),h.value=!0,m.value="Failed to load history. Please try again."}finally{s.value=!1}}})}const I=N(()=>{const r=[],d=new Map;let L=0;return a.value.forEach(p=>{const R=`${p.timestamp}-${p.user}`;if(d.has(R)){const B=d.get(R);B.changes.includes(p.content)||B.changes.push(p.content)}else{const B={id:L++,formattedDate:n.formatDate(new Date(p.timestamp),!0),user:p.user,icon:p.icon,color:p.color,timestamp:p.timestamp,action:j(p),changes:[p.content],isCreationEvent:p.content.includes("Created"),sourceType:p.sourceType,sourceName:p.sourceName};o.value[B.id]=!1,d.set(R,B),r.push(B)}}),r.sort((p,R)=>R.timestamp-p.timestamp)});function j(r){return r.content.includes("Created")?r.sourceType==="Building"?"Created building":r.sourceType==="Project"?"Created project":"Created listing":r.icon==="pi pi-plus"?"Added content":r.icon==="pi pi-minus"?"Removed content":r.icon==="pi pi-pencil"?r.sourceType==="Building"?"Modified building":r.sourceType==="Project"?"Modified project":"Modified listing":r.sourceType==="Building"?"Updated building":r.sourceType==="Project"?"Updated project":"Updated listing"}return he(()=>t.listing,r=>{r&&r.name&&C(r)},{deep:!0}),be(()=>{t.listing&&t.listing.name&&C(t.listing)}),Ut(()=>{b.value&&clearTimeout(b.value)}),(r,d)=>{const L=It;return u(),c("div",Ea,[s.value?(u(),c("div",Ma,d[0]||(d[0]=[i("div",{class:"loading-spinner"},null,-1),i("span",null,"Loading activity...",-1)]))):h.value?(u(),c("div",za,[d[1]||(d[1]=i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:"state-icon"},[i("circle",{cx:"12",cy:"12",r:"10"}),i("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),i("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),i("span",null,E(m.value),1)])):I.value.length===0?(u(),c("div",Aa,d[2]||(d[2]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:"state-icon"},[i("circle",{cx:"12",cy:"12",r:"10"}),i("polyline",{points:"12 6 12 12 16 14"})],-1),i("span",null,"No activity history available",-1)]))):M("",!0),i("div",null,[I.value.length>0?(u(),Z(L,{key:0,value:I.value,class:"zinc-timeline"},{opposite:S(p=>[i("div",Ra,[i("div",Oa,E(p.item.formattedDate),1),i("div",Ua,E(p.item.user),1)])]),content:S(p=>[i("div",{class:X(["mb-3 overflow-hidden rounded-xl border border-[var(--pd-border-light)] bg-[var(--pd-bg-surface)] shadow-sm transition-all duration-200",{"bg-[var(--pd-bg-base)] border-[var(--pd-border-medium)] shadow-md":p.item.isCreationEvent,"bg-[var(--pd-info-bg)] dark:bg-opacity-15":p.item.sourceType==="Building","bg-[var(--pd-success-bg)] dark:bg-opacity-15":p.item.sourceType==="Project"}])},[i("div",{class:X(["flex items-center justify-between p-3 cursor-default transition-colors duration-200",{"cursor-pointer hover:bg-[var(--pd-bg-surface-hover)]":p.item.changes.length>1}]),onClick:R=>y(p.item.id)},[i("span",qa,[p.item.sourceType==="Building"?(u(),c("span",Na,"🏢")):M("",!0),p.item.sourceType==="Project"?(u(),c("span",Ha,"🏗️")):M("",!0),p.item.sourceType==="Listing"?(u(),c("span",Wa,"🏠")):M("",!0),ge(" "+E(p.item.action),1)]),p.item.changes.length>1?(u(),c("div",Ka,[i("span",Za,E(p.item.changes.length),1),(u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:X(["transition-transform duration-200",{"rotate-180":o.value[p.item.id]}])},d[3]||(d[3]=[i("polyline",{points:"6 9 12 15 18 9"},null,-1)]),2))])):M("",!0)],10,Va),o.value[p.item.id]||p.item.changes.length===1?(u(),c("div",Ya,[i("ul",Xa,[(u(!0),c(le,null,ce(p.item.changes,(R,B)=>(u(),c("li",{key:B,class:X(["py-1.5 text-xs leading-6 text-[var(--pd-text-secondary)]",{"border-b border-dashed border-[var(--pd-border-light)]":B!==p.item.changes.length-1}])},E(R),3))),128))])])):M("",!0)],2)]),marker:S(p=>[i("div",{class:X(["flex items-center justify-center rounded-full",[p.item.isCreationEvent?"w-7 h-7":"w-6 h-6",{"bg-[var(--pd-marker-special)]":p.item.isCreationEvent,"bg-[var(--pd-marker-bg)]":!p.item.isCreationEvent&&p.item.sourceType==="Listing","bg-[var(--pd-info)]":p.item.sourceType==="Building","bg-[var(--pd-success)]":p.item.sourceType==="Project"}]])},[p.item.isCreationEvent?(u(),c("svg",Qa,d[4]||(d[4]=[i("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"},null,-1)]))):p.item.action.includes("Modified")?(u(),c("svg",Ja,d[5]||(d[5]=[i("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),i("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)]))):(u(),c("svg",Ga,d[6]||(d[6]=[i("circle",{cx:"12",cy:"12",r:"10"},null,-1),i("path",{d:"M12 8v8"},null,-1),i("path",{d:"M8 12h8"},null,-1)])))],2)]),_:1},8,["value"])):M("",!0)])])}}},to=we(eo,[["__scopeId","data-v-ca7971cb"]]),no={key:0,class:"m-auto h-full"},io={class:"flex flex-col items-center justify-center h-full text-center py-12"},so={key:1,class:"w-full h-full flex flex-col"},ao={class:"listing-header border-b border-gray-200 dark:border-zinc-700 flex-none",style:{padding:"var(--p-datatable-header-padding)"}},oo={class:"flex items-center justify-between p-4"},lo={class:"text-xl font-bold"},ro={class:"flex gap-1 items-center"},uo={class:"flex-grow overflow-hidden"},co={class:"h-full overflow-auto"},po={class:"p-4"},mo={class:"h-full overflow-auto"},fo={class:"p-4"},vo={class:"h-full overflow-auto"},go={class:"h-full overflow-hidden"},ho={class:"h-full overflow-auto"},bo={__name:"ListingTabs",setup(e){const t=He(),n=Ce(),o=ze(),a=Me("emitter"),s=w("info"),h=w(!1),m=w(""),g=w(null),b=w("text"),y=w(null),C=w([]),D=w(null),I=w(""),j=w(!1),r=N(()=>t.currentListing),d=O=>{r.value&&(s.value=O,o.push({name:"ListingTabDetails",params:{id:n.params.id,buildingId:n.params.buildingId,listingId:r.value.name,tabId:O}}))};be(()=>{a.on("listing-selected",O=>T(this,null,function*(){if(yield t.fetchListing(O.name),n.params.tabId&&(s.value=n.params.tabId),n.name!=="ListingTabDetails"){const _=n.params.tabId||s.value;o.push({name:"ListingTabDetails",params:{id:n.params.id,buildingId:n.params.buildingId,listingId:O.name,tabId:_}})}})),a.on("clear-current-listing",()=>{t.clearCurrentListing(),n.params.listingId&&o.push({name:"BuildingDetails",params:{id:n.params.id,buildingId:n.params.buildingId}})}),n.params.tabId&&(s.value=n.params.tabId)}),he(()=>n.params.tabId,O=>{O&&(s.value=O)});const L=O=>{switch(O){case"Sold":return"danger";case"Available for Secondhand":return"warn";default:return"success"}},p=O=>"pi pi-tag",R=[],B=[],q=[],te=(O,_,k,U)=>{if(typeof O=="object"&&O!==null){const A=O;g.value=A.fieldName,y.value=A.currentValue,m.value=A.title,b.value=A.type||"text",C.value=A.options||[],D.value=A.validation||null,I.value=A.doctype||""}else{g.value=O,y.value=_,m.value=k,b.value=U||"text";const ne=[...R,...B,...q].find(ye=>ye.name===O)||{};C.value=ne.options||[],D.value=ne.validation||null,I.value=ne.doctype||""}h.value=!0},J=O=>T(this,null,function*(){if(r.value)try{const _={};O.offers!==void 0&&(_.offers=O.offers),O.installments!==void 0&&(_.installments=O.installments),yield t.updateListing(r.value.name,_),yield t.refreshCurrentListing()}catch(_){console.error("Error updating listing:",_),yield t.refreshCurrentListing()}}),G=k=>T(this,[k],function*({fieldName:O,value:_}){if(!(!r.value||!O))try{const U={[O]:_};yield t.updateListing(r.value.name,U),yield t.refreshCurrentListing()}catch(U){console.error("Error updating listing field:",U),yield t.refreshCurrentListing()}}),ae=()=>T(this,null,function*(){if(r.value)try{yield t.deleteListing(r.value.name),j.value=!1,a.emit("listing-deleted")}catch(O){console.error("Error deleting listing:",O)}});return(O,_)=>{var F;const k=Ft,U=jn,A=Be,ne=Ge,ye=se("TabPanels"),xe=se("Tabs"),$=it("tooltip");return u(),c(le,null,[r.value?(u(),c("div",so,[i("div",ao,[i("div",oo,[i("div",null,[i("h2",lo,E(r.value.project)+" / "+E(r.value.building.substring(r.value.project.length+1))+" / "+E(r.value.unit_id),1)]),i("div",ro,[v(U,{value:r.value.availability||"Available",severity:L(r.value.availability),icon:p(r.value.availability),class:"mr-3"},null,8,["value","severity","icon"]),me(v(A,{onClick:_[0]||(_[0]=V=>d("info")),rounded:"",icon:"pi pi-info-circle",class:"w-8 h-8 p-0",outlined:s.value!=="info"},null,8,["outlined"]),[[$,"Info",void 0,{top:!0}]]),me(v(A,{onClick:_[1]||(_[1]=V=>d("pricing")),rounded:"",icon:"pi pi-dollar",class:"w-8 h-8 p-0",outlined:s.value!=="pricing"},null,8,["outlined"]),[[$,"Pricing",void 0,{top:!0}]]),me(v(A,{onClick:_[2]||(_[2]=V=>d("files")),rounded:"",icon:"pi pi-file",class:"w-8 h-8 p-0",outlined:s.value!=="files"},null,8,["outlined"]),[[$,"Files",void 0,{top:!0}]]),me(v(A,{onClick:_[3]||(_[3]=V=>d("history")),rounded:"",icon:"pi pi-history",class:"w-8 h-8 p-0",outlined:s.value!=="history"},null,8,["outlined"]),[[$,"History",void 0,{top:!0}]]),me(v(A,{onClick:_[4]||(_[4]=V=>d("notes")),rounded:"",icon:"pi pi-clipboard",class:"w-8 h-8 p-0",outlined:s.value!=="notes"},null,8,["outlined"]),[[$,"Notes",void 0,{top:!0}]])])])]),i("div",uo,[v(xe,{value:s.value,"onUpdate:value":_[5]||(_[5]=V=>s.value=V),class:"h-full flex flex-col"},{default:S(()=>[v(ye,{class:"h-full"},{default:S(()=>[v(ne,{value:"info"},{default:S(()=>[i("div",co,[i("div",po,[v(_s,{listing:r.value,onEditField:te},null,8,["listing"])])])]),_:1}),v(ne,{value:"pricing"},{default:S(()=>[i("div",mo,[i("div",fo,[v(Pa,{listing:r.value,onEditField:te,"onUpdate:listing":J},null,8,["listing"])])])]),_:1}),v(ne,{value:"files"},{default:S(()=>[i("div",vo,[i("div",null,[r.value?(u(),Z(ka,{key:0,listing:r.value},null,8,["listing"])):M("",!0)])])]),_:1}),v(ne,{value:"history"},{default:S(()=>[i("div",go,[v(to,{listing:r.value},null,8,["listing"])])]),_:1}),v(ne,{value:"notes"},{default:S(()=>[i("div",ho,[v(Xt,{doctype:"PRP Listing",docname:r.value.name},null,8,["docname"])])]),_:1})]),_:1})]),_:1},8,["value"])])])):(u(),c("div",no,[v(k,{class:"m-8","pt:root:class":"!border-0 !bg-white dark:!bg-zinc-800"},{default:S(()=>[i("div",io,[v(Vt,{name:"home",class:"w-16 h-16 text-zinc-400 dark:text-zinc-600 mb-4"}),_[8]||(_[8]=i("h3",{class:"text-xl font-medium text-tertiary mb-2"},"No Listing Selected",-1)),_[9]||(_[9]=i("p",{class:"text-tertiary max-w-sm"}," Select a listing from the grid to view its details. ",-1))])]),_:1})])),v(Je,{visible:h.value,"onUpdate:visible":_[6]||(_[6]=V=>h.value=V),"field-name":g.value,"field-type":b.value,value:y.value,title:m.value,options:C.value,validation:D.value,doctype:I.value,onSave:G},null,8,["visible","field-name","field-type","value","title","options","validation","doctype"]),v(qe,{visible:j.value,"onUpdate:visible":_[7]||(_[7]=V=>j.value=V),title:"Delete Listing",message:"This action cannot be undone. To confirm deletion, please type the listing ID below:","confirm-field":"unit_id","confirm-value":(F=r.value)==null?void 0:F.unit_id,"delete-button-label":"Delete Listing",onConfirm:ae},null,8,["visible","confirm-value"])],64)}}},yo=we(bo,[["__scopeId","data-v-cbfae326"]]),xo={class:"flex flex-col gap-4"},wo={__name:"ProjectInfoTab",props:{project:{type:Object,required:!0}},emits:["edit-field"],setup(e,{emit:t}){const n=Array.from({length:10},(g,b)=>new Date().getFullYear()+b),o=t,a=[{name:"project_name",label:"Project Name",type:"text",icon:"pi pi-building",validation:{required:!0}},{name:"developer",label:"Developer",type:"link",doctype:"PRP Developer",icon:"pi pi-briefcase"},{name:"status",label:"Status",type:"select",options:["Active","On Hold","Completed","Canceled"],icon:"pi pi-flag",readonly:!0},{name:"availability",label:"Availability",type:"select",options:["Available","Sold Out","Coming Soon"],icon:"pi pi-tag",readonly:!0}],s=[{name:"territory",label:"Territory Code",type:"link",doctype:"PRP Territory",readonly:!0},{name:"town",label:"Town",type:"text",icon:"pi pi-map-marker",readonly:!0},{name:"suburb",label:"Suburb",type:"text",icon:"pi pi-sitemap",readonly:!0},{name:"city",label:"City",type:"text",icon:"pi pi-map",readonly:!0}],h=[{name:"handover_quarter",label:"Handover Quarter",type:"select",options:[{label:"Q1",value:"1"},{label:"Q2",value:"2"},{label:"Q3",value:"3"},{label:"Q4",value:"4"}],icon:"pi pi-calendar"},{name:"handover_year",label:"Handover Year",type:"select",options:n,icon:"pi pi-calendar-plus"}],m=(g,b,y)=>{const D=[...a,...s,...h].find(I=>I.name===g)||{};o("edit-field",{fieldName:g,currentValue:b,title:y,type:D.type||"text",options:D.options||[],validation:D.validation||null,doctype:D.doctype||""})};return(g,b)=>(u(),c("div",xo,[v($e,{legend:"Project Details",fields:a,data:e.project,columns:1,customClass:"mb-2",onEdit:m},null,8,["data"]),v($e,{legend:"Location",fields:s,data:e.project,columns:1,customClass:"mb-2",onEdit:m},null,8,["data"]),v($e,{legend:"Timeline",fields:h,data:e.project,columns:1,customClass:"mb-2",onEdit:m},null,8,["data"])]))}},_o={class:"documents-tab"},Do={__name:"ProjectDocumentsTab",setup(e){const t=Ee(),n=N(()=>t.currentProject),o=N(()=>{var a;return((a=n.value)==null?void 0:a.name)||""});return(a,s)=>(u(),c("div",_o,[v(Yt,{relDoctype:"PRP Project",relDocname:o.value,title:"Project Documents",recommendedTags:["cover_image","project_brochure","contract"],showExpiryDate:!1,showIssueDate:!1,showPlaceOfIssue:!1},null,8,["relDocname"])]))}},$o=we(Do,[["__scopeId","data-v-d3c62366"]]),ko={class:"h-full overflow-auto"},Co={key:0,class:"flex items-center justify-center gap-2.5 p-8 text-sm rounded-xl bg-[var(--pd-bg-surface)] border border-[var(--pd-border-light)] text-[var(--pd-text-tertiary)]"},Lo={key:1,class:"flex items-center justify-center gap-2.5 p-8 text-sm rounded-xl bg-[var(--pd-bg-surface)] border border-[var(--pd-border-light)] text-[var(--pd-text-tertiary)]"},jo={key:2,class:"flex items-center justify-center gap-2.5 p-8 text-sm rounded-xl bg-[var(--pd-bg-surface)] border border-[var(--pd-border-light)] text-[var(--pd-text-tertiary)]"},Bo={class:"flex flex-col gap-1 pr-6 text-right"},So={class:"text-[0.6875rem] font-medium text-[var(--pd-text-tertiary)] whitespace-nowrap tracking-tight"},To={class:"text-xs font-semibold text-[var(--pd-text-secondary)]"},Io=["onClick"],Fo={class:"text-[0.8125rem] font-semibold text-[var(--pd-text-primary)]"},Po={key:0,class:"mr-1"},Eo={key:0,class:"flex items-center gap-1.5 text-[var(--pd-text-secondary)]"},Mo={class:"min-w-[1.25rem] px-2 py-0.5 text-[0.6875rem] font-semibold text-center bg-[var(--pd-badge-bg)] text-[var(--pd-badge-text)] rounded-full"},zo={key:0,class:"border-t border-[var(--pd-border-light)] bg-[var(--pd-bg-base)]"},Ao={class:"p-4 m-0 list-none"},Ro={key:0,xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--pd-bg-base)","stroke-width":"2.5"},Oo={key:1,xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"var(--pd-bg-base)","stroke-width":"2.5"},Uo={key:2,xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"var(--pd-bg-base)","stroke-width":"2.5"},Vo={__name:"ProjectVersionTab",props:{project:{type:Object,required:!0}},setup(e){const t=e,n=Tt(),o=w({}),a=w([]),s=w(!1),h=w(!1),m=w(""),g=w(null),b=w(null);function y(r){o.value[r]=!o.value[r]}function C(r){b.value&&clearTimeout(b.value),b.value=setTimeout(()=>{D(r)},300)}function D(r){return T(this,null,function*(){if(!(!r||s.value)&&g.value!==r.name){g.value=r.name,s.value=!0,a.value=[],h.value=!1;try{const d=yield n.loadDocumentTimeline("PRP Project",r.name);a.value=d.map(L=>ve(Q({},L),{sourceType:"Project",sourceName:r.name})),a.value.sort((L,p)=>p.timestamp-L.timestamp)}catch(d){console.error("Error loading project timeline:",d),h.value=!0,m.value="Failed to load history. Please try again."}finally{s.value=!1}}})}const I=N(()=>{const r=[],d=new Map;let L=0;return a.value.forEach(p=>{const R=`${p.timestamp}-${p.user}`;if(d.has(R)){const B=d.get(R);B.changes.includes(p.content)||B.changes.push(p.content)}else{const B={id:L++,formattedDate:n.formatDate(new Date(p.timestamp),!0),user:p.user,icon:p.icon,color:p.color,timestamp:p.timestamp,action:j(p),changes:[p.content],isCreationEvent:p.content.includes("Created"),sourceType:p.sourceType,sourceName:p.sourceName};o.value[B.id]=!1,d.set(R,B),r.push(B)}}),r.sort((p,R)=>R.timestamp-p.timestamp)});function j(r){return r.content.includes("Created")?"Created project":r.icon==="pi pi-plus"?"Added content":r.icon==="pi pi-minus"?"Removed content":r.icon==="pi pi-pencil"?"Modified project":"Updated project"}return he(()=>t.project,r=>{r&&r.name&&C(r)},{deep:!0}),be(()=>{t.project&&t.project.name&&C(t.project)}),Ut(()=>{b.value&&clearTimeout(b.value)}),(r,d)=>{const L=It;return u(),c("div",ko,[s.value?(u(),c("div",Co,d[0]||(d[0]=[i("div",{class:"loading-spinner"},null,-1),i("span",null,"Loading activity...",-1)]))):h.value?(u(),c("div",Lo,[d[1]||(d[1]=i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:"state-icon"},[i("circle",{cx:"12",cy:"12",r:"10"}),i("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),i("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),i("span",null,E(m.value),1)])):I.value.length===0?(u(),c("div",jo,d[2]||(d[2]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:"state-icon"},[i("circle",{cx:"12",cy:"12",r:"10"}),i("polyline",{points:"12 6 12 12 16 14"})],-1),i("span",null,"No activity history available",-1)]))):M("",!0),i("div",null,[I.value.length>0?(u(),Z(L,{key:0,value:I.value,class:"zinc-timeline"},{opposite:S(p=>[i("div",Bo,[i("div",So,E(p.item.formattedDate),1),i("div",To,E(p.item.user),1)])]),content:S(p=>[i("div",{class:X(["mb-3 overflow-hidden rounded-xl border border-[var(--pd-border-light)] bg-[var(--pd-bg-surface)] shadow-sm transition-all duration-200",{"bg-[var(--pd-bg-base)] border-[var(--pd-border-medium)] shadow-md":p.item.isCreationEvent,"bg-[var(--pd-success-bg)] dark:bg-opacity-15":p.item.sourceType==="Project"}])},[i("div",{class:X(["flex items-center justify-between p-3 cursor-default transition-colors duration-200",{"cursor-pointer hover:bg-[var(--pd-bg-surface-hover)]":p.item.changes.length>1}]),onClick:R=>y(p.item.id)},[i("span",Fo,[p.item.sourceType==="Project"?(u(),c("span",Po,"🏗️")):M("",!0),ge(" "+E(p.item.action),1)]),p.item.changes.length>1?(u(),c("div",Eo,[i("span",Mo,E(p.item.changes.length),1),(u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:X(["transition-transform duration-200",{"rotate-180":o.value[p.item.id]}])},d[3]||(d[3]=[i("polyline",{points:"6 9 12 15 18 9"},null,-1)]),2))])):M("",!0)],10,Io),o.value[p.item.id]||p.item.changes.length===1?(u(),c("div",zo,[i("ul",Ao,[(u(!0),c(le,null,ce(p.item.changes,(R,B)=>(u(),c("li",{key:B,class:X(["py-1.5 text-xs leading-6 text-[var(--pd-text-secondary)]",{"border-b border-dashed border-[var(--pd-border-light)]":B!==p.item.changes.length-1}])},E(R),3))),128))])])):M("",!0)],2)]),marker:S(p=>[i("div",{class:X(["flex items-center justify-center rounded-full",[p.item.isCreationEvent?"w-7 h-7":"w-6 h-6",{"bg-[var(--pd-marker-special)]":p.item.isCreationEvent,"bg-[var(--pd-success)]":!p.item.isCreationEvent}]])},[p.item.isCreationEvent?(u(),c("svg",Ro,d[4]||(d[4]=[i("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"},null,-1)]))):p.item.action.includes("Modified")?(u(),c("svg",Oo,d[5]||(d[5]=[i("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),i("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)]))):(u(),c("svg",Uo,d[6]||(d[6]=[i("circle",{cx:"12",cy:"12",r:"10"},null,-1),i("path",{d:"M12 8v8"},null,-1),i("path",{d:"M8 12h8"},null,-1)])))],2)]),_:1},8,["value"])):M("",!0)])])}}},qo=we(Vo,[["__scopeId","data-v-93f3e7af"]]),No={key:0,class:"m-auto h-full"},Ho={class:"flex flex-col items-center justify-center h-full text-center py-12"},Wo={key:1,class:"w-full h-full flex flex-col"},Ko={class:"project-header border-b border-gray-200 dark:border-zinc-700 flex-none",style:{padding:"var(--p-datatable-header-padding)"}},Zo={class:"flex items-center justify-between p-4"},Yo={class:"text-xl font-bold"},Xo={class:"flex gap-1 items-center"},Qo={class:"flex-grow overflow-hidden"},Jo={class:"h-full overflow-auto"},Go={class:"p-4"},el={class:"h-full overflow-auto"},tl={class:"h-full overflow-hidden"},nl={class:"h-full overflow-auto"},il={__name:"ProjectTabs",setup(e){const t=Ee(),n=Ce(),o=ze(),a=Me("emitter"),s=w("info"),h=w(!1),m=w(""),g=w(null),b=w("text"),y=w(null),C=w([]),D=w(null),I=w(""),j=w(!1),r=N(()=>t.currentProject),d=B=>{r.value&&(s.value=B,o.push({name:"ProjectTabDetails",params:{id:r.value.name,tabId:B}}))};be(()=>{a.on("project-selected",B=>T(this,null,function*(){if(yield t.fetchProject(B.name),n.params.tabId&&(s.value=n.params.tabId),n.name!=="ProjectTabDetails"){const q=n.params.tabId||s.value;o.push({name:"ProjectTabDetails",params:{id:B.name,tabId:q}})}})),n.params.tabId&&(s.value=n.params.tabId)}),he(()=>n.params.tabId,B=>{B&&(s.value=B)});const L=(B,q,te,J)=>{if(typeof B=="object"&&B!==null){const G=B;g.value=G.fieldName,y.value=G.currentValue,m.value=G.title,b.value=G.type||"text",C.value=G.options||[],D.value=G.validation||null,I.value=G.doctype||""}else g.value=B,y.value=q,m.value=te,b.value=J||"text";h.value=!0},p=te=>T(this,[te],function*({fieldName:B,value:q}){if(!(!r.value||!B))try{const J={[B]:q};yield t.updateProject(r.value.name,J),yield t.refreshCurrentProject()}catch(J){console.error("Error updating project field:",J),yield t.refreshCurrentProject()}}),R=()=>T(this,null,function*(){if(r.value)try{yield t.deleteProject(r.value.name),j.value=!1,a.emit("project-deleted"),o.push({name:"Projects"})}catch(B){console.error("Error deleting project:",B)}});return(B,q)=>{var k;const te=Ft,J=Be,G=Ge,ae=se("TabPanels"),O=se("Tabs"),_=it("tooltip");return u(),c(le,null,[r.value?(u(),c("div",Wo,[i("div",Ko,[i("div",Zo,[i("div",null,[i("h2",Yo,E(r.value.project_name),1)]),i("div",Xo,[me(v(J,{onClick:q[0]||(q[0]=U=>d("info")),rounded:"",icon:"pi pi-info-circle",class:"w-8 h-8 p-0",outlined:s.value!=="info"},null,8,["outlined"]),[[_,"Info",void 0,{top:!0}]]),me(v(J,{onClick:q[1]||(q[1]=U=>d("notes")),rounded:"",icon:"pi pi-clipboard",class:"w-8 h-8 p-0",outlined:s.value!=="notes"},null,8,["outlined"]),[[_,"Notes",void 0,{top:!0}]]),me(v(J,{onClick:q[2]||(q[2]=U=>d("version")),rounded:"",icon:"pi pi-history",class:"w-8 h-8 p-0",outlined:s.value!=="version"},null,8,["outlined"]),[[_,"History",void 0,{top:!0}]]),me(v(J,{onClick:q[3]||(q[3]=U=>d("documents")),rounded:"",icon:"pi pi-file",class:"w-8 h-8 p-0",outlined:s.value!=="documents"},null,8,["outlined"]),[[_,"Documents",void 0,{top:!0}]])])])]),i("div",Qo,[v(O,{value:s.value,"onUpdate:value":q[4]||(q[4]=U=>s.value=U),class:"h-full flex flex-col"},{default:S(()=>[v(ae,{class:"h-full"},{default:S(()=>[v(G,{value:"info"},{default:S(()=>[i("div",Jo,[i("div",Go,[v(wo,{project:r.value,onEditField:L},null,8,["project"])])])]),_:1}),v(G,{value:"notes"},{default:S(()=>[i("div",el,[v(Xt,{doctype:"PRP Project",docname:r.value.name},null,8,["docname"])])]),_:1}),v(G,{value:"version"},{default:S(()=>[i("div",tl,[v(qo,{project:r.value},null,8,["project"])])]),_:1}),v(G,{value:"documents"},{default:S(()=>[i("div",nl,[v($o,{project:r.value},null,8,["project"])])]),_:1})]),_:1})]),_:1},8,["value"])])])):(u(),c("div",No,[v(te,{class:"m-8","pt:root:class":"!border-0 !bg-white dark:!bg-zinc-800"},{default:S(()=>[i("div",Ho,[v(Vt,{name:"layout",class:"w-16 h-16 text-zinc-400 dark:text-zinc-600 mb-4"}),q[7]||(q[7]=i("h3",{class:"text-xl font-medium text-tertiary mb-2"},"No Project Selected",-1)),q[8]||(q[8]=i("p",{class:"text-tertiary max-w-sm"},"Select a project to view its details.",-1))])]),_:1})])),v(Je,{visible:h.value,"onUpdate:visible":q[5]||(q[5]=U=>h.value=U),"field-name":g.value,"field-type":b.value,value:y.value,title:m.value,options:C.value,validation:D.value,doctype:I.value,onSave:p},null,8,["visible","field-name","field-type","value","title","options","validation","doctype"]),v(qe,{visible:j.value,"onUpdate:visible":q[6]||(q[6]=U=>j.value=U),title:"Delete Project",message:"This action cannot be undone. To confirm deletion, please type the project name below:","confirm-field":"project_name","confirm-value":(k=r.value)==null?void 0:k.project_name,"delete-button-label":"Delete Project",onConfirm:R},null,8,["visible","confirm-value"])],64)}}},sl=we(il,[["__scopeId","data-v-a45f32cd"]]);function al(e){return{all:e=e||new Map,on:function(t,n){var o=e.get(t);o?o.push(n):e.set(t,[n])},off:function(t,n){var o=e.get(t);o&&(n?o.splice(o.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var o=e.get(t);o&&o.slice().map(function(a){a(n)}),(o=e.get("*"))&&o.slice().map(function(a){a(t,n)})}}}const cl={__name:"ProjectDetails",setup(e){const t=al();Bn("emitter",t);const n=Ce(),o=ze(),a=st(),s=He(),h=Ee(),m=n.params.id,g=n.params.buildingId,b=n.params.listingId;return n.params.tabId,be(()=>T(this,null,function*(){console.log("Project ID:",m),m&&(yield h.fetchProject(m),t.emit("project-selected",h.currentProject)),g&&(console.log("Loading Building:",g),yield a.fetchBuilding(g),t.emit("building-selected",a.currentBuilding)),b&&(console.log("Loading Listing:",b),yield s.fetchListing(b),t.emit("listing-selected",s.currentListing))})),t.on("building-selected",y=>{y&&y.name!==g&&o.push({name:"BuildingDetails",params:{id:m,buildingId:y.name}})}),t.on("listing-selected",y=>{y&&y.name!==b&&o.push({name:"ListingDetails",params:{id:m,buildingId:y.building,listingId:y.name}})}),(y,C)=>{const D=mn,I=pn;return u(),Z(I,{style:{height:"100%"}},{default:S(()=>[v(D,{size:20,minSize:10},{default:S(()=>[v(I,{layout:"vertical"},{default:S(()=>[v(D,{class:"pd-splitter-panel",size:40},{default:S(()=>[v(Bi)]),_:1}),v(D,{class:"pd-splitter-panel",size:60},{default:S(()=>[v(sl)]),_:1})]),_:1})]),_:1}),v(D,{size:80},{default:S(()=>[v(I,{layout:"vertical"},{default:S(()=>[v(D,{class:"pd-splitter-panel",size:70},{default:S(()=>[v(yo)]),_:1}),v(D,{size:30},{default:S(()=>[v(I,null,{default:S(()=>[v(D,{class:"pd-splitter-panel",size:50},{default:S(()=>[v(Xi)]),_:1}),v(D,{class:"pd-splitter-panel",size:50},{default:S(()=>[v(xs)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{cl as default};
